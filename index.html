<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Milli Karwaan Public School Balrampur</title>
  <meta name="description" content="Official website of Milli Karwaan Public School, Balrampur" />

  <!-- Google Fonts (Optional but professional) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet" />

  <!-- Internal CSS -->
  <style>
    :root {
      --primary: #1e40af;
      --primary-dark: #1e3a8a;
      --secondary: #f97316;
      --accent: #059669;
      --light: #f8fafc;
      --dark: #1e293b;
      --gray: #64748b;
      --border: #e2e8f0;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --radius: 0.5rem;
      --transition: all 0.3s ease;
    }

    [data-theme="dark"] {
      --primary: #3b82f6;
      --primary-dark: #2563eb;
      --secondary: #f97316;
      --accent: #10b981;
      --light: #0f172a;
      --dark: #e2e8f0;
      --gray: #94a3b8;
      --border: #334155;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--light);
      color: var(--dark);
      line-height: 1.6;
      transition: background-color var(--transition), color var(--transition);
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Playfair Display', serif;
      font-weight: 700;
      line-height: 1.2;
    }

    img {
      max-width: 100%;
      height: auto;
      border-radius: var(--radius);
    }

    a {
      color: var(--primary);
      text-decoration: none;
      transition: var(--transition);
    }

    a:hover {
      color: var(--primary-dark);
    }

    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    /* Header Styles */
    header {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      padding: 1rem 0;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: var(--shadow);
    }

    .header-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .logo {
      height: 60px;
      border-radius: 0.5rem;
    }

    .school-info {
      flex: 1;
    }

    .school-name {
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: 0.25rem;
    }

    .school-address {
      font-size: 0.9rem;
      opacity: 0.9;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-shrink: 0;
    }

    .real-time-clock {
      font-size: 0.9rem;
      background: rgba(255, 255, 255, 0.1);
      padding: 0.5rem 0.75rem;
      border-radius: 0.375rem;
    }

    .call-button {
      background-color: var(--secondary);
      color: white;
      padding: 0.75rem 1.25rem;
      border: none;
      border-radius: var(--radius);
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: var(--transition);
    }

    .call-button:hover {
      background-color: #ea580c;
      transform: translateY(-2px);
    }

    .email-link {
      color: white;
      text-decoration: underline;
    }

    /* Navigation */
    nav {
      background-color: var(--dark);
      color: white;
      padding: 0.75rem 0;
      position: sticky;
      top: 82px;
      z-index: 999;
      box-shadow: var(--shadow);
    }

    .nav-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .menu {
      display: flex;
      list-style: none;
      gap: 2rem;
    }

    .menu a {
      color: white;
      font-weight: 500;
      position: relative;
      padding-bottom: 0.25rem;
    }

    .menu a::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background-color: var(--secondary);
      transition: var(--transition);
    }

    .menu a:hover::after {
      width: 100%;
    }

    .dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-btn {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0.25rem 0.5rem;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      right: 0;
      background-color: white;
      min-width: 200px;
      box-shadow: var(--shadow-lg);
      z-index: 1000;
      border-radius: var(--radius);
      overflow: hidden;
    }

    .dropdown-content a {
      color: var(--dark);
      padding: 0.75rem 1rem;
      display: block;
      border-bottom: 1px solid var(--border);
      transition: var(--transition);
    }

    .dropdown-content a:hover {
      background-color: #f1f5f9;
      padding-left: 1.25rem;
    }

    .dropdown-content a:last-child {
      border-bottom: none;
    }

    .dropdown:hover .dropdown-content {
      display: block;
    }

    /* Student Access Form */
    .student-form-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
      padding: 2rem 1rem;
    }

    .form-card {
      background: white;
      padding: 2.5rem;
      border-radius: var(--radius);
      box-shadow: var(--shadow-lg);
      width: 100%;
      max-width: 500px;
      text-align: center;
    }

    .form-title {
      font-size: 1.75rem;
      color: var(--primary);
      margin-bottom: 1.5rem;
    }

    .form-group {
      margin-bottom: 1.25rem;
      text-align: left;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--dark);
    }

    input, select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      font-size: 1rem;
      transition: var(--transition);
    }

    input:focus, select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
    }

    .submit-btn {
      background-color: var(--primary);
      color: white;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: var(--radius);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      transition: var(--transition);
    }

    .submit-btn:hover {
      background-color: var(--primary-dark);
    }

    .error {
      color: #dc2626;
      font-size: 0.875rem;
      margin-top: 0.5rem;
    }

    .locked-notice {
      background-color: #dcfce7;
      color: #166534;
      padding: 1rem;
      border-radius: var(--radius);
      margin-bottom: 1.5rem;
      text-align: center;
      border: 1px solid #a7f3d0;
    }

    /* Main Layout */
    .main-layout {
      display: flex;
      min-height: calc(100vh - 82px - 60px);
      margin-top: 2rem;
      gap: 2rem;
      padding-bottom: 2rem;
    }

    .content-area {
      flex: 1;
    }

    .sidebar {
      width: 300px;
      background-color: var(--light);
      border-radius: var(--radius);
      padding: 1.5rem;
      box-shadow: var(--shadow);
      align-self: start;
      position: sticky;
      top: 142px;
      height: fit-content;
    }

    .section {
      margin-bottom: 3rem;
      background-color: white;
      padding: 2rem;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    .section-title {
      font-size: 1.75rem;
      color: var(--primary);
      margin-bottom: 1.5rem;
      position: relative;
      padding-bottom: 0.5rem;
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 50px;
      height: 3px;
      background-color: var(--secondary);
    }

    /* Hero Section */
    .hero {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      padding: 4rem 2rem;
      text-align: center;
      border-radius: var(--radius);
      margin-bottom: 2rem;
      position: relative;
      overflow: hidden;
    }

    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('https://source.unsplash.com/random/1920x1080/?school,education') no-repeat center center;
      background-size: cover;
      opacity: 0.1;
      z-index: 0;
    }

    .hero-content {
      position: relative;
      z-index: 1;
    }

    .hero h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
    }

    .hero p {
      font-size: 1.2rem;
      max-width: 700px;
      margin: 0 auto 1.5rem;
    }

    .cta-button {
      background-color: var(--secondary);
      color: white;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: var(--radius);
      font-weight: 600;
      cursor: pointer;
      display: inline-block;
      transition: var(--transition);
    }

    .cta-button:hover {
      background-color: #ea580c;
      transform: translateY(-2px);
    }

    /* Homework Section */
    .homework-filters {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }

    .filter-group {
      flex: 1;
      min-width: 200px;
    }

    .filter-group select, .filter-group input {
      width: 100%;
    }

    .sort-controls {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .sort-btn {
      background-color: #f1f5f9;
      border: 1px solid var(--border);
      padding: 0.5rem 0.75rem;
      border-radius: 0.375rem;
      cursor: pointer;
      font-size: 0.875rem;
      transition: var(--transition);
    }

    .sort-btn.active {
      background-color: var(--primary);
      color: white;
      border-color: var(--primary);
    }

    .homework-list {
      display: grid;
      gap: 1rem;
    }

    .homework-card {
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      transition: var(--transition);
    }

    .homework-card:hover {
      box-shadow: var(--shadow);
      transform: translateY(-2px);
    }

    .homework-header {
      background-color: var(--primary);
      color: white;
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .homework-subject {
      font-weight: 600;
      font-size: 1.1rem;
    }

    .homework-date {
      font-size: 0.875rem;
      opacity: 0.9;
    }

    .homework-body {
      padding: 1.25rem;
    }

    .homework-instructions {
      margin-bottom: 1rem;
      color: var(--dark);
    }

    .attachment {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--primary);
      font-size: 0.875rem;
    }

    .completion-checkbox {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border);
    }

    /* Teachers Section */
    .teachers-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .teacher-card {
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      transition: var(--transition);
    }

    .teacher-card:hover {
      box-shadow: var(--shadow);
    }

    .teacher-img {
      height: 200px;
      background-color: #f1f5f9;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--gray);
      font-size: 4rem;
    }

    .teacher-info {
      padding: 1.25rem;
    }

    .teacher-name {
      font-size: 1.2rem;
      margin-bottom: 0.25rem;
      color: var(--primary);
    }

    .teacher-subject {
      color: var(--secondary);
      font-weight: 500;
      margin-bottom: 0.75rem;
    }

    .teacher-contact {
      display: flex;
      gap: 0.75rem;
    }

    .teacher-contact a {
      color: var(--gray);
      font-size: 0.875rem;
    }

    /* Events Timeline */
    .events-timeline {
      position: relative;
      padding-left: 2rem;
      margin-left: 1rem;
    }

    .events-timeline::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 2px;
      background-color: var(--border);
    }

    .event-item {
      position: relative;
      margin-bottom: 2rem;
      padding-left: 1.5rem;
    }

    .event-item::before {
      content: '';
      position: absolute;
      left: -7px;
      top: 0;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: var(--primary);
    }

    .event-date {
      font-size: 0.875rem;
      color: var(--secondary);
      font-weight: 600;
      margin-bottom: 0.25rem;
    }

    .event-title {
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
      color: var(--primary);
    }

    .event-desc {
      color: var(--dark);
    }

    /* Notice Board */
    .notices-list {
      display: grid;
      gap: 1rem;
    }

    .notice-item {
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1rem;
      background-color: #f8fafc;
    }

    .notice-priority {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .priority-high {
      background-color: #fee2e2;
      color: #dc2626;
    }

    .priority-medium {
      background-color: #fef3c7;
      color: #d97706;
    }

    .priority-low {
      background-color: #dbeafe;
      color: #1e40af;
    }

    .notice-title {
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--primary);
    }

    .notice-date {
      font-size: 0.875rem;
      color: var(--gray);
    }

    /* Timetable */
    .timetable {
      overflow-x: auto;
    }

    .timetable table {
      width: 100%;
      border-collapse: collapse;
    }

    .timetable th {
      background-color: var(--primary);
      color: white;
      padding: 0.75rem;
      text-align: left;
    }

    .timetable td {
      padding: 0.75rem;
      border-bottom: 1px solid var(--border);
    }

    .timetable tr:nth-child(even) {
      background-color: #f8fafc;
    }

    /* Gallery */
    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
    }

    .gallery-item {
      border-radius: var(--radius);
      overflow: hidden;
      position: relative;
      aspect-ratio: 1;
      cursor: pointer;
    }

    .gallery-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: var(--transition);
    }

    .gallery-item:hover img {
      transform: scale(1.05);
    }

    /* Lightbox */
    .lightbox {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      z-index: 2000;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }

    .lightbox.active {
      display: flex;
    }

    .lightbox-content {
      position: relative;
      max-width: 90%;
      max-height: 80%;
    }

    .lightbox-img {
      max-width: 100%;
      max-height: 80vh;
      border-radius: var(--radius);
    }

    .lightbox-controls {
      display: flex;
      justify-content: space-between;
      width: 100%;
      max-width: 800px;
      margin-top: 1rem;
    }

    .lightbox-btn {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: none;
      padding: 0.75rem 1rem;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.5rem;
      backdrop-filter: blur(5px);
    }

    .close-lightbox {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* FAQ */
    .faq-list {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .faq-item {
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
    }

    .faq-question {
      padding: 1rem;
      background-color: #f1f5f9;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .faq-answer {
      padding: 1rem;
      display: none;
      background-color: white;
      color: var(--dark);
    }

    .faq-item.active .faq-answer {
      display: block;
    }

    .faq-toggle {
      font-size: 1.2rem;
    }

    /* Contact Form */
    .contact-form {
      display: grid;
      gap: 1rem;
    }

    textarea {
      min-height: 120px;
      padding: 0.75rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      font-family: inherit;
      resize: vertical;
    }

    .form-message {
      margin-top: 1rem;
      padding: 0.75rem;
      border-radius: var(--radius);
      display: none;
    }

    .form-message.success {
      background-color: #dcfce7;
      color: #166534;
      border: 1px solid #a7f3d0;
    }

    .form-message.error {
      background-color: #fee2e2;
      color: #dc2626;
      border: 1px solid #fecaca;
    }

    /* Sidebar */
    .sidebar-title {
      font-size: 1.2rem;
      color: var(--primary);
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid var(--border);
    }

    .search-input {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      margin-bottom: 1.5rem;
    }

    .analytics {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .stat {
      background-color: #f1f5f9;
      padding: 1rem;
      border-radius: var(--radius);
      text-align: center;
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary);
    }

    .stat-label {
      font-size: 0.875rem;
      color: var(--gray);
    }

    .btn-secondary {
      background-color: #f1f5f9;
      color: var(--dark);
      border: 1px solid var(--border);
      padding: 0.75rem;
      border-radius: var(--radius);
      cursor: pointer;
      width: 100%;
      font-weight: 500;
      transition: var(--transition);
    }

    .btn-secondary:hover {
      background-color: #e2e8f0;
    }

    /* Footer */
    footer {
      background-color: var(--dark);
      color: white;
      padding: 3rem 0 1.5rem;
      margin-top: 4rem;
    }

    .footer-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
      margin-bottom: 2rem;
    }

    .footer-section h3 {
      font-size: 1.2rem;
      margin-bottom: 1rem;
      color: var(--secondary);
    }

    .footer-links {
      list-style: none;
    }

    .footer-links li {
      margin-bottom: 0.5rem;
    }

    .footer-links a {
      color: #cbd5e1;
    }

    .footer-links a:hover {
      color: white;
    }

    .footer-bottom {
      text-align: center;
      padding-top: 1.5rem;
      border-top: 1px solid #334155;
      color: #94a3b8;
      font-size: 0.875rem;
    }

    /* Theme Toggle */
    .theme-toggle {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-top: 1rem;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 24px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: var(--primary);
    }

    input:checked + .slider:before {
      transform: translateX(26px);
    }

    /* Admin Note */
    .admin-note {
      background-color: #fef3c7;
      color: #92400e;
      padding: 1rem;
      border-radius: var(--radius);
      border: 1px solid #fde68a;
      font-size: 0.875rem;
      margin: 1.5rem 0;
    }

    /* Print Styles */
    @media print {
      nav, .sidebar, .dropdown, .call-button, .header-actions, .btn-secondary, .completion-checkbox, .sort-controls, .homework-header button {
        display: none !important;
      }
      .main-layout {
        display: block;
      }
      .content-area, .sidebar {
        width: 100%;
        float: none;
      }
      body {
        background: white !important;
        color: black !important;
      }
      .lightbox {
        display: none !important;
      }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        text-align: center;
      }
      .header-actions {
        width: 100%;
        justify-content: center;
      }
      .menu {
        flex-wrap: wrap;
        justify-content: center;
        gap: 1rem;
      }
      .main-layout {
        flex-direction: column;
      }
      .sidebar {
        width: 100%;
        position: static;
      }
      .hero h1 {
        font-size: 2rem;
      }
      .section-title {
        font-size: 1.5rem;
      }
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .animate-fade-in {
      animation: fadeIn 0.6s ease forwards;
    }

    .fade-delay-1 { animation-delay: 0.1s; }
    .fade-delay-2 { animation-delay: 0.2s; }
    .fade-delay-3 { animation-delay: 0.3s; }
    .fade-delay-4 { animation-delay: 0.4s; }

    /* Loading */
    .loading {
      text-align: center;
      padding: 2rem;
      color: var(--gray);
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container header-content">
      <img src="https://i.postimg.cc/ryGx49TB/erasebg-transformed.png" alt="School Logo" class="logo" />
      <div class="school-info">
        <div class="school-name">Milli Karwaan Public School Balrampur</div>
        <div class="school-address">Boluha Police Chowki Balrampur</div>
      </div>
      <div class="header-actions">
        <div class="real-time-clock" id="realTimeClock">00:00:00</div>
        <a href="tel:9758919151" class="call-button">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.7 15.9 15.9 0 0 0 1 7.5 15.9 15.9 0 0 0 7.5 1 2 2 0 0 1 1.7 2z"></path>
          </svg>
          Call Now
        </a>
        <a href="mailto:madamsir066@gmail.com" class="email-link">madamsir066@gmail.com</a>
      </div>
    </div>
  </header>

  <!-- Navigation -->
  <nav>
    <div class="container nav-container">
      <ul class="menu">
        <li><a href="#home">Home</a></li>
        <li><a href="#homework">Homework</a></li>
        <li><a href="#teachers">Teachers</a></li>
        <li><a href="#events">Events</a></li>
        <li><a href="#notices">Notices</a></li>
        <li><a href="#timetable">Timetable</a></li>
        <li><a href="#gallery">Gallery</a></li>
        <li><a href="#faq">FAQ</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
      <div class="dropdown">
        <button class="dropdown-btn">⋮</button>
        <div class="dropdown-content">
          <a href="#gallery">Gallery</a>
          <a href="#events">Events</a>
          <a href="#notices">Notices</a>
          <a href="#timetable">Timetable</a>
          <a href="admin.html" target="_blank">Admin Login</a>
          <a href="#" id="exportDataBtn">Export Data</a>
          <a href="#" id="importDataBtn">Import Data</a>
          <a href="#" id="downloadSnapshotBtn">Download Snapshot</a>
          <a href="#" id="themeToggleBtn">
            <span id="themeText">Dark Mode</span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Student Access Form (Shown only if no student data) -->
  <div id="studentFormContainer" class="student-form-container">
    <div class="form-card">
      <h2 class="form-title">Student Access</h2>
      <p>Please enter your details to access your class content.</p>
      
      <form id="studentForm">
        <div class="form-group">
          <label for="studentName">Student Name *</label>
          <input type="text" id="studentName" required />
          <div class="error" id="nameError"></div>
        </div>
        
        <div class="form-group">
          <label for="studentClass">Class *</label>
          <select id="studentClass" required>
            <option value="">Select Class</option>
            <option value="1">Class 1</option>
            <option value="2">Class 2</option>
            <option value="3">Class 3</option>
            <option value="4">Class 4</option>
            <option value="5">Class 5</option>
            <option value="6">Class 6</option>
            <option value="7">Class 7</option>
            <option value="8">Class 8</option>
            <option value="9">Class 9</option>
            <option value="10">Class 10</option>
            <option value="11">Class 11</option>
            <option value="12">Class 12</option>
          </select>
          <div class="error" id="classError"></div>
        </div>
        
        <div class="form-group">
          <label for="parentName">Parent's Name *</label>
          <input type="text" id="parentName" required />
          <div class="error" id="parentError"></div>
        </div>
        
        <button type="submit" class="submit-btn">Access My Class</button>
      </form>
    </div>
  </div>

  <!-- Main Content (Hidden until form submission) -->
  <main id="mainContent" style="display: none;">
    <div class="container">
      <!-- Admin Note -->
      <div class="admin-note">
        <strong>Admin Note:</strong> Admin can edit content via admin.html (password: Abutalha) — admin is client-side demo; production requires backend.
      </div>

      <!-- Hero Section -->
      <section class="hero" id="home">
        <div class="hero-content">
          <h1>Welcome to Milli Karwaan Public School</h1>
          <p>Excellence in Education Since 2005. Empowering young minds for a brighter future.</p>
          <a href="#homework" class="cta-button">View Homework</a>
        </div>
      </section>

      <!-- Main Layout -->
      <div class="main-layout">
        <!-- Content Area -->
        <div class="content-area">
          <!-- Homework Section -->
          <section class="section" id="homework">
            <h2 class="section-title">Homework</h2>
            
            <div class="homework-filters">
              <div class="filter-group">
                <label for="subjectFilter">Subject</label>
                <select id="subjectFilter">
                  <option value="">All Subjects</option>
                  <option value="Mathematics">Mathematics</option>
                  <option value="Science">Science</option>
                  <option value="English">English</option>
                  <option value="Hindi">Hindi</option>
                  <option value="Social Studies">Social Studies</option>
                  <option value="Computer">Computer</option>
                </select>
              </div>
              
              <div class="filter-group">
                <label for="keywordFilter">Search</label>
                <input type="text" id="keywordFilter" placeholder="Search homework..." />
              </div>
            </div>
            
            <div class="sort-controls">
              <button class="sort-btn active" data-sort="newest">Newest First</button>
              <button class="sort-btn" data-sort="oldest">Oldest First</button>
              <button class="sort-btn" data-sort="subject">By Subject</button>
            </div>
            
            <div id="homeworkList" class="homework-list">
              <!-- Homework cards will be inserted here -->
            </div>
          </section>

          <!-- Teachers Section -->
          <section class="section" id="teachers">
            <h2 class="section-title">Our Teachers</h2>
            <div id="teachersGrid" class="teachers-grid">
              <!-- Teacher cards will be inserted here -->
            </div>
          </section>

          <!-- Events Section -->
          <section class="section" id="events">
            <h2 class="section-title">Upcoming Events</h2>
            <div class="events-timeline" id="eventsTimeline">
              <!-- Events will be inserted here -->
            </div>
          </section>

          <!-- Notices Section -->
          <section class="section" id="notices">
            <h2 class="section-title">Notice Board</h2>
            <div id="noticesList" class="notices-list">
              <!-- Notices will be inserted here -->
            </div>
          </section>

          <!-- Timetable Section -->
          <section class="section" id="timetable">
            <h2 class="section-title">Class Timetable</h2>
            <div class="timetable" id="timetableContent">
              <!-- Timetable will be inserted here -->
            </div>
          </section>

          <!-- Gallery Section -->
          <section class="section" id="gallery">
            <h2 class="section-title">Photo Gallery</h2>
            <div id="galleryGrid" class="gallery-grid">
              <!-- Gallery items will be inserted here -->
            </div>
          </section>

          <!-- FAQ Section -->
          <section class="section" id="faq">
            <h2 class="section-title">Frequently Asked Questions</h2>
            <div id="faqList" class="faq-list">
              <!-- FAQ items will be inserted here -->
            </div>
          </section>

          <!-- Contact Section -->
          <section class="section" id="contact">
            <h2 class="section-title">Contact Us</h2>
            <form id="contactForm" class="contact-form">
              <div class="form-group">
                <label for="contactName">Your Name *</label>
                <input type="text" id="contactName" required />
              </div>
              
              <div class="form-group">
                <label for="contactEmail">Email *</label>
                <input type="email" id="contactEmail" required />
              </div>
              
              <div class="form-group">
                <label for="contactSubject">Subject *</label>
                <input type="text" id="contactSubject" required />
              </div>
              
              <div class="form-group">
                <label for="contactMessage">Message *</label>
                <textarea id="contactMessage" required></textarea>
              </div>
              
              <button type="submit" class="submit-btn">Send Message</button>
              <div id="formMessage" class="form-message"></div>
            </form>
          </section>
        </div>

        <!-- Sidebar -->
        <aside class="sidebar">
          <h3 class="sidebar-title">Quick Actions</h3>
          
          <div class="search-input">
            <input type="text" id="sidebarSearch" placeholder="Search homework..." />
          </div>
          
          <div class="analytics">
            <div class="stat">
              <div class="stat-value" id="homeworkCount">0</div>
              <div class="stat-label">Homework</div>
            </div>
            <div class="stat">
              <div class="stat-value" id="teachersCount">0</div>
              <div class="stat-label">Teachers</div>
            </div>
          </div>
          
          <button id="exportSelectedBtn" class="btn-secondary">
            Export Selected
          </button>
          
          <button id="markDoneBtn" class="btn-secondary">
            Mark Selected as Done
          </button>
          
          <div class="theme-toggle">
            <input type="checkbox" id="themeToggle" />
            <label for="themeToggle" class="slider"></label>
            <span>Dark Mode</span>
          </div>
        </aside>
      </div>
    </div>
  </main>

  <!-- Lightbox -->
  <div id="lightbox" class="lightbox">
    <button class="close-lightbox" id="closeLightbox">×</button>
    <div class="lightbox-content">
      <img id="lightboxImg" class="lightbox-img" src="" alt="" />
    </div>
    <div class="lightbox-controls">
      <button id="prevBtn" class="lightbox-btn">‹</button>
      <button id="nextBtn" class="lightbox-btn">›</button>
    </div>
  </div>

  <!-- Internal JavaScript -->
  <script>
    // Global variables
    let studentData = null;
    let homeworkData = [];
    let teachersData = [];
    let eventsData = [];
    let noticesData = [];
    let timetableData = {};
    let galleryData = [];
    let messagesData = [];
    let faqData = [];
    
    // DOM Elements
    const studentFormContainer = document.getElementById('studentFormContainer');
    const mainContent = document.getElementById('mainContent');
    const studentForm = document.getElementById('studentForm');
    const realTimeClock = document.getElementById('realTimeClock');
    const homeworkList = document.getElementById('homeworkList');
    const teachersGrid = document.getElementById('teachersGrid');
    const eventsTimeline = document.getElementById('eventsTimeline');
    const noticesList = document.getElementById('noticesList');
    const timetableContent = document.getElementById('timetableContent');
    const galleryGrid = document.getElementById('galleryGrid');
    const faqList = document.getElementById('faqList');
    const contactForm = document.getElementById('contactForm');
    const formMessage = document.getElementById('formMessage');
    const homeworkCount = document.getElementById('homeworkCount');
    const teachersCount = document.getElementById('teachersCount');
    const sidebarSearch = document.getElementById('sidebarSearch');
    const subjectFilter = document.getElementById('subjectFilter');
    const keywordFilter = document.getElementById('keywordFilter');
    const sortButtons = document.querySelectorAll('.sort-btn');
    const exportDataBtn = document.getElementById('exportDataBtn');
    const importDataBtn = document.getElementById('importDataBtn');
    const downloadSnapshotBtn = document.getElementById('downloadSnapshotBtn');
    const exportSelectedBtn = document.getElementById('exportSelectedBtn');
    const markDoneBtn = document.getElementById('markDoneBtn');
    const themeToggle = document.getElementById('themeToggle');
    const themeText = document.getElementById('themeText');
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightboxImg');
    const closeLightbox = document.getElementById('closeLightbox');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');

    // Initialize the application
    function init() {
      // Check if student data exists
      const storedStudent = localStorage.getItem('mkps_student');
      if (storedStudent) {
        try {
          studentData = JSON.parse(storedStudent);
          showMainContent();
        } catch (e) {
          console.error('Error parsing student data:', e);
          localStorage.removeItem('mkps_student');
          showStudentForm();
        }
      } else {
        showStudentForm();
      }

      // Seed data if needed
      seedData();

      // Load all data
      loadData();

      // Start real-time clock
      updateRealTimeClock();
      setInterval(updateRealTimeClock, 1000);

      // Add event listeners
      addEventListeners();

      // Prevent back navigation to form
      if (studentData) {
        window.history.pushState(null, null, window.location.href);
        window.addEventListener('popstate', function(e) {
          window.history.pushState(null, null, window.location.href);
        });
      }
    }

    // Show student form
    function showStudentForm() {
      studentFormContainer.style.display = 'flex';
      mainContent.style.display = 'none';
    }

    // Show main content
    function showMainContent() {
      studentFormContainer.style.display = 'none';
      mainContent.style.display = 'block';
      
      // Show welcome message
      const hero = document.querySelector('.hero-content');
      hero.insertAdjacentHTML('afterbegin', `
        <div class="locked-notice animate-fade-in">
          Welcome, <strong>${studentData.name}</strong>! You are in <strong>Class ${studentData.cls}</strong>. 
          Your access is secured. 
        </div>
      `);
      
      // Render all sections
      renderHomework();
      renderTeachers();
      renderEvents();
      renderNotices();
      renderTimetable();
      renderGallery();
      renderFAQ();
      updateAnalytics();
    }

    // Seed initial data
    function seedData() {
      // Check if data already exists
      if (localStorage.getItem('mkps_homework')) return;

      // Seed homework data
      const homeworkSeed = [
        { id: 1, subject: 'Mathematics', class: 1, date: '2023-10-15', instructions: 'Complete page 25-27 in textbook. Focus on addition and subtraction problems.', attachment: false, completed: false, timestamp: Date.now() },
        { id: 2, subject: 'English', class: 1, date: '2023-10-16', instructions: 'Write 5 sentences using the new vocabulary words: apple, ball, cat, dog, elephant.', attachment: false, completed: false, timestamp: Date.now() - 86400000 },
        { id: 3, subject: 'Science', class: 2, date: '2023-10-15', instructions: 'Draw and label the parts of a plant. Write one sentence about each part.', attachment: true, completed: false, timestamp: Date.now() - 172800000 },
        { id: 4, subject: 'Mathematics', class: 2, date: '2023-10-17', instructions: 'Solve multiplication problems 1-20 on worksheet. Show your work.', attachment: false, completed: true, timestamp: Date.now() - 259200000 },
        { id: 5, subject: 'Hindi', class: 3, date: '2023-10-16', instructions: 'Write a short paragraph about your favorite festival in Hindi.', attachment: false, completed: false, timestamp: Date.now() - 345600000 },
        { id: 6, subject: 'Social Studies', class: 3, date: '2023-10-18', instructions: 'Research and write 3 facts about India\'s independence movement.', attachment: true, completed: false, timestamp: Date.now() - 432000000 },
        { id: 7, subject: 'Science', class: 4, date: '2023-10-17', instructions: 'Conduct a simple experiment at home with water and oil. Record your observations.', attachment: false, completed: false, timestamp: Date.now() - 518400000 },
        { id: 8, subject: 'Mathematics', class: 4, date: '2023-10-19', instructions: 'Complete the division problems on page 45. Check your answers.', attachment: false, completed: false, timestamp: Date.now() - 604800000 },
        { id: 9, subject: 'English', class: 5, date: '2023-10-18', instructions: 'Write a story using the words: adventure, mystery, treasure, island, map.', attachment: false, completed: false, timestamp: Date.now() - 691200000 },
        { id: 10, subject: 'Computer', class: 5, date: '2023-10-20', instructions: 'Create a simple PowerPoint presentation about your favorite animal.', attachment: true, completed: false, timestamp: Date.now() - 777600000 },
        { id: 11, subject: 'Mathematics', class: 6, date: '2023-10-19', instructions: 'Solve algebraic expressions on worksheet. Show all steps.', attachment: false, completed: false, timestamp: Date.now() - 864000000 },
        { id: 12, subject: 'Science', class: 6, date: '2023-10-21', instructions: 'Research the solar system and create a model of the planets.', attachment: true, completed: false, timestamp: Date.now() - 950400000 },
        { id: 13, subject: 'Hindi', class: 7, date: '2023-10-20', instructions: 'Translate the given English paragraph into Hindi.', attachment: false, completed: false, timestamp: Date.now() - 1036800000 },
        { id: 14, subject: 'Social Studies', class: 7, date: '2023-10-22', instructions: 'Prepare a presentation on the Indian Constitution.', attachment: true, completed: false, timestamp: Date.now() - 1123200000 },
        { id: 15, subject: 'Mathematics', class: 8, date: '2023-10-21', instructions: 'Complete the geometry problems on page 78. Include diagrams.', attachment: false, completed: false, timestamp: Date.now() - 1209600000 },
        { id: 16, subject: 'Science', class: 8, date: '2023-10-23', instructions: 'Write a report on renewable energy sources and their benefits.', attachment: true, completed: false, timestamp: Date.now() - 1296000000 },
        { id: 17, subject: 'English', class: 9, date: '2023-10-22', instructions: 'Analyze the poem \'The Road Not Taken\' and write your interpretation.', attachment: false, completed: false, timestamp: Date.now() - 1382400000 },
        { id: 18, subject: 'Mathematics', class: 9, date: '2023-10-24', instructions: 'Solve quadratic equations using the quadratic formula.', attachment: false, completed: false, timestamp: Date.now() - 1468800000 },
        { id: 19, subject: 'Science', class: 10, date: '2023-10-23', instructions: 'Prepare for the chemistry practical exam on acids and bases.', attachment: true, completed: false, timestamp: Date.now() - 1555200000 },
        { id: 20, subject: 'Social Studies', class: 10, date: '2023-10-25', instructions: 'Write an essay on the impact of globalization on Indian culture.', attachment: false, completed: false, timestamp: Date.now() - 1641600000 },
        { id: 21, subject: 'Mathematics', class: 11, date: '2023-10-24', instructions: 'Complete the calculus problems on derivatives and their applications.', attachment: false, completed: false, timestamp: Date.now() - 1728000000 },
        { id: 22, subject: 'Physics', class: 11, date: '2023-10-26', instructions: 'Solve problems on electromagnetic induction and Faraday\'s law.', attachment: true, completed: false, timestamp: Date.now() - 1814400000 },
        { id: 23, subject: 'Chemistry', class: 12, date: '2023-10-25', instructions: 'Prepare for the practical exam on organic compound identification.', attachment: false, completed: false, timestamp: Date.now() - 1900800000 },
        { id: 24, subject: 'Mathematics', class: 12, date: '2023-10-27', instructions: 'Revise integration techniques and solve sample problems.', attachment: false, completed: false, timestamp: Date.now() - 1987200000 }
      ];
      localStorage.setItem('mkps_homework', JSON.stringify(homeworkSeed));

      // Seed teachers data
      const teachersSeed = [
        { id: 1, name: 'Dr. Anjali Sharma', subject: 'Mathematics', classRange: '6-12', email: 'anjali.sharma@mkps.edu', phone: '9876543210', image: 'https://i.postimg.cc/ryGx49TB/erasebg-transformed.png' },
        { id: 2, name: 'Mr. Rajesh Kumar', subject: 'Science', classRange: '1-8', email: 'rajesh.kumar@mkps.edu', phone: '8765432109', image: 'https://i.postimg.cc/ryGx49TB/erasebg-transformed.png' },
        { id: 3, name: 'Mrs. Priya Patel', subject: 'English', classRange: '1-12', email: 'priya.patel@mkps.edu', phone: '7654321098', image: 'https://i.postimg.cc/ryGx49TB/erasebg-transformed.png' },
        { id: 4, name: 'Ms. Sunita Verma', subject: 'Hindi', classRange: '1-10', email: 'sunita.verma@mkps.edu', phone: '6543210987', image: 'https://i.postimg.cc/ryGx49TB/erasebg-transformed.png' },
        { id: 5, name: 'Dr. Arvind Singh', subject: 'Social Studies', classRange: '6-12', email: 'arvind.singh@mkps.edu', phone: '5432109876', image: 'https://i.postimg.cc/ryGx49TB/erasebg-transformed.png' },
        { id: 6, name: 'Mrs. Neha Gupta', subject: 'Computer', classRange: '5-12', email: 'neha.gupta@mkps.edu', phone: '4321098765', image: 'https://i.postimg.cc/ryGx49TB/erasebg-transformed.png' },
        { id: 7, name: 'Mr. Sanjay Mehta', subject: 'Physical Education', classRange: '1-12', email: 'sanjay.mehta@mkps.edu', phone: '3210987654', image: 'https://i.postimg.cc/ryGx49TB/erasebg-transformed.png' },
        { id: 8, name: 'Mrs. Kavita Reddy', subject: 'Art & Craft', classRange: '1-8', email: 'kavita.reddy@mkps.edu', phone: '2109876543', image: 'https://i.postimg.cc/ryGx49TB/erasebg-transformed.png' }
      ];
      localStorage.setItem('mkps_teachers', JSON.stringify(teachersSeed));

      // Seed events data
      const eventsSeed = [
        { id: 1, title: 'Annual Sports Day', date: '2023-11-15', description: 'Annual sports competition for all classes. Parents are invited to attend.', type: 'sports' },
        { id: 2, title: 'Diwali Celebration', date: '2023-11-12', description: 'Festival of lights celebration with cultural programs and traditional food.', type: 'cultural' },
        { id: 3, title: 'Parent-Teacher Meeting', date: '2023-11-10', description: 'Regular parent-teacher meeting to discuss student progress.', type: 'academic' },
        { id: 4, title: 'Science Exhibition', date: '2023-11-05', description: 'Students will present their science projects to the school community.', type: 'academic' },
        { id: 5, title: 'Independence Day', date: '2023-08-15', description: 'Celebration of India\'s Independence Day with flag hoisting and cultural programs.', type: 'cultural' },
        { id: 6, title: 'Mid-Term Exams', date: '2023-10-20', description: 'Mid-term examinations for all classes.', type: 'academic' },
        { id: 7, title: 'Teacher\'s Day', date: '2023-09-05', description: 'Celebration of Teacher\'s Day with student performances.', type: 'cultural' },
        { id: 8, title: 'Annual Day', date: '2024-03-15', description: 'Annual day celebration with cultural programs and prize distribution.', type: 'cultural' }
      ];
      localStorage.setItem('mkps_events', JSON.stringify(eventsSeed));

      // Seed notices data
      const noticesSeed = [
        { id: 1, title: 'New School Uniform Policy', date: '2023-10-10', priority: 'high', content: 'Starting November 1st, all students must wear the new school uniform. The uniform can be purchased from the school office.' },
        { id: 2, title: 'PTA Meeting Reminder', date: '2023-10-12', priority: 'medium', content: 'The next Parent-Teacher Association meeting will be held on October 15th at 3:00 PM in the school auditorium.' },
        { id: 3, title: 'Library Closed for Renovation', date: '2023-10-08', priority: 'medium', content: 'The school library will be closed from October 10th to October 20th for renovation work. We apologize for any inconvenience.' },
        { id: 4, title: 'School Holiday', date: '2023-10-05', priority: 'low', content: 'There will be no school on October 24th due to Diwali celebrations. Classes will resume on October 25th.' },
        { id: 5, title: 'New Computer Lab Opening', date: '2023-10-15', priority: 'high', content: 'We are pleased to announce the opening of our new computer lab with 30 new computers and high-speed internet.' },
        { id: 6, title: 'Health Checkup Camp', date: '2023-10-18', priority: 'medium', content: 'A free health checkup camp will be organized on October 20th for all students. Parents are requested to fill out the consent form.' }
      ];
      localStorage.setItem('mkps_notices', JSON.stringify(noticesSeed));

      // Seed timetable data
      const timetableSeed = {
        '1': {
          'Monday': { '9:00-10:00': 'Mathematics', '10:00-11:00': 'English', '11:00-12:00': 'Hindi', '12:00-1:00': 'Lunch', '1:00-2:00': 'Science', '2:00-3:00': 'Art' },
          'Tuesday': { '9:00-10:00': 'English', '10:00-11:00': 'Mathematics', '11:00-12:00': 'Hindi', '12:00-1:00': 'Lunch', '1:00-2:00': 'Social Studies', '2:00-3:00': 'Music' },
          'Wednesday': { '9:00-10:00': 'Hindi', '10:00-11:00': 'Mathematics', '11:00-12:00': 'English', '12:00-1:00': 'Lunch', '1:00-2:00': 'Science', '2:00-3:00': 'Physical Education' },
          'Thursday': { '9:00-10:00': 'Mathematics', '10:00-11:00': 'English', '11:00-12:00': 'Hindi', '12:00-1:00': 'Lunch', '1:00-2:00': 'Social Studies', '2:00-3:00': 'Art' },
          'Friday': { '9:00-10:00': 'English', '10:00-11:00': 'Mathematics', '11:00-12:00': 'Hindi', '12:00-1:00': 'Lunch', '1:00-2:00': 'Science', '2:00-3:00': 'Music' }
        },
        '5': {
          'Monday': { '9:00-10:00': 'Mathematics', '10:00-11:00': 'English', '11:00-12:00': 'Hindi', '12:00-1:00': 'Lunch', '1:00-2:00': 'Science', '2:00-3:00': 'Computer' },
          'Tuesday': { '9:00-10:00': 'English', '10:00-11:00': 'Mathematics', '11:00-12:00': 'Hindi', '12:00-1:00': 'Lunch', '1:00-2:00': 'Social Studies', '2:00-3:00': 'Art' },
          'Wednesday': { '9:00-10:00': 'Hindi', '10:00-11:00': 'Mathematics', '11:00-12:00': 'English', '12:00-1:00': 'Lunch', '1:00-2:00': 'Science', '2:00-3:00': 'Physical Education' },
          'Thursday': { '9:00-10:00': 'Mathematics', '10:00-11:00': 'English', '11:00-12:00': 'Hindi', '12:00-1:00': 'Lunch', '1:00-2:00': 'Social Studies', '2:00-3:00': 'Computer' },
          'Friday': { '9:00-10:00': 'English', '10:00-11:00': 'Mathematics', '11:00-12:00': 'Hindi', '12:00-1:00': 'Lunch', '1:00-2:00': 'Science', '2:00-3:00': 'Art' }
        },
        '10': {
          'Monday': { '9:00-10:00': 'Mathematics', '10:00-11:00': 'English', '11:00-12:00': 'Hindi', '12:00-1:00': 'Lunch', '1:00-2:00': 'Science', '2:00-3:00': 'Social Studies' },
          'Tuesday': { '9:00-10:00': 'English', '10:00-11:00': 'Mathematics', '11:00-12:00': 'Hindi', '12:00-1:00': 'Lunch', '1:00-2:00': 'Science', '2:00-3:00': 'Computer' },
          'Wednesday': { '9:00-10:00': 'Hindi', '10:00-11:00': 'Mathematics', '11:00-12:00': 'English', '12:00-1:00': 'Lunch', '1:00-2:00': 'Social Studies', '2:00-3:00': 'Physical Education' },
          'Thursday': { '9:00-10:00': 'Mathematics', '10:00-11:00': 'English', '11:00-12:00': 'Hindi', '12:00-1:00': 'Lunch', '1:00-2:00': 'Science', '2:00-3:00': 'Computer' },
          'Friday': { '9:00-10:00': 'English', '10:00-11:00': 'Mathematics', '11:00-12:00': 'Hindi', '12:00-1:00': 'Lunch', '1:00-2:00': 'Social Studies', '2:00-3:00': 'Art' }
        }
      ];
      localStorage.setItem('mkps_timetable', JSON.stringify(timetableSeed));

      // Seed gallery data
      const gallerySeed = [
        { id: 1, url: 'https://source.unsplash.com/random/800x600/?school,classroom', title: 'Classroom Learning', date: '2023-09-15' },
        { id: 2, url: 'https://source.unsplash.com/random/800x600/?school,sports', title: 'Sports Day', date: '2023-08-15' },
        { id: 3, url: 'https://source.unsplash.com/random/800x600/?school,science', title: 'Science Lab', date: '2023-07-20' },
        { id: 4, url: 'https://source.unsplash.com/random/800x600/?school,library', title: 'Library', date: '2023-06-10' },
        { id: 5, url: 'https://source.unsplash.com/random/800x600/?school,art', title: 'Art Class', date: '2023-05-05' },
        { id: 6, url: 'https://source.unsplash.com/random/800x600/?school,music', title: 'Music Class', date: '2023-04-12' },
        { id: 7, url: 'https://source.unsplash.com/random/800x600/?school,computer', title: 'Computer Lab', date: '2023-03-18' },
        { id: 8, url: 'https://source.unsplash.com/random/800x600/?school,annual', title: 'Annual Day', date: '2023-02-20' }
      ];
      localStorage.setItem('mkps_gallery', JSON.stringify(gallerySeed));

      // Seed messages data
      const messagesSeed = [];
      localStorage.setItem('mkps_messages', JSON.stringify(messagesSeed));

      // Seed FAQ data
      const faqSeed = [
        { id: 1, question: 'What are the school hours?', answer: 'School hours are from 9:00 AM to 3:00 PM, Monday through Friday.' },
        { id: 2, question: 'What is the school uniform policy?', answer: 'Students are required to wear the official school uniform, which consists of a white shirt, blue pants/skirt, and the school tie.' },
        { id: 3, question: 'How can I contact my child\'s teacher?', answer: 'You can contact your child\'s teacher through the school email system or during parent-teacher meetings.' },
        { id: 4, question: 'What extracurricular activities are offered?', answer: 'We offer a variety of extracurricular activities including sports, music, art, debate, and science club.' },
        { id: 5, question: 'How do I report my child\'s absence?', answer: 'Please call the school office at 9758919151 to report your child\'s absence before 9:00 AM.' },
        { id: 6, question: 'What is the procedure for admission?', answer: 'Admission forms are available at the school office. Please contact the administration for current admission requirements and availability.' }
      ];
      localStorage.setItem('mkps_faq', JSON.stringify(faqSeed));

      // Set update timestamp
      localStorage.setItem('mkps_update', Date.now().toString());
    }

    // Load data from localStorage
    function loadData() {
      try {
        const homeworkStr = localStorage.getItem('mkps_homework');
        homeworkData = homeworkStr ? JSON.parse(homeworkStr) : [];
        
        const teachersStr = localStorage.getItem('mkps_teachers');
        teachersData = teachersStr ? JSON.parse(teachersStr) : [];
        
        const eventsStr = localStorage.getItem('mkps_events');
        eventsData = eventsStr ? JSON.parse(eventsStr) : [];
        
        const noticesStr = localStorage.getItem('mkps_notices');
        noticesData = noticesStr ? JSON.parse(noticesStr) : [];
        
        const timetableStr = localStorage.getItem('mkps_timetable');
        timetableData = timetableStr ? JSON.parse(timetableStr) : {};
        
        const galleryStr = localStorage.getItem('mkps_gallery');
        galleryData = galleryStr ? JSON.parse(galleryStr) : [];
        
        const messagesStr = localStorage.getItem('mkps_messages');
        messagesData = messagesStr ? JSON.parse(messagesStr) : [];
        
        const faqStr = localStorage.getItem('mkps_faq');
        faqData = faqStr ? JSON.parse(faqStr) : [];
        
      } catch (e) {
        console.error('Error loading data:', e);
        // Reset to seed data if corrupted
        localStorage.clear();
        seedData();
        loadData();
      }
    }

    // Add event listeners
    function addEventListeners() {
      // Student form submission
      if (studentForm) {
        studentForm.addEventListener('submit', handleStudentFormSubmit);
      }

      // Contact form submission
      if (contactForm) {
        contactForm.addEventListener('submit', handleContactFormSubmit);
      }

      // Real-time clock
      setInterval(updateRealTimeClock, 1000);

      // Search and filter events
      if (sidebarSearch) {
        sidebarSearch.addEventListener('input', filterHomework);
      }
      if (subjectFilter) {
        subjectFilter.addEventListener('change', filterHomework);
      }
      if (keywordFilter) {
        keywordFilter.addEventListener('input', filterHomework);
      }

      // Sort buttons
      sortButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          sortButtons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          renderHomework();
        });
      });

      // Export/Import buttons
      if (exportDataBtn) {
        exportDataBtn.addEventListener('click', exportAllData);
      }
      if (importDataBtn) {
        importDataBtn.addEventListener('click', importData);
      }
      if (downloadSnapshotBtn) {
        downloadSnapshotBtn.addEventListener('click', downloadSnapshot);
      }
      if (exportSelectedBtn) {
        exportSelectedBtn.addEventListener('click', exportSelectedHomework);
      }
      if (markDoneBtn) {
        markDoneBtn.addEventListener('click', markSelectedDone);
      }

      // Theme toggle
      themeToggle.addEventListener('change', toggleTheme);

      // Lightbox events
      closeLightbox.addEventListener('click', () => {
        lightbox.classList.remove('active');
      });
      prevBtn.addEventListener('click', showPrevImage);
      nextBtn.addEventListener('click', showNextImage);
      lightbox.addEventListener('click', (e) => {
        if (e.target === lightbox) {
          lightbox.classList.remove('active');
        }
      });

      // Keyboard navigation for lightbox
      document.addEventListener('keydown', (e) => {
        if (lightbox.classList.contains('active')) {
          if (e.key === 'Escape') {
            lightbox.classList.remove('active');
          } else if (e.key === 'ArrowLeft') {
            showPrevImage();
          } else if (e.key === 'ArrowRight') {
            showNextImage();
          }
        }
      });

      // Storage event listener for cross-tab updates
      window.addEventListener('storage', (e) => {
        if (e.key === 'mkps_update') {
          console.log('Data updated in another tab, reloading...');
          loadData();
          renderHomework();
          renderTeachers();
          renderEvents();
          renderNotices();
          renderTimetable();
          renderGallery();
          updateAnalytics();
        }
      });
    }

    // Handle student form submission
    function handleStudentFormSubmit(e) {
      e.preventDefault();
      
      // Reset errors
      document.getElementById('nameError').textContent = '';
      document.getElementById('classError').textContent = '';
      document.getElementById('parentError').textContent = '';
      
      // Get values
      const name = document.getElementById('studentName').value.trim();
      const cls = document.getElementById('studentClass').value;
      const parent = document.getElementById('parentName').value.trim();
      
      // Validate
      let isValid = true;
      
      if (!name) {
        document.getElementById('nameError').textContent = 'Student name is required';
        isValid = false;
      }
      
      if (!cls) {
        document.getElementById('classError').textContent = 'Please select a class';
        isValid = false;
      }
      
      if (!parent) {
        document.getElementById('parentError').textContent = 'Parent\'s name is required';
        isValid = false;
      }
      
      if (!isValid) return;
      
      // Save to localStorage
      studentData = {
        name,
        cls: parseInt(cls),
        parent,
        ts: Date.now()
      };
      
      try {
        localStorage.setItem('mkps_student', JSON.stringify(studentData));
        localStorage.setItem('mkps_update', Date.now().toString());
        
        // Prevent back navigation
        window.history.pushState(null, null, window.location.href);
        window.addEventListener('popstate', function(e) {
          window.history.pushState(null, null, window.location.href);
        });
        
        // Show main content
        showMainContent();
        
      } catch (e) {
        alert('Error saving your information. Please try again.');
        console.error('Error saving student data:', e);
      }
    }

    // Handle contact form submission
    function handleContactFormSubmit(e) {
      e.preventDefault();
      
      const name = document.getElementById('contactName').value.trim();
      const email = document.getElementById('contactEmail').value.trim();
      const subject = document.getElementById('contactSubject').value.trim();
      const message = document.getElementById('contactMessage').value.trim();
      
      if (!name || !email || !subject || !message) {
        showFormMessage('Please fill in all fields.', 'error');
        return;
      }
      
      // Create message object
      const msg = {
        id: Date.now(),
        name,
        email,
        subject,
        message,
        timestamp: Date.now(),
        read: false
      };
      
      // Add to messages array
      messagesData.unshift(msg);
      
      try {
        localStorage.setItem('mkps_messages', JSON.stringify(messagesData));
        localStorage.setItem('mkps_update', Date.now().toString());
        
        // Reset form
        contactForm.reset();
        showFormMessage('Your message has been sent successfully!', 'success');
        
      } catch (e) {
        showFormMessage('Error sending message. Please try again.', 'error');
        console.error('Error saving message:', e);
      }
    }

    // Show form message
    function showFormMessage(text, type) {
      formMessage.textContent = text;
      formMessage.className = `form-message ${type}`;
      formMessage.style.display = 'block';
      
      setTimeout(() => {
        formMessage.style.display = 'none';
      }, 5000);
    }

    // Update real-time clock
    function updateRealTimeClock() {
      const now = new Date();
      realTimeClock.textContent = now.toLocaleTimeString();
    }

    // Filter and render homework
    function filterHomework() {
      renderHomework();
    }

    // Render homework
    function renderHomework() {
      if (!homeworkList) return;
      
      // Filter homework for current student class
      let filtered = homeworkData.filter(hw => hw.class === studentData.cls);
      
      // Apply subject filter
      const subject = subjectFilter.value;
      if (subject) {
        filtered = filtered.filter(hw => hw.subject === subject);
      }
      
      // Apply keyword filter
      const keyword = keywordFilter.value.toLowerCase();
      if (keyword) {
        filtered = filtered.filter(hw => 
          hw.subject.toLowerCase().includes(keyword) ||
          hw.instructions.toLowerCase().includes(keyword)
        );
      }
      
      // Apply sidebar search
      const sidebarKeyword = sidebarSearch.value.toLowerCase();
      if (sidebarKeyword) {
        filtered = filtered.filter(hw => 
          hw.subject.toLowerCase().includes(sidebarKeyword) ||
          hw.instructions.toLowerCase().includes(sidebarKeyword)
        );
      }
      
      // Sort
      const sortActive = document.querySelector('.sort-btn.active');
      const sort = sortActive ? sortActive.dataset.sort : 'newest';
      
      filtered.sort((a, b) => {
        if (sort === 'newest') {
          return b.timestamp - a.timestamp;
        } else if (sort === 'oldest') {
          return a.timestamp - b.timestamp;
        } else if (sort === 'subject') {
          return a.subject.localeCompare(b.subject);
        }
        return b.timestamp - a.timestamp;
      });
      
      // Render
      homeworkList.innerHTML = filtered.length > 0 
        ? filtered.map(hw => createHomeworkCard(hw)).join('')
        : '<div class="loading">No homework found for your class.</div>';
      
      // Add event listeners to checkboxes
      document.querySelectorAll('.completion-checkbox input').forEach(checkbox => {
        checkbox.addEventListener('change', (e) => {
          const hwId = parseInt(e.target.dataset.id);
          const hw = homeworkData.find(h => h.id === hwId);
          if (hw) {
            hw.completed = e.target.checked;
            try {
              localStorage.setItem('mkps_homework', JSON.stringify(homeworkData));
              localStorage.setItem('mkps_update', Date.now().toString());
            } catch (e) {
              console.error('Error saving homework status:', e);
              // Revert change if save fails
              e.target.checked = !e.target.checked;
            }
          }
        });
      });
    }

    // Create homework card HTML
    function createHomeworkCard(hw) {
      return `
        <div class="homework-card animate-fade-in">
          <div class="homework-header">
            <div class="homework-subject">${hw.subject}</div>
            <div class="homework-date">${formatDate(hw.date)}</div>
          </div>
          <div class="homework-body">
            <div class="homework-instructions">${hw.instructions}</div>
            ${hw.attachment ? '<div class="attachment"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.19 9.19a2 2 0 0 1-2.83-2.83l9.19-9.19"/></svg> Worksheet Attached</div>' : ''}
            <div class="completion-checkbox">
              <input type="checkbox" id="hw-${hw.id}" data-id="${hw.id}" ${hw.completed ? 'checked' : ''} />
              <label for="hw-${hw.id}">Mark as completed</label>
            </div>
          </div>
        </div>
      `;
    }

    // Render teachers
    function renderTeachers() {
      if (!teachersGrid) return;
      
      teachersGrid.innerHTML = teachersData.map(teacher => `
        <div class="teacher-card animate-fade-in">
          <div class="teacher-img">
            <img src="${teacher.image}" alt="${teacher.name}" onerror="this.onerror=null; this.src='https://i.postimg.cc/ryGx49TB/erasebg-transformed.png';" />
          </div>
          <div class="teacher-info">
            <div class="teacher-name">${teacher.name}</div>
            <div class="teacher-subject">${teacher.subject} (${teacher.classRange})</div>
            <div class="teacher-contact">
              <a href="mailto:${teacher.email}">Email</a>
              <a href="tel:${teacher.phone}">Call</a>
            </div>
          </div>
        </div>
      `).join('');
    }

    // Render events
    function renderEvents() {
      if (!eventsTimeline) return;
      
      // Sort events by date (newest first)
      const sortedEvents = [...eventsData].sort((a, b) => new Date(b.date) - new Date(a.date));
      
      eventsTimeline.innerHTML = sortedEvents.map(event => `
        <div class="event-item animate-fade-in">
          <div class="event-date">${formatDate(event.date)}</div>
          <div class="event-title">${event.title}</div>
          <div class="event-desc">${event.description}</div>
        </div>
      `).join('');
    }

    // Render notices
    function renderNotices() {
      if (!noticesList) return;
      
      // Sort notices by date (newest first)
      const sortedNotices = [...noticesData].sort((a, b) => new Date(b.date) - new Date(a.date));
      
      noticesList.innerHTML = sortedNotices.map(notice => `
        <div class="notice-item animate-fade-in">
          <div class="notice-priority priority-${notice.priority}">${notice.priority.toUpperCase()}</div>
          <div class="notice-title">${notice.title}</div>
          <div class="notice-date">${formatDate(notice.date)}</div>
          <div class="notice-desc">${notice.content}</div>
        </div>
      `).join('');
    }

    // Render timetable
    function renderTimetable() {
      if (!timetableContent) return;
      
      const classTimetable = timetableData[studentData.cls] || timetableData['1'];
      const days = Object.keys(classTimetable);
      
      if (!days.length) {
        timetableContent.innerHTML = '<div class="loading">Timetable not available for your class.</div>';
        return;
      }
      
      let tableHtml = '<table><thead><tr><th>Time</th>';
      
      // Add days to header
      days.forEach(day => {
        tableHtml += `<th>${day}</th>`;
      });
      tableHtml += '</tr></thead><tbody>';
      
      // Get all time slots
      const timeSlots = Object.keys(classTimetable[days[0]]);
      
      // Create rows for each time slot
      timeSlots.forEach(time => {
        tableHtml += `<tr><td>${time}</td>`;
        days.forEach(day => {
          tableHtml += `<td>${classTimetable[day][time] || ''}</td>`;
        });
        tableHtml += '</tr>';
      });
      
      tableHtml += '</tbody></table>';
      timetableContent.innerHTML = tableHtml;
    }

    // Render gallery
    function renderGallery() {
      if (!galleryGrid) return;
      
      galleryGrid.innerHTML = galleryData.map(item => `
        <div class="gallery-item animate-fade-in" onclick="openLightbox(${item.id})">
          <img src="${item.url}" alt="${item.title}" />
        </div>
      `).join('');
    }

    // Render FAQ
    function renderFAQ() {
      if (!faqList) return;
      
      faqList.innerHTML = faqData.map(faq => `
        <div class="faq-item animate-fade-in">
          <div class="faq-question">
            ${faq.question}
            <span class="faq-toggle">+</span>
          </div>
          <div class="faq-answer">${faq.answer}</div>
        </div>
      `).join('');
      
      // Add event listeners to FAQ items
      document.querySelectorAll('.faq-question').forEach(question => {
        question.addEventListener('click', () => {
          const item = question.parentElement;
          item.classList.toggle('active');
          question.querySelector('.faq-toggle').textContent = item.classList.contains('active') ? '−' : '+';
        });
      });
    }

    // Update analytics
    function updateAnalytics() {
      if (!homeworkCount || !teachersCount) return;
      
      const studentHomework = homeworkData.filter(hw => hw.class === studentData.cls);
      const completedHomework = studentHomework.filter(hw => hw.completed);
      
      homeworkCount.textContent = `${completedHomework.length}/${studentHomework.length}`;
      teachersCount.textContent = teachersData.length;
    }

    // Format date
    function formatDate(dateString) {
      const options = { year: 'numeric', month: 'short', day: 'numeric' };
      return new Date(dateString).toLocaleDateString(undefined, options);
    }

    // Export all data
    function exportAllData() {
      const data = {
        mkps_student: localStorage.getItem('mkps_student'),
        mkps_homework: localStorage.getItem('mkps_homework'),
        mkps_teachers: localStorage.getItem('mkps_teachers'),
        mkps_events: localStorage.getItem('mkps_events'),
        mkps_notices: localStorage.getItem('mkps_notices'),
        mkps_timetable: localStorage.getItem('mkps_timetable'),
        mkps_gallery: localStorage.getItem('mkps_gallery'),
        mkps_messages: localStorage.getItem('mkps_messages'),
        mkps_faq: localStorage.getItem('mkps_faq'),
        exportedAt: new Date().toISOString()
      };
      
      const dataStr = JSON.stringify(data, null, 2);
      const dataBlob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(dataBlob);
      
      const link = document.createElement('a');
      link.href = url;
      link.download = `mkps_data_export_${new Date().toISOString().split('T')[0]}.json`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    }

    // Import data
    function importData() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      
      input.onchange = e => {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(event) {
          try {
            const importedData = JSON.parse(event.target.result);
            
            // Validate and import each key
            const keys = [
              'mkps_student', 'mkps_homework', 'mkps_teachers', 'mkps_events',
              'mkps_notices', 'mkps_timetable', 'mkps_gallery', 'mkps_messages', 'mkps_faq'
            ];
            
            keys.forEach(key => {
              if (importedData[key] !== undefined) {
                localStorage.setItem(key, importedData[key]);
              }
            });
            
            // Update timestamp
            localStorage.setItem('mkps_update', Date.now().toString());
            
            // Reload data
            loadData();
            renderHomework();
            renderTeachers();
            renderEvents();
            renderNotices();
            renderTimetable();
            renderGallery();
            updateAnalytics();
            
            alert('Data imported successfully!');
            
          } catch (e) {
            alert('Error importing data: Invalid JSON format');
            console.error('Import error:', e);
          }
        };
        reader.readAsText(file);
      };
      
      input.click();
    }

    // Download snapshot (printable HTML)
    function downloadSnapshot() {
      // Create a printable version
      const printContent = document.createElement('div');
      printContent.innerHTML = `
        <h1>Milli Karwaan Public School Balrampur</h1>
        <p><strong>Student:</strong> ${studentData.name} (Class ${studentData.cls})</p>
        <p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p>
        <hr>
        
        <h2>Homework</h2>
        ${Array.from(homeworkList.children).map(el => el.outerHTML).join('')}
        
        <h2>Teachers</h2>
        ${Array.from(teachersGrid.children).map(el => {
          const name = el.querySelector('.teacher-name').textContent;
          const subject = el.querySelector('.teacher-subject').textContent;
          const contact = Array.from(el.querySelectorAll('.teacher-contact a')).map(a => a.textContent).join(', ');
          return `<p><strong>${name}</strong> - ${subject} (${contact})</p>`;
        }).join('')}
        
        <h2>Upcoming Events</h2>
        ${Array.from(eventsTimeline.children).map(el => {
          const date = el.querySelector('.event-date').textContent;
          const title = el.querySelector('.event-title').textContent;
          const desc = el.querySelector('.event-desc').textContent;
          return `<p><strong>${date}:</strong> ${title} - ${desc}</p>`;
        }).join('')}
        
        <h2>Notices</h2>
        ${Array.from(noticesList.children).map(el => {
          const priority = el.querySelector('.notice-priority').textContent;
          const title = el.querySelector('.notice-title').textContent;
          const date = el.querySelector('.notice-date').textContent;
          const content = el.querySelector('.notice-desc').textContent;
          return `<p><strong>${priority}</strong> ${date}: ${title} - ${content}</p>`;
        }).join('')}
      `;
      
      // Open print dialog
      const printWindow = window.open('', '_blank');
      printWindow.document.write(`
        <html>
          <head>
            <title>MKPS Snapshot - ${studentData.name}</title>
            <style>
              body { font-family: Arial, sans-serif; margin: 20px; }
              h1 { color: #1e40af; }
              h2 { color: #1e40af; border-bottom: 2px solid #1e40af; padding-bottom: 5px; margin-top: 20px; }
              .homework-card { border: 1px solid #ddd; margin: 10px 0; padding: 10px; border-radius: 5px; }
              .homework-header { background-color: #1e40af; color: white; padding: 5px; margin: -10px -10px 10px -10px; }
              .homework-subject { font-weight: bold; }
            </style>
          </head>
          <body>
            ${printContent.innerHTML}
            <script>setTimeout(() => window.print(), 500);</script>
          </body>
        </html>
      `);
      printWindow.document.close();
    }

    // Export selected homework
    function exportSelectedHomework() {
      const checked = document.querySelectorAll('.completion-checkbox input:checked');
      if (checked.length === 0) {
        alert('Please select at least one homework item to export.');
        return;
      }
      
      const selectedIds = Array.from(checked).map(cb => parseInt(cb.dataset.id));
      const selectedHomework = homeworkData.filter(hw => selectedIds.includes(hw.id));
      
      const dataStr = JSON.stringify(selectedHomework, null, 2);
      const dataBlob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(dataBlob);
      
      const link = document.createElement('a');
      link.href = url;
      link.download = `mkps_homework_selected_${new Date().toISOString().split('T')[0]}.json`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    }

    // Mark selected homework as done
    function markSelectedDone() {
      const checked = document.querySelectorAll('.completion-checkbox input:not(:checked)');
      if (checked.length === 0) {
        alert('No incomplete homework items selected.');
        return;
      }
      
      // Get first few items to mark as done
      const toMark = Array.from(checked).slice(0, 3); // Mark up to 3 at a time
      
      if (toMark.length === 0) {
        alert('All homework is already marked as done.');
        return;
      }
      
      toMark.forEach(checkbox => {
        checkbox.checked = true;
        const hwId = parseInt(checkbox.dataset.id);
        const hw = homeworkData.find(h => h.id === hwId);
        if (hw) {
          hw.completed = true;
        }
      });
      
      try {
        localStorage.setItem('mkps_homework', JSON.stringify(homeworkData));
        localStorage.setItem('mkps_update', Date.now().toString());
        renderHomework();
        updateAnalytics();
        alert(`Marked ${toMark.length} homework item(s) as completed!`);
      } catch (e) {
        alert('Error saving changes. Please try again.');
        console.error('Error saving homework:', e);
      }
    }

    // Toggle theme
    function toggleTheme() {
      document.documentElement.setAttribute('data-theme', themeToggle.checked ? 'dark' : 'light');
      localStorage.setItem('mkps_theme', themeToggle.checked ? 'dark' : 'light');
      themeText.textContent = themeToggle.checked ? 'Light Mode' : 'Dark Mode';
    }

    // Lightbox functions
    function openLightbox(id) {
      const item = galleryData.find(g => g.id === id);
      if (!item) return;
      
      lightboxImg.src = item.url;
      lightboxImg.alt = item.title;
      lightbox.classList.add('active');
    }

    function showPrevImage() {
      const currentIndex = galleryData.findIndex(g => g.url === lightboxImg.src);
      if (currentIndex > 0) {
        const prevItem = galleryData[currentIndex - 1];
        lightboxImg.src = prevItem.url;
        lightboxImg.alt = prevItem.title;
      }
    }

    function showNextImage() {
      const currentIndex = galleryData.findIndex(g => g.url === lightboxImg.src);
      if (currentIndex < galleryData.length - 1) {
        const nextItem = galleryData[currentIndex + 1];
        lightboxImg.src = nextItem.url;
        lightboxImg.alt = nextItem.title;
      }
    }

    // Global functions for admin.html
    window.renderHomeworkFor = function(classNo) {
      const oldCls = studentData.cls;
      studentData.cls = classNo;
      renderHomework();
      studentData.cls = oldCls;
    };

    window.refreshTeachers = function() {
      loadData();
      renderTeachers();
    };

    window.refreshEvents = function() {
      loadData();
      renderEvents();
    };

    window.reloadAll = function() {
      loadData();
      renderHomework();
      renderTeachers();
      renderEvents();
      renderNotices();
      renderTimetable();
      renderGallery();
      updateAnalytics();
    };

    // Initialize on load
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
