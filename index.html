<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Milli Karwaan Public School</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <style>
    /* === GLOBAL STYLES === */
    :root {
      --primary: #e53e3e;
      --primary-light: #fbb6b6;
      --primary-dark: #c53030;
      --text: #1a202c;
      --text-light: #4a5568;
      --bg: #ffffff;
      --bg-alt: #f7fafc;
      --card-bg: #ffffff;
      --border: #e2e8f0;
      --shadow: rgba(0, 0, 0, 0.1);
      --success: #38a169;
      --warning: #dd6b20;
      --danger: #e53e3e;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .dark-mode {
      --text: #f7fafc;
      --text-light: #cbd5e0;
      --bg: #1a202c;
      --bg-alt: #2d3748;
      --card-bg: #2d3748;
      --border: #4a5568;
      --shadow: rgba(0, 0, 0, 0.3);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg);
      color: var(--text);
      line-height: 1.6;
      transition: var(--transition);
      min-height: 100vh;
    }

    img {
      max-width: 100%;
      border-radius: 8px;
      transition: var(--transition);
    }

    a {
      color: var(--primary);
      text-decoration: none;
      transition: var(--transition);
    }

    a:hover {
      color: var(--primary-dark);
    }

    .container {
      width: 90%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      background-color: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 4px 6px var(--shadow);
    }

    .btn:hover {
      background-color: var(--primary-dark);
      transform: translateY(-2px);
    }

    .btn-outline {
      background: transparent;
      border: 2px solid var(--primary);
      color: var(--primary);
    }

    .btn-outline:hover {
      background-color: var(--primary);
      color: white;
    }

    .btn-sm {
      padding: 6px 12px;
      font-size: 0.875rem;
    }

    .btn-danger {
      background-color: var(--danger);
    }

    .btn-danger:hover {
      background-color: #c53030;
    }

    .card {
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 4px 12px var(--shadow);
      transition: var(--transition);
      border: 1px solid var(--border);
      overflow: hidden;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px var(--shadow);
    }

    .section-title {
      font-size: 1.75rem;
      margin-bottom: 1.5rem;
      color: var(--primary);
      position: relative;
      display: inline-block;
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 0;
      width: 50px;
      height: 3px;
      background-color: var(--primary);
      border-radius: 2px;
    }

    /* === HEADER === */
    header {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      padding: 20px 0;
      text-align: center;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 4px 12px var(--shadow);
    }

    .school-header {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
    }

    .logo {
      height: 80px;
      border-radius: 50%;
      border: 3px solid white;
      box-shadow: 0 4px 8px var(--shadow);
    }

    .school-info h1 {
      font-size: 1.8rem;
      font-weight: 700;
    }

    .school-info p {
      font-size: 0.95rem;
      opacity: 0.9;
    }

    /* === LOGIN GATE === */
    .login-gate {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, var(--bg-alt), var(--bg));
    }

    .login-card {
      width: 100%;
      max-width: 500px;
    }

    .form-group {
      margin-bottom: 16px;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-weight: 500;
      color: var(--text-light);
    }

    input, select, textarea {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid var(--border);
      border-radius: 8px;
      font-size: 1rem;
      background-color: var(--bg);
      color: var(--text);
      transition: var(--transition);
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(229, 62, 62, 0.2);
    }

    /* === NAVIGATION === */
    nav {
      margin: 20px 0;
      display: flex;
      overflow-x: auto;
      gap: 10px;
      padding: 10px 0;
      scrollbar-width: none;
    }

    nav::-webkit-scrollbar {
      display: none;
    }

    .nav-link {
      padding: 10px 16px;
      background-color: var(--bg-alt);
      border-radius: 8px;
      font-weight: 500;
      white-space: nowrap;
      transition: var(--transition);
      border: 1px solid var(--border);
    }

    .nav-link.active {
      background-color: var(--primary);
      color: white;
      border-color: var(--primary);
    }

    .nav-link:hover:not(.active) {
      background-color: var(--primary-light);
      color: var(--primary-dark);
    }

    /* === CONTENT === */
    .content {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }

    .content.active {
      opacity: 1;
      transform: translateY(0);
    }

    .grid-2 {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .grid-3 {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .teacher-card {
      text-align: center;
    }

    .teacher-img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      margin: 0 auto 12px;
      border: 3px solid var(--primary-light);
    }

    .event-card, .notice-card {
      position: relative;
    }

    .event-date, .notice-date {
      position: absolute;
      top: 16px;
      right: 16px;
      background-color: var(--primary);
      color: white;
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .timetable {
      width: 100%;
      border-collapse: collapse;
      margin-top: 16px;
    }

    .timetable th, .timetable td {
      padding: 12px;
      text-align: center;
      border: 1px solid var(--border);
    }

    .timetable th {
      background-color: var(--primary-light);
      color: var(--text);
      font-weight: 600;
    }

    .timetable tr:nth-child(even) {
      background-color: var(--bg-alt);
    }

    /* === GALLERY === */
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 12px;
      margin-top: 16px;
    }

    .gallery-item {
      height: 180px;
      cursor: pointer;
      border-radius: 8px;
      overflow: hidden;
      position: relative;
    }

    .gallery-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }

    .gallery-item:hover img {
      transform: scale(1.1);
    }

    /* === LIGHTBOX === */
    .lightbox {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .lightbox.active {
      opacity: 1;
      pointer-events: all;
    }

    .lightbox-content {
      max-width: 90%;
      max-height: 90%;
      position: relative;
    }

    .lightbox-content img {
      max-width: 100%;
      max-height: 90vh;
      border: 3px solid white;
      border-radius: 8px;
    }

    .lightbox-close {
      position: absolute;
      top: -40px;
      right: 0;
      color: white;
      font-size: 30px;
      cursor: pointer;
      background: none;
      border: none;
    }

    .lightbox-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.5);
      color: white;
      border: none;
      padding: 10px;
      cursor: pointer;
      font-size: 20px;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .lightbox-prev {
      left: 10px;
    }

    .lightbox-next {
      right: 10px;
    }

    /* === FAQ === */
    .faq-item {
      margin-bottom: 16px;
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
    }

    .faq-question {
      padding: 16px;
      background-color: var(--bg-alt);
      font-weight: 600;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .faq-question::after {
      content: '+';
      font-size: 1.5rem;
      color: var(--primary);
    }

    .faq-question.active::after {
      content: '‚àí';
    }

    .faq-answer {
      padding: 0 16px;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .faq-answer.active {
      padding: 16px;
      max-height: 500px;
    }

    /* === FOOTER === */
    footer {
      background-color: var(--bg-alt);
      padding: 30px 0;
      margin-top: 40px;
      border-top: 1px solid var(--border);
    }

    .footer-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
    }

    .footer-section h3 {
      color: var(--primary);
      margin-bottom: 16px;
      font-size: 1.2rem;
    }

    .footer-section p, .footer-section a {
      margin-bottom: 8px;
      display: block;
      color: var(--text-light);
    }

    .tools {
      display: flex;
      gap: 10px;
      margin-top: 16px;
      flex-wrap: wrap;
    }

    /* === ANIMATIONS === */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .fade-in {
      animation: fadeIn 0.6s ease forwards;
    }

    /* === RESPONSIVE === */
    @media (max-width: 768px) {
      .school-header {
        flex-direction: column;
        text-align: center;
      }

      .logo {
        height: 60px;
      }

      .school-info h1 {
        font-size: 1.5rem;
      }

      .container {
        padding: 15px;
      }

      .card {
        padding: 18px;
      }

      .grid-2, .grid-3 {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- HEADER -->
  <header>
    <div class="container school-header">
      <img src="https://i.postimg.cc/ryGx49TB/erasebg-transformed.png" alt="MKPS Logo" class="logo" />
      <div class="school-info">
        <h1>Milli Karwaan Public School</h1>
        <p>Boluha Police Chowki, Balrampur | Est. 2005</p>
      </div>
    </div>
  </header>

  <!-- LOGIN GATE -->
  <div id="loginGate" class="login-gate">
    <div class="card login-card">
      <h2 class="section-title">Student Login</h2>
      <p>Welcome to Milli Karwaan Public School Portal. Please enter your details to continue.</p>
      <form id="loginForm" style="margin-top: 20px;">
        <div class="form-group">
          <label for="studentName">Student Name</label>
          <input type="text" id="studentName" required />
        </div>
        <div class="form-group">
          <label for="studentClass">Class</label>
          <select id="studentClass" required>
            <option value="">Select Class</option>
            <option value="1">Class 1</option>
            <option value="2">Class 2</option>
            <option value="3">Class 3</option>
            <option value="4">Class 4</option>
            <option value="5">Class 5</option>
            <option value="6">Class 6</option>
            <option value="7">Class 7</option>
            <option value="8">Class 8</option>
          </select>
        </div>
        <div class="form-group">
          <label for="parentName">Parent's Name</label>
          <input type="text" id="parentName" required />
        </div>
        <button type="submit" class="btn">Enter Portal</button>
      </form>
      <p style="margin-top: 15px; font-size: 0.9rem; color: var(--text-light);">
        Admin? <a href="admin.html" style="color: var(--primary);">Access Admin Panel</a>
      </p>
    </div>
  </div>

  <!-- MAIN CONTENT -->
  <div id="mainContent" style="display: none;">
    <div class="container">
      <!-- NAVIGATION -->
      <nav id="mainNav">
        <div class="nav-link active" data-tab="dashboard">Dashboard</div>
        <div class="nav-link" data-tab="homework">Homework</div>
        <div class="nav-link" data-tab="teachers">Teachers</div>
        <div class="nav-link" data-tab="events">Events</div>
        <div class="nav-link" data-tab="notices">Notices</div>
        <div class="nav-link" data-tab="timetable">Timetable</div>
        <div class="nav-link" data-tab="gallery">Gallery</div>
        <div class="nav-link" data-tab="faq">FAQ</div>
        <div class="nav-link" data-tab="contact">Contact</div>
      </nav>

      <!-- DASHBOARD -->
      <section id="dashboard" class="content active">
        <h2 class="section-title">Welcome, <span id="welcomeName"></span>!</h2>
        <p>You're logged in as Class <span id="welcomeClass"></span> student.</p>
        
        <div class="grid-2">
          <div class="card">
            <h3>üìÖ Today's Schedule</h3>
            <p id="todaysSchedule">Loading timetable...</p>
          </div>
          <div class="card">
            <h3>üìö Current Homework</h3>
            <p id="currentHomework">No homework assigned for your class.</p>
          </div>
        </div>

        <div class="card" style="margin-top: 20px;">
          <h3>üè´ School Information</h3>
          <p><strong>Address:</strong> Boluha Police Chowki, Balrampur</p>
          <p><strong>Phone:</strong> <a href="tel:9758919151" class="btn btn-sm">üìû CALL 9758919151</a></p>
          <p><strong>Email:</strong> <a href="mailto:madamsir066@gmail.com">madamsir066@gmail.com</a></p>
        </div>
      </section>

      <!-- HOMEWORK -->
      <section id="homework" class="content">
        <h2 class="section-title">Homework for Class <span id="homeworkClass"></span></h2>
        <div id="homeworkList">
          <!-- Homework items will be inserted here -->
        </div>
        <p id="noHomework" style="display: none; color: var(--text-light);">No homework assigned for your class.</p>
      </section>

      <!-- TEACHERS -->
      <section id="teachers" class="content">
        <h2 class="section-title">Our Teachers</h2>
        <div id="teachersList" class="grid-3">
          <!-- Teachers will be inserted here -->
        </div>
      </section>

      <!-- EVENTS -->
      <section id="events" class="content">
        <h2 class="section-title">Upcoming Events</h2>
        <div id="eventsList" class="grid-2">
          <!-- Events will be inserted here -->
        </div>
      </section>

      <!-- NOTICES -->
      <section id="notices" class="content">
        <h2 class="section-title">Important Notices</h2>
        <div id="noticesList" class="grid-2">
          <!-- Notices will be inserted here -->
        </div>
      </section>

      <!-- TIMETABLE -->
      <section id="timetable" class="content">
        <h2 class="section-title">Class Timetable</h2>
        <div class="card">
          <table class="timetable" id="classTimetable">
            <thead>
              <tr>
                <th>Time</th>
                <th>Monday</th>
                <th>Tuesday</th>
                <th>Wednesday</th>
                <th>Thursday</th>
                <th>Friday</th>
              </tr>
            </thead>
            <tbody>
              <!-- Timetable data will be inserted here -->
            </tbody>
          </table>
        </div>
      </section>

      <!-- GALLERY -->
      <section id="gallery" class="content">
        <h2 class="section-title">School Gallery</h2>
        <div id="galleryContainer" class="gallery">
          <!-- Gallery items will be inserted here -->
        </div>
      </section>

      <!-- FAQ -->
      <section id="faq" class="content">
        <h2 class="section-title">Frequently Asked Questions</h2>
        <div id="faqList">
          <!-- FAQ items will be inserted here -->
        </div>
      </section>

      <!-- CONTACT -->
      <section id="contact" class="content">
        <h2 class="section-title">Contact Us</h2>
        <div class="card">
          <form id="contactForm">
            <div class="form-group">
              <label for="contactName">Your Name</label>
              <input type="text" id="contactName" required />
            </div>
            <div class="form-group">
              <label for="contactEmail">Email Address</label>
              <input type="email" id="contactEmail" required />
            </div>
            <div class="form-group">
              <label for="contactSubject">Subject</label>
              <input type="text" id="contactSubject" required />
            </div>
            <div class="form-group">
              <label for="contactMessage">Message</label>
              <textarea id="contactMessage" rows="5" required></textarea>
            </div>
            <button type="submit" class="btn">Send Message</button>
          </form>
        </div>
      </section>

      <!-- TOOLS -->
      <div class="tools">
        <button id="darkModeToggle" class="btn btn-outline btn-sm">üåô Dark Mode</button>
        <button id="exportData" class="btn btn-outline btn-sm">üì§ Export Data</button>
        <button id="importData" class="btn btn-outline btn-sm">üì• Import Data</button>
        <button id="printPage" class="btn btn-outline btn-sm">üñ®Ô∏è Print</button>
        <a href="admin.html" class="btn btn-outline btn-sm">‚öôÔ∏è Admin Panel</a>
      </div>
    </div>
  </div>

  <!-- LIGHTBOX -->
  <div class="lightbox" id="lightbox">
    <button class="lightbox-close" id="lightboxClose">√ó</button>
    <button class="lightbox-nav lightbox-prev" id="lightboxPrev">‚Äπ</button>
    <div class="lightbox-content">
      <img id="lightboxImg" src="" alt="Enlarged view" />
    </div>
    <button class="lightbox-nav lightbox-next" id="lightboxNext">‚Ä∫</button>
  </div>

  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>üè´ About Us</h3>
          <p>Milli Karwaan Public School is committed to providing quality education with Islamic values to the children of Balrampur since 2005.</p>
        </div>
        <div class="footer-section">
          <h3>üìû Contact Info</h3>
          <p>üìû <a href="tel:9758919151">9758919151</a></p>
          <p>‚úâÔ∏è <a href="mailto:madamsir066@gmail.com">madamsir066@gmail.com</a></p>
          <p>üìç Boluha Police Chowki, Balrampur</p>
        </div>
        <div class="footer-section">
          <h3>üîó Quick Links</h3>
          <a href="#" class="nav-link-footer" data-tab="homework">Homework</a>
          <a href="#" class="nav-link-footer" data-tab="events">Events</a>
          <a href="#" class="nav-link-footer" data-tab="gallery">Gallery</a>
          <a href="admin.html">Admin Panel</a>
        </div>
      </div>
      <p style="text-align: center; margin-top: 30px; color: var(--text-light); font-size: 0.9rem;">
        &copy; 2023 Milli Karwaan Public School Balrampur. All rights reserved.
      </p>
    </div>
  </footer>

  <script>
    // === DATA MANAGEMENT ===
    const STORAGE_PREFIX = 'mkps_';
    
    // Initialize localStorage with demo data if empty
    function initializeData() {
      const keys = ['homework', 'teachers', 'events', 'notices', 'timetable', 'gallery', 'faq', 'messages'];
      let hasData = false;
      
      keys.forEach(key => {
        if (localStorage.getItem(STORAGE_PREFIX + key)) {
          hasData = true;
        }
      });
      
      if (!hasData) {
        // Seed data
        const demoData = {
          homework: [
            { class: 1, subject: 'Mathematics', assignment: 'Complete page 25-27 in workbook', date: '2023-10-15' },
            { class: 2, subject: 'English', assignment: 'Write 10 sentences using new vocabulary words', date: '2023-10-15' },
            { class: 3, subject: 'Science', assignment: 'Draw and label parts of a plant', date: '2023-10-16' },
            { class: 4, subject: 'Mathematics', assignment: 'Solve multiplication problems 1-20', date: '2023-10-16' },
            { class: 5, subject: 'Social Studies', assignment: 'Research project on Indian rivers', date: '2023-10-18' },
            { class: 6, subject: 'Science', assignment: 'Prepare for chapter 5 test', date: '2023-10-19' },
            { class: 7, subject: 'Mathematics', assignment: 'Algebra worksheet problems 1-15', date: '2023-10-19' },
            { class: 8, subject: 'English', assignment: 'Essay on "Importance of Education"', date: '2023-10-20' }
          ],
          teachers: [
            { name: 'Mrs. Fatima Khan', subject: 'Mathematics', class: '1-3', img: 'https://i.postimg.cc/28j0M3rN/woman.png' },
            { name: 'Mr. Ahmed Siddiqui', subject: 'English', class: '4-6', img: 'https://i.postimg.cc/44cD9sGh/man.png' },
            { name: 'Mrs. Ayesha Malik', subject: 'Science', class: '7-8', img: 'https://i.postimg.cc/28j0M3rN/woman.png' },
            { name: 'Mr. Usman Farooq', subject: 'Social Studies', class: '1-8', img: 'https://i.postimg.cc/44cD9sGh/man.png' },
            { name: 'Mrs. Zainab Hussain', subject: 'Urdu', class: '1-5', img: 'https://i.postimg.cc/28j0M3rN/woman.png' },
            { name: 'Mr. Iqbal Ahmed', subject: 'Islamic Studies', class: '1-8', img: 'https://i.postimg.cc/44cD9sGh/man.png' }
          ],
          events: [
            { title: 'Annual Sports Day', date: '2023-11-15', description: 'Annual sports competition for all classes. Parents are invited to attend.', img: 'https://i.postimg.cc/3xH6Lz8L/sports.jpg' },
            { title: 'Eid Festival', date: '2023-10-25', description: 'Celebration of Eid with cultural programs and food.', img: 'https://i.postimg.cc/65v9f1nG/eid.jpg' },
            { title: 'Parent-Teacher Meeting', date: '2023-11-05', description: 'Scheduled meeting to discuss student progress.', img: 'https://i.postimg.cc/XY3LrLhN/meeting.jpg' },
            { title: 'Science Exhibition', date: '2023-12-10', description: 'Students will present science projects.', img: 'https://i.postimg.cc/XY3LrLhN/meeting.jpg' }
          ],
          notices: [
            { title: 'School Closed', date: '2023-10-18', content: 'School will remain closed on October 18th for Dussehra holiday.' },
            { title: 'New Uniform Policy', date: '2023-10-10', content: 'All students are required to wear complete uniform starting November 1st.' },
            { title: 'Book Distribution', date: '2023-10-20', content: 'Textbooks for the new session will be distributed on October 20th.' },
            { title: 'PTA Meeting Reminder', date: '2023-11-04', content: 'Reminder: Parent-Teacher meeting is scheduled for November 5th at 10 AM.' }
          ],
          timetable: [
            { time: '8:00-8:45', mon: 'Math', tue: 'English', wed: 'Science', thu: 'Math', fri: 'English' },
            { time: '8:45-9:30', mon: 'English', tue: 'Math', wed: 'English', thu: 'Science', fri: 'Math' },
            { time: '9:30-10:15', mon: 'Science', tue: 'Science', wed: 'Math', thu: 'English', fri: 'Science' },
            { time: '10:15-11:00', mon: 'Urdu', tue: 'Urdu', wed: 'Urdu', thu: 'Urdu', fri: 'Urdu' },
            { time: '11:00-11:45', mon: 'Islamic', tue: 'Islamic', wed: 'Islamic', thu: 'Islamic', fri: 'Islamic' },
            { time: '11:45-12:30', mon: 'Social', tue: 'Social', wed: 'Social', thu: 'Social', fri: 'Social' },
            { time: '12:30-1:15', mon: 'Lunch', tue: 'Lunch', wed: 'Lunch', thu: 'Lunch', fri: 'Lunch' },
            { time: '1:15-2:00', mon: 'Arts', tue: 'Sports', wed: 'Arts', thu: 'Sports', fri: 'Arts' }
          ],
          gallery: [
            { img: 'https://i.postimg.cc/3xH6Lz8L/sports.jpg', title: 'Sports Day 2023' },
            { img: 'https://i.postimg.cc/65v9f1nG/eid.jpg', title: 'Eid Celebration' },
            { img: 'https://i.postimg.cc/XY3LrLhN/meeting.jpg', title: 'PTA Meeting' },
            { img: 'https://i.postimg.cc/28j0M3rN/woman.png', title: 'Classroom Activity' },
            { img: 'https://i.postimg.cc/44cD9sGh/man.png', title: 'Teacher Training' },
            { img: 'https://i.postimg.cc/3xH6Lz8L/sports.jpg', title: 'Annual Function' }
          ],
          faq: [
            { question: 'What are the school hours?', answer: 'School operates from 8:00 AM to 2:00 PM, Monday through Friday.' },
            { question: 'What is the admission process?', answer: 'Parents need to visit the school office with required documents to complete the admission process.' },
            { question: 'Are uniforms mandatory?', answer: 'Yes, all students are required to wear the complete school uniform during school days.' },
            { question: 'How can I contact my child\'s teacher?', answer: 'You can email the teacher directly or schedule a meeting through the school office.' },
            { question: 'What extracurricular activities are offered?', answer: 'We offer sports, arts, Quran recitation, and science club activities.' }
          ],
          messages: []
        };
        
        // Save all demo data
        Object.keys(demoData).forEach(key => {
          localStorage.setItem(STORAGE_PREFIX + key, JSON.stringify(demoData[key]));
        });
        
        console.log('Demo data initialized');
      }
    }

    // Get data from localStorage
    function getData(key) {
      const data = localStorage.getItem(STORAGE_PREFIX + key);
      return data ? JSON.parse(data) : [];
    }

    // Save data to localStorage
    function setData(key, data) {
      localStorage.setItem(STORAGE_PREFIX + key, JSON.stringify(data));
    }

    // === LOGIN SYSTEM ===
    const loginForm = document.getElementById('loginForm');
    const loginGate = document.getElementById('loginGate');
    const mainContent = document.getElementById('mainContent');
    
    loginForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      const studentName = document.getElementById('studentName').value;
      const studentClass = document.getElementById('studentClass').value;
      const parentName = document.getElementById('parentName').value;
      
      // Save to localStorage
      const studentData = { studentName, studentClass, parentName, loginTime: new Date().toISOString() };
      localStorage.setItem('mkps_student', JSON.stringify(studentData));
      
      // Show main content
      loginGate.style.display = 'none';
      mainContent.style.display = 'block';
      
      // Initialize app
      initApp();
    });

    // Check if already logged in
    function checkLogin() {
      const studentData = localStorage.getItem('mkps_student');
      if (studentData) {
        loginGate.style.display = 'none';
        mainContent.style.display = 'block';
        initApp();
      }
    }

    // === MAIN APPLICATION ===
    function initApp() {
      // Initialize data if needed
      initializeData();
      
      // Load student data
      const studentData = JSON.parse(localStorage.getItem('mkps_student'));
      document.getElementById('welcomeName').textContent = studentData.studentName;
      document.getElementById('welcomeClass').textContent = studentData.studentClass;
      document.getElementById('homeworkClass').textContent = studentData.studentClass;
      
      // Render all sections
      renderHomework();
      renderTeachers();
      renderEvents();
      renderNotices();
      renderTimetable();
      renderGallery();
      renderFAQ();
      updateDashboard();
      
      // Setup event listeners
      setupNavigation();
      setupDarkMode();
      setupTools();
      setupContactForm();
      setupLightbox();
      
      // Add fade-in animation
      setTimeout(() => {
        document.querySelectorAll('.content').forEach(content => {
          content.classList.add('active');
        });
      }, 100);
    }

    // === SECTION RENDERERS ===
    function renderHomework() {
      const homeworkList = document.getElementById('homeworkList');
      const noHomework = document.getElementById('noHomework');
      const studentData = JSON.parse(localStorage.getItem('mkps_student'));
      const homework = getData('homework');
      
      const classHomework = homework.filter(item => item.class == studentData.studentClass);
      
      if (classHomework.length === 0) {
        homeworkList.style.display = 'none';
        noHomework.style.display = 'block';
        return;
      }
      
      homeworkList.style.display = 'block';
      noHomework.style.display = 'none';
      
      homeworkList.innerHTML = classHomework.map(item => `
        <div class="card">
          <h3>${item.subject}</h3>
          <p><strong>Assignment:</strong> ${item.assignment}</p>
          <p><strong>Due Date:</strong> ${formatDate(item.date)}</p>
        </div>
      `).join('');
    }

    function renderTeachers() {
      const teachersList = document.getElementById('teachersList');
      const teachers = getData('teachers');
      
      teachersList.innerHTML = teachers.map(teacher => `
        <div class="card teacher-card">
          <img src="${teacher.img}" alt="${teacher.name}" class="teacher-img" />
          <h3>${teacher.name}</h3>
          <p><strong>Subject:</strong> ${teacher.subject}</p>
          <p><strong>Classes:</strong> ${teacher.class}</p>
        </div>
      `).join('');
    }

    function renderEvents() {
      const eventsList = document.getElementById('eventsList');
      const events = getData('events');
      
      eventsList.innerHTML = events.map(event => `
        <div class="card event-card">
          <div class="event-date">${formatDate(event.date)}</div>
          <img src="${event.img}" alt="${event.title}" />
          <h3>${event.title}</h3>
          <p>${event.description}</p>
        </div>
      `).join('');
    }

    function renderNotices() {
      const noticesList = document.getElementById('noticesList');
      const notices = getData('notices');
      
      noticesList.innerHTML = notices.map(notice => `
        <div class="card notice-card">
          <div class="notice-date">${formatDate(notice.date)}</div>
          <h3>${notice.title}</h3>
          <p>${notice.content}</p>
        </div>
      `).join('');
    }

    function renderTimetable() {
      const timetableBody = document.querySelector('#classTimetable tbody');
      const timetable = getData('timetable');
      
      timetableBody.innerHTML = timetable.map(row => `
        <tr>
          <td>${row.time}</td>
          <td>${row.mon}</td>
          <td>${row.tue}</td>
          <td>${row.wed}</td>
          <td>${row.thu}</td>
          <td>${row.fri}</td>
        </tr>
      `).join('');
    }

    function renderGallery() {
      const galleryContainer = document.getElementById('galleryContainer');
      const gallery = getData('gallery');
      
      galleryContainer.innerHTML = gallery.map(item => `
        <div class="gallery-item" data-img="${item.img}" data-title="${item.title}">
          <img src="${item.img}" alt="${item.title}" />
        </div>
      `).join('');
    }

    function renderFAQ() {
      const faqList = document.getElementById('faqList');
      const faq = getData('faq');
      
      faqList.innerHTML = faq.map(item => `
        <div class="faq-item">
          <div class="faq-question">${item.question}</div>
          <div class="faq-answer">
            <p>${item.answer}</p>
          </div>
        </div>
      `).join('');
      
      // Setup FAQ toggles
      document.querySelectorAll('.faq-question').forEach(question => {
        question.addEventListener('click', function() {
          this.classList.toggle('active');
          const answer = this.nextElementSibling;
          answer.classList.toggle('active');
        });
      });
    }

    function updateDashboard() {
      // Update today's schedule
      const timetable = getData('timetable');
      const today = new Date().getDay(); // 1-5 for Mon-Fri
      const dayNames = ['', 'mon', 'tue', 'wed', 'thu', 'fri'];
      const currentDay = dayNames[today];
      
      if (currentDay) {
        const schedule = timetable.map(t => `<strong>${t.time}:</strong> ${t[currentDay]}`).join('<br>');
        document.getElementById('todaysSchedule').innerHTML = schedule;
      } else {
        document.getElementById('todaysSchedule').textContent = "School is closed today.";
      }
      
      // Update current homework
      const studentData = JSON.parse(localStorage.getItem('mkps_student'));
      const homework = getData('homework');
      const classHomework = homework.filter(item => item.class == studentData.studentClass);
      
      if (classHomework.length > 0) {
        const homeworkText = classHomework.map(h => `${h.subject}: ${h.assignment}`).join('<br>');
        document.getElementById('currentHomework').innerHTML = homeworkText;
      }
    }

    // === NAVIGATION ===
    function setupNavigation() {
      document.querySelectorAll('[data-tab]').forEach(tab => {
        tab.addEventListener('click', function() {
          // Update active nav link
          document.querySelectorAll('.nav-link').forEach(t => t.classList.remove('active'));
          this.classList.add('active');
          
          // Show active content
          document.querySelectorAll('.content').forEach(content => {
            content.classList.remove('active');
          });
          
          const tabId = this.getAttribute('data-tab');
          document.getElementById(tabId).classList.add('active');
          
          // Smooth scroll to top
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });
      });
      
      // Footer nav links
      document.querySelectorAll('.nav-link-footer').forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const tabId = this.getAttribute('data-tab');
          document.querySelector(`[data-tab="${tabId}"]`).click();
        });
      });
    }

    // === DARK MODE ===
    function setupDarkMode() {
      const darkModeToggle = document.getElementById('darkModeToggle');
      const isDark = localStorage.getItem('mkps_darkMode') === 'true';
      
      if (isDark) {
        document.body.classList.add('dark-mode');
        darkModeToggle.textContent = '‚òÄÔ∏è Light Mode';
      }
      
      darkModeToggle.addEventListener('click', function() {
        document.body.classList.toggle('dark-mode');
        
        const isDarkMode = document.body.classList.contains('dark-mode');
        localStorage.setItem('mkps_darkMode', isDarkMode);
        this.textContent = isDarkMode ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
      });
    }

    // === TOOLS ===
    function setupTools() {
      // Export data
      document.getElementById('exportData').addEventListener('click', function() {
        const data = {};
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key.startsWith(STORAGE_PREFIX)) {
            data[key] = localStorage.getItem(key);
          }
        }
        
        const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(data, null, 2));
        const downloadAnchorNode = document.createElement('a');
        downloadAnchorNode.setAttribute("href", dataStr);
        downloadAnchorNode.setAttribute("download", "mkps_backup_" + new Date().toISOString().split('T')[0] + ".json");
        document.body.appendChild(downloadAnchorNode);
        downloadAnchorNode.click();
        downloadAnchorNode.remove();
      });
      
      // Import data
      document.getElementById('importData').addEventListener('click', function() {
        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.accept = '.json';
        
        fileInput.onchange = e => {
          const file = e.target.files[0];
          const reader = new FileReader();
          
          reader.onload = function(event) {
            try {
              const importedData = JSON.parse(event.target.result);
              
              // Confirm overwrite
              if (confirm(`Import ${Object.keys(importedData).length} items? This will overwrite existing data.`)) {
                Object.keys(importedData).forEach(key => {
                  if (key.startsWith(STORAGE_PREFIX)) {
                    localStorage.setItem(key, importedData[key]);
                  }
                });
                
                alert('Data imported successfully! Refreshing...');
                setTimeout(() => location.reload(), 1000);
              }
            } catch (e) {
              alert('Invalid JSON file!');
            }
          };
          
          reader.readAsText(file);
        };
        
        fileInput.click();
      });
      
      // Print
      document.getElementById('printPage').addEventListener('click', function() {
        window.print();
      });
    }

    // === CONTACT FORM ===
    function setupContactForm() {
      const contactForm = document.getElementById('contactForm');
      
      contactForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const name = document.getElementById('contactName').value;
        const email = document.getElementById('contactEmail').value;
        const subject = document.getElementById('contactSubject').value;
        const message = document.getElementById('contactMessage').value;
        
        const newMessage = {
          name,
          email,
          subject,
          message,
          timestamp: new Date().toISOString()
        };
        
        const messages = getData('messages');
        messages.push(newMessage);
        setData('messages', messages);
        
        alert('Thank you for your message! We will get back to you soon.');
        contactForm.reset();
      });
    }

    // === LIGHTBOX ===
    function setupLightbox() {
      const lightbox = document.getElementById('lightbox');
      const lightboxImg = document.getElementById('lightboxImg');
      const lightboxClose = document.getElementById('lightboxClose');
      const lightboxPrev = document.getElementById('lightboxPrev');
      const lightboxNext = document.getElementById('lightboxNext');
      
      let currentIndex = 0;
      const galleryItems = document.querySelectorAll('.gallery-item');
      const galleryImages = Array.from(galleryItems).map(item => ({
        img: item.getAttribute('data-img'),
        title: item.getAttribute('data-title')
      }));
      
      // Open lightbox
      galleryItems.forEach((item, index) => {
        item.addEventListener('click', function() {
          currentIndex = index;
          lightboxImg.src = this.getAttribute('data-img');
          lightbox.classList.add('active');
          document.body.style.overflow = 'hidden';
        });
      });
      
      // Close lightbox
      lightboxClose.addEventListener('click', () => {
        lightbox.classList.remove('active');
        document.body.style.overflow = '';
      });
      
      lightbox.addEventListener('click', (e) => {
        if (e.target === lightbox) {
          lightbox.classList.remove('active');
          document.body.style.overflow = '';
        }
      });
      
      // Navigation
      lightboxPrev.addEventListener('click', (e) => {
        e.stopPropagation();
        currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
        lightboxImg.src = galleryImages[currentIndex].img;
      });
      
      lightboxNext.addEventListener('click', (e) => {
        e.stopPropagation();
        currentIndex = (currentIndex + 1) % galleryImages.length;
        lightboxImg.src = galleryImages[currentIndex].img;
      });
      
      // Keyboard navigation
      document.addEventListener('keydown', (e) => {
        if (!lightbox.classList.contains('active')) return;
        
        if (e.key === 'Escape') {
          lightbox.classList.remove('active');
          document.body.style.overflow = '';
        } else if (e.key === 'ArrowLeft') {
          currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
          lightboxImg.src = galleryImages[currentIndex].img;
        } else if (e.key === 'ArrowRight') {
          currentIndex = (currentIndex + 1) % galleryImages.length;
          lightboxImg.src = galleryImages[currentIndex].img;
        }
      });
    }

    // === HELPERS ===
    function formatDate(dateString) {
      const options = { year: 'numeric', month: 'short', day: 'numeric' };
      return new Date(dateString).toLocaleDateString(undefined, options);
    }

    // === INITIALIZATION ===
    document.addEventListener('DOMContentLoaded', function() {
      checkLogin();
    });
  </script>
</body>
</html>
