<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milli Karwaan Public School Balrampur</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #1a3a6e;
            --secondary: #c9941a;
            --accent: #e6b878;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --border: #dee2e6;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --font-heading: 'Playfair Display', Georgia, serif;
        }

        .dark-mode {
            --primary: #1e3d73;
            --secondary: #d4a74a;
            --accent: #cfa06a;
            --light: #1a1a1a;
            --dark: #f0f0f0;
            --border: #444;
            --shadow: 0 4px 12px rgba(0,0,0,0.3);
            background-color: #121212;
            color: #f0f0f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: var(--font-main);
        }

        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            transition: var(--transition);
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Pre-login Form */
        .pre-login {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary), #2c5282);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
        }

        .login-form {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 500px;
            color: var(--dark);
        }

        .login-form h2 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary);
            font-size: 28px;
            font-family: var(--font-heading);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--primary);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(201, 148, 26, 0.2);
        }

        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23c9941a' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 15px;
        }

        .btn {
            display: inline-block;
            padding: 12px 30px;
            background-color: var(--primary);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            font-size: 16px;
        }

        .btn:hover {
            background-color: #152c55;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(26, 58, 110, 0.4);
        }

        .btn-block {
            display: block;
            width: 100%;
            text-align: center;
        }

        .error {
            color: var(--danger);
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }

        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            border-radius: 4px;
        }

        .alert-success {
            color: #155724;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }

        /* Header */
        header {
            background-color: var(--primary);
            color: white;
            padding: 15px 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
            font-size: 14px;
            background-color: rgba(0,0,0,0.1);
        }

        .contact-info {
            display: flex;
            gap: 20px;
        }

        .contact-info a {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .header-main {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo img {
            height: 60px;
            border-radius: 50%;
            border: 3px solid var(--accent);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .school-info h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 3px;
            font-family: var(--font-heading);
        }

        .school-info p {
            font-size: 12px;
            opacity: 0.9;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .header-actions .btn {
            padding: 8px 15px;
            font-size: 14px;
        }

        .clock {
            background-color: rgba(255,255,255,0.1);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
        }

        /* Navigation */
        .navbar {
            background-color: var(--primary);
            box-shadow: var(--shadow);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 0;
        }

        .nav-item {
            position: relative;
        }

        .nav-link {
            display: block;
            padding: 15px 20px;
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            border-right: 1px solid rgba(255,255,255,0.1);
        }

        .nav-link:hover, .nav-link.active {
            background-color: rgba(255,255,255,0.1);
            color: var(--accent);
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            min-width: 200px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            z-index: 1000;
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            border-radius: 4px;
            color: var(--dark);
        }

        .dropdown-menu.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .dropdown-item {
            padding: 12px 20px;
            display: block;
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
            border-bottom: 1px solid var(--border);
        }

        .dropdown-item:hover {
            background-color: var(--accent);
            color: white;
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100vh;
            background-color: var(--light);
            box-shadow: -5px 0 15px rgba(0,0,0,0.2);
            z-index: 1000;
            transition: var(--transition);
            overflow-y: auto;
            color: var(--dark);
            border-left: 1px solid var(--border);
        }

        .sidebar.active {
            right: 0;
        }

        .sidebar-header {
            padding: 20px;
            background-color: var(--primary);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .close-sidebar {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }

        .sidebar-body {
            padding: 20px;
        }

        .quick-links {
            margin-bottom: 30px;
        }

        .quick-links h4 {
            margin-bottom: 15px;
            color: var(--primary);
            font-size: 18px;
        }

        .quick-links ul {
            list-style: none;
        }

        .quick-links li {
            margin-bottom: 10px;
        }

        .quick-links a {
            color: var(--dark);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
        }

        .quick-links a:hover {
            color: var(--primary);
        }

        .analytics {
            background-color: var(--primary);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .analytics h4 {
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .analytics-item {
            text-align: center;
        }

        .analytics-number {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .analytics-label {
            font-size: 14px;
            opacity: 0.8;
        }

        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: var(--transition);
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: var(--transition);
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--secondary);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Main Content */
        main {
            padding: 30px 0;
            min-height: calc(100vh - 200px);
        }

        .section {
            margin-bottom: 60px;
        }

        .section-title {
            text-align: center;
            margin-bottom: 50px;
        }

        .section-title h2 {
            font-size: 32px;
            color: var(--primary);
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
            font-family: var(--font-heading);
        }

        .section-title h2:after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background-color: var(--secondary);
            border-radius: 2px;
        }

        .section-title p {
            color: #666;
            max-width: 700px;
            margin: 15px auto 0;
            font-size: 16px;
        }

        /* Hero */
        .hero {
            height: 70vh;
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1200&q=80') no-repeat center center/cover;
            display: flex;
            align-items: center;
            color: white;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 60px;
            overflow: hidden;
            position: relative;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            z-index: 1;
        }

        .hero h2 {
            font-size: 48px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            animation: fadeInDown 1s ease;
            font-family: var(--font-heading);
        }

        .hero p {
            font-size: 20px;
            margin-bottom: 30px;
            opacity: 0.9;
            animation: fadeInUp 1s ease 0.3s both;
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Homework Section */
        .homework {
            background-color: var(--light);
            padding: 60px 0;
        }

        .homework-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .homework-controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .search-box {
            display: flex;
            border: 1px solid var(--border);
            border-radius: 50px;
            overflow: hidden;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .search-box input {
            border: none;
            padding: 10px 15px;
            width: 250px;
            outline: none;
        }

        .search-box button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
        }

        .filter-select, .sort-select {
            padding: 10px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background-color: white;
            color: var(--dark);
        }

        .homework-grid {
            display: grid;
            gap: 20px;
        }

        .homework-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: var(--transition);
            border-top: 4px solid var(--primary);
        }

        .homework-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .homework-header-card {
            padding: 15px 20px;
            background-color: var(--primary);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .homework-subject {
            font-weight: 600;
            font-size: 18px;
        }

        .homework-date {
            font-size: 14px;
            opacity: 0.9;
        }

        .homework-body {
            padding: 20px;
        }

        .homework-teacher {
            font-size: 14px;
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .homework-details {
            line-height: 1.7;
            color: #555;
        }

        .homework-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 15px;
        }

        .homework-actions button {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            transition: var(--transition);
            font-size: 14px;
        }

        .homework-actions button:hover {
            color: var(--secondary);
        }

        /* Teachers Section */
        .teachers {
            padding: 60px 0;
            background-color: white;
        }

        .teachers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 30px;
        }

        .teacher-card {
            background-color: var(--light);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: var(--transition);
            text-align: center;
        }

        .teacher-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .teacher-image {
            height: 200px;
            overflow: hidden;
        }

        .teacher-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .teacher-card:hover .teacher-image img {
            transform: scale(1.1);
        }

        .teacher-info {
            padding: 20px;
        }

        .teacher-name {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .teacher-subject {
            color: var(--secondary);
            font-weight: 500;
            margin-bottom: 10px;
        }

        .teacher-qualification {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
        }

        .teacher-contact {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }

        .teacher-contact a {
            color: var(--primary);
            transition: var(--transition);
        }

        .teacher-contact a:hover {
            color: var(--secondary);
        }

        /* Events Timeline */
        .events {
            padding: 60px 0;
            background-color: var(--light);
        }

        .timeline {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
        }

        .timeline::after {
            content: '';
            position: absolute;
            width: 4px;
            background-color: var(--primary);
            top: 0;
            bottom: 0;
            left: 50%;
            margin-left: -2px;
        }

        .timeline-item {
            padding: 10px 40px;
            position: relative;
            width: 50%;
            box-sizing: border-box;
        }

        .timeline-item::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: white;
            border: 4px solid var(--secondary);
            border-radius: 50%;
            top: 15px;
            z-index: 1;
        }

        .timeline-item:nth-child(odd) {
            left: 0;
        }

        .timeline-item:nth-child(even) {
            left: 50%;
        }

        .timeline-item:nth-child(odd)::after {
            right: -12px;
        }

        .timeline-item:nth-child(even)::after {
            left: -12px;
        }

        .timeline-content {
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            position: relative;
        }

        .event-date {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 10px;
            display: block;
        }

        .event-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .event-desc {
            color: #666;
            line-height: 1.6;
        }

        .event-venue {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Notice Board */
        .notices {
            padding: 60px 0;
            background-color: white;
        }

        .notice-list {
            max-width: 800px;
            margin: 0 auto;
        }

        .notice-item {
            background-color: var(--light);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border-left: 4px solid var(--secondary);
            transition: var(--transition);
        }

        .notice-item:hover {
            transform: translateX(5px);
        }

        .notice-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .notice-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
        }

        .notice-badge {
            background-color: var(--secondary);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .notice-badge.admission { background-color: var(--success); }
        .notice-badge.holiday { background-color: var(--info); }
        .notice-badge.meeting { background-color: var(--warning); }
        .notice-badge.facility { background-color: var(--primary); }
        .notice-badge.exam { background-color: var(--danger); }
        .notice-badge.health { background-color: var(--info); }

        .notice-date {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
            display: block;
        }

        .notice-content {
            line-height: 1.7;
            color: #555;
        }

        .notice-actions {
            margin-top: 15px;
            display: flex;
            justify-content: flex-end;
        }

        .notice-actions button {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            transition: var(--transition);
            font-size: 14px;
        }

        .notice-actions button:hover {
            color: var(--secondary);
        }

        /* Timetable */
        .timetable {
            padding: 60px 0;
            background-color: var(--light);
        }

        .timetable-container {
            max-width: 1000px;
            margin: 0 auto;
            overflow-x: auto;
        }

        .timetable-table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .timetable-table th {
            background-color: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
        }

        .timetable-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }

        .timetable-table tr:last-child td {
            border-bottom: none;
        }

        .subject {
            font-weight: 600;
            color: var(--primary);
        }

        .room {
            font-size: 14px;
            color: var(--secondary);
        }

        .break {
            background-color: #f8f9fa;
            font-style: italic;
            color: #666;
        }

        /* Gallery */
        .gallery {
            padding: 60px 0;
            background-color: white;
        }

        .gallery-controls {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 15px;
            flex-wrap: wrap;
        }

        .gallery-filter {
            padding: 10px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background-color: white;
            cursor: pointer;
            transition: var(--transition);
        }

        .gallery-filter.active {
            background-color: var(--primary);
            color: white;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .gallery-item {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            height: 200px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            cursor: pointer;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .gallery-item:hover img {
            transform: scale(1.1);
        }

        .gallery-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(26, 58, 110, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: var(--transition);
        }

        .gallery-item:hover .gallery-overlay {
            opacity: 1;
        }

        .gallery-icon {
            color: white;
            font-size: 40px;
        }

        /* Lightbox */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .lightbox.active {
            display: flex;
        }

        .lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 80%;
        }

        .lightbox-image {
            max-width: 100%;
            max-height: 80vh;
            border-radius: 5px;
        }

        .lightbox-caption {
            color: white;
            text-align: center;
            margin-top: 20px;
            font-size: 18px;
        }

        .lightbox-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 15px;
        }

        .lightbox-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            opacity: 0.7;
            transition: var(--transition);
        }

        .lightbox-btn:hover {
            opacity: 1;
            transform: scale(1.2);
        }

        .lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: white;
            font-size: 36px;
            cursor: pointer;
            opacity: 0.5;
            transition: var(--transition);
        }

        .lightbox-nav:hover {
            opacity: 0.8;
            background-color: rgba(0,0,0,0.3);
            border-radius: 50%;
            padding: 10px;
        }

        .prev {
            left: 20px;
        }

        .next {
            right: 20px;
        }

        /* Contact Section */
        .contact {
            padding: 60px 0;
            background-color: var(--light);
        }

        .contact-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
        }

        .contact-info h3 {
            font-size: 24px;
            color: var(--primary);
            margin-bottom: 30px;
        }

        .contact-details {
            margin-bottom: 30px;
        }

        .contact-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 20px;
        }

        .contact-icon {
            width: 50px;
            height: 50px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .contact-text h4 {
            font-size: 18px;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .contact-text p, .contact-text a {
            color: #666;
            text-decoration: none;
            transition: var(--transition);
        }

        .contact-text a:hover {
            color: var(--primary);
        }

        .contact-form {
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .form-group label {
            margin-bottom: 8px;
            color: var(--primary);
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 5px;
            font-size: 16px;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(201, 148, 26, 0.2);
        }

        textarea.form-control {
            resize: vertical;
            min-height: 120px;
        }

        /* Student Portal */
        .student-portal {
            padding: 60px 0;
            background-color: white;
        }

        .portal-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .portal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .student-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .student-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 600;
        }

        .student-details h3 {
            color: var(--primary);
            margin-bottom: 5px;
        }

        .student-details p {
            color: #666;
            font-size: 14px;
        }

        .portal-tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 30px;
        }

        .tab {
            padding: 15px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: var(--transition);
        }

        .tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
            font-weight: 600;
        }

        .tab-content {
            display: none;
            padding: 20px 0;
        }

        .tab-content.active {
            display: block;
        }

        .progress-container {
            margin-bottom: 20px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .progress-bar {
            height: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary);
            border-radius: 5px;
            transition: width 0.3s ease;
        }

        .achievement {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background-color: var(--light);
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid var(--secondary);
        }

        .achievement-icon {
            width: 50px;
            height: 50px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .achievement-details h4 {
            color: var(--primary);
            margin-bottom: 5px;
        }

        .achievement-details p {
            color: #666;
            font-size: 14px;
        }

        /* Results Section */
        .results {
            padding: 60px 0;
            background-color: var(--light);
        }

        .results-container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .results-filters {
            display: flex;
            gap: 15px;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .results-table th {
            background-color: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
        }

        .results-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }

        .results-table tr:last-child td {
            border-bottom: none;
        }

        .grade {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }

        .grade-A { background-color: #d4edda; color: #155724; }
        .grade-B { background-color: #d1ecf1; color: #0c5460; }
        .grade-C { background-color: #fff3cd; color: #856404; }
        .grade-D { background-color: #f8d7da; color: #721c24; }
        .grade-F { background-color: #f8d7da; color: #721c24; }

        /* Attendance Section */
        .attendance {
            padding: 60px 0;
            background-color: white;
        }

        .attendance-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .attendance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .attendance-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .attendance-item {
            background-color: var(--light);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .attendance-number {
            font-size: 36px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .attendance-label {
            color: #666;
            font-weight: 500;
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-bottom: 20px;
        }

        .calendar-header {
            text-align: center;
            font-weight: 600;
            padding: 10px;
            background-color: var(--primary);
            color: white;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border);
            background-color: white;
            cursor: pointer;
            transition: var(--transition);
        }

        .calendar-day.present {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }

        .calendar-day.absent {
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }

        .calendar-day.holiday {
            background-color: #d1ecf1;
            border-color: #bee5eb;
        }

        .calendar-day:hover {
            transform: scale(1.05);
        }

        /* Parent-Teacher Communication */
        .communication {
            padding: 60px 0;
            background-color: var(--light);
        }

        .messages-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .messages-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .message-list {
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid var(--border);
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .message {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            gap: 15px;
        }

        .message:last-child {
            border-bottom: none;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 600;
        }

        .message-content {
            flex: 1;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .message-sender {
            font-weight: 600;
            color: var(--primary);
        }

        .message-time {
            font-size: 12px;
            color: #666;
        }

        .message-text {
            color: #555;
            line-height: 1.6;
        }

        .message-form {
            display: flex;
            gap: 10px;
        }

        .message-form input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid var(--border);
            border-radius: 5px;
        }

        .message-form button {
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        /* Footer */
        footer {
            background-color: var(--primary);
            color: white;
            padding: 60px 0 30px;
        }

        .footer-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-col h4 {
            font-size: 20px;
            margin-bottom: 25px;
            position: relative;
            padding-bottom: 10px;
            font-family: var(--font-heading);
        }

        .footer-col h4:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 3px;
            background-color: var(--secondary);
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer-links a:hover {
            color: var(--accent);
            transform: translateX(5px);
        }

        .footer-links i {
            font-size: 14px;
            opacity: 0.7;
        }

        .footer-contact p {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            color: rgba(255,255,255,0.8);
        }

        .footer-contact i {
            color: var(--accent);
            font-size: 18px;
        }

        .footer-newsletter p {
            margin-bottom: 20px;
            color: rgba(255,255,255,0.8);
        }

        .newsletter-form {
            display: flex;
        }

        .newsletter-input {
            flex: 1;
            padding: 12px 15px;
            border: none;
            border-radius: 5px 0 5px 0;
            font-size: 16px;
        }

        .newsletter-btn {
            background-color: var(--secondary);
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 0 5px 5px 0;
            cursor: pointer;
            font-size: 16px;
            transition: var(--transition);
        }

        .newsletter-btn:hover {
            background-color: #b58215;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.7);
            font-size: 14px;
        }

        /* Floating Call Button */
        .floating-call {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background-color: var(--secondary);
            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            cursor: pointer;
            z-index: 100;
            animation: pulse 2s infinite;
            transition: var(--transition);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .floating-call:hover {
            transform: scale(1.1);
            background-color: #b58215;
        }

        /* Export/Import Controls */
        .export-import {
            position: fixed;
            bottom: 30px;
            left: 30px;
            display: flex;
            gap: 10px;
            z-index: 100;
        }

        .export-import button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: var(--transition);
        }

        .export-import button:hover {
            background-color: #152c55;
        }

        /* Print Button */
        .print-btn {
            position: fixed;
            bottom: 30px;
            left: 180px;
            background-color: var(--secondary);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: var(--transition);
            z-index: 100;
        }

        .print-btn:hover {
            background-color: #b58215;
        }

        /* Back to Top Button */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 100px;
            width: 50px;
            height: 50px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            z-index: 100;
        }

        .back-to-top.show {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            background-color: var(--secondary);
            transform: translateY(-3px);
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .contact-container {
                grid-template-columns: 1fr;
            }

            .homework-header {
                flex-direction: column;
                align-items: stretch;
            }

            .homework-controls {
                justify-content: center;
            }

            .timeline::after {
                left: 31px;
            }

            .timeline-item {
                width: 100%;
                padding-left: 70px;
                padding-right: 25px;
            }

            .timeline-item:nth-child(even) {
                left: 0;
            }

            .timeline-item::after {
                left: 15px;
            }

            .student-portal, .results, .attendance, .communication {
                padding: 40px 0;
            }
        }

        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }

            .nav-menu {
                position: fixed;
                top: 80px;
                right: -100%;
                width: 80%;
                height: calc(100vh - 80px);
                background-color: var(--primary);
                flex-direction: column;
                align-items: center;
                justify-content: flex-start;
                padding: 40px 0;
                transition: var(--transition);
                overflow-y: auto;
                box-shadow: -5px 0 15px rgba(0,0,0,0.2);
            }

            .nav-menu.active {
                right: 0;
            }

            .nav-item {
                margin: 15px 0;
            }

            .nav-link {
                padding: 15px 20px;
                border-right: none;
                border-bottom: 1px solid rgba(255,255,255,0.1);
                width: 100%;
                text-align: center;
            }

            .header-main {
                flex-wrap: wrap;
                gap: 15px;
            }

            .hero h2 {
                font-size: 32px;
            }

            .section-title h2 {
                font-size: 28px;
            }

            .login-form {
                margin: 20px;
                padding: 30px 20px;
            }

            .sidebar {
                width: 100%;
            }

            .attendance-summary {
                grid-template-columns: 1fr;
            }

            .export-import, .print-btn, .back-to-top {
                bottom: 20px;
            }

            .export-import {
                left: 20px;
            }

            .print-btn {
                left: 150px;
            }

            .back-to-top {
                right: 20px;
            }
        }

        @media (max-width: 576px) {
            .header-top {
                flex-direction: column;
                gap: 10px;
            }

            .contact-info, .header-actions {
                justify-content: center;
            }

            .logo {
                flex-direction: column;
                text-align: center;
            }

            .school-info h1 {
                font-size: 20px;
            }

            .hero {
                height: 50vh;
            }

            .hero h2 {
                font-size: 28px;
            }

            .floating-call {
                width: 50px;
                height: 50px;
                bottom: 20px;
                right: 20px;
            }

            .calendar {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* Print Styles */
        @media print {
            .no-print, .no-print * {
                display: none !important;
            }
            
            body {
                background: white !important;
                color: black !important;
            }
            
            .sidebar, .floating-call, .export-import, .print-btn, .back-to-top, .menu-toggle {
                display: none !important;
            }
            
            .nav-menu {
                display: flex !important;
                position: static !important;
                width: auto !important;
                height: auto !important;
                background: transparent !important;
                box-shadow: none !important;
            }
            
            .nav-link {
                color: black !important;
            }
            
            .pre-login {
                display: none !important;
            }
            
            .hero {
                height: auto !important;
                background: none !important;
            }
            
            .hero-content {
                color: black !important;
            }
            
            .hero h2, .hero p {
                color: black !important;
                text-shadow: none !important;
            }
        }

        /* Animations */
        @keyframes slideInUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .animate {
            animation: slideInUp 0.6s ease forwards;
        }

        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }
        .delay-5 { animation-delay: 0.5s; }
    </style>
</head>
<body>
    <!-- Pre-login Form -->
    <div class="pre-login" id="preLogin">
        <div class="login-form">
            <h2>Welcome to Milli Karwaan Public School</h2>
            <form id="studentForm">
                <div class="form-group">
                    <label for="studentName">Student Name</label>
                    <input type="text" class="form-control" id="studentName" required>
                    <div class="error" id="nameError">Please enter your name</div>
                </div>
                <div class="form-group">
                    <label for="studentClass">Class</label>
                    <select class="form-control" id="studentClass" required>
                        <option value="">Select Class</option>
                        <option value="1">Class 1</option>
                        <option value="2">Class 2</option>
                        <option value="3">Class 3</option>
                        <option value="4">Class 4</option>
                        <option value="5">Class 5</option>
                        <option value="6">Class 6</option>
                        <option value="7">Class 7</option>
                        <option value="8">Class 8</option>
                        <option value="9">Class 9</option>
                        <option value="10">Class 10</option>
                        <option value="11">Class 11</option>
                        <option value="12">Class 12</option>
                    </select>
                    <div class="error" id="classError">Please select your class</div>
                </div>
                <div class="form-group">
                    <label for="parentName">Parent's Name</label>
                    <input type="text" class="form-control" id="parentName" required>
                    <div class="error" id="parentError">Please enter parent's name</div>
                </div>
                <button type="submit" class="btn btn-block">Enter School Portal</button>
            </form>
        </div>
    </div>

    <!-- Header -->
    <header>
        <div class="header-top">
            <div class="contact-info">
                <a href="tel:9758919151"><i class="fas fa-phone"></i> +91 9758919151</a>
                <a href="mailto:madamsir066@gmail.com"><i class="fas fa-envelope"></i> madamsir066@gmail.com</a>
            </div>
            <div class="clock" id="clock">Loading time...</div>
        </div>
        <div class="container header-main">
            <div class="logo">
                <img src="https://i.postimg.cc/ryGx49TB/erasebg-transformed.png" alt="Milli Karwaan Public School Logo">
                <div class="school-info">
                    <h1>Milli Karwaan Public School</h1>
                    <p>Boluha Police Chowki, Balrampur</p>
                </div>
            </div>
            <div class="header-actions">
                <a href="tel:9758919151" class="btn"><i class="fas fa-phone"></i> Call Now</a>
                <button class="menu-toggle" id="menuToggle"><i class="fas fa-ellipsis-v"></i></button>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-container">
            <ul class="nav-menu" id="navMenu">
                <li class="nav-item"><a href="#home" class="nav-link active">Home</a></li>
                <li class="nav-item"><a href="#homework" class="nav-link">Homework</a></li>
                <li class="nav-item"><a href="#teachers" class="nav-link">Teachers</a></li>
                <li class="nav-item"><a href="#events" class="nav-link">Events</a></li>
                <li class="nav-item"><a href="#notices" class="nav-link">Notices</a></li>
                <li class="nav-item"><a href="#timetable" class="nav-link">Timetable</a></li>
                <li class="nav-item"><a href="#gallery" class="nav-link">Gallery</a></li>
                <li class="nav-item"><a href="#student-portal" class="nav-link">Portal</a></li>
                <li class="nav-item"><a href="#results" class="nav-link">Results</a></li>
                <li class="nav-item"><a href="#attendance" class="nav-link">Attendance</a></li>
                <li class="nav-item"><a href="#communication" class="nav-link">Messages</a></li>
                <li class="nav-item"><a href="#contact" class="nav-link">Contact</a></li>
            </ul>
            <div class="dropdown-menu" id="dropdownMenu">
                <a href="#" class="dropdown-item" id="exportData"><i class="fas fa-file-export"></i> Export Data</a>
                <a href="#" class="dropdown-item" id="importData"><i class="fas fa-file-import"></i> Import Data</a>
                <a href="#" class="dropdown-item" id="printSite"><i class="fas fa-print"></i> Print Site</a>
                <a href="#" class="dropdown-item" id="openSidebar"><i class="fas fa-sliders-h"></i> Settings</a>
            </div>
        </div>
    </nav>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3>Settings</h3>
            <button class="close-sidebar" id="closeSidebar"><i class="fas fa-times"></i></button>
        </div>
        <div class="sidebar-body">
            <div class="quick-links">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="#homework"><i class="fas fa-book"></i> Homework</a></li>
                    <li><a href="#teachers"><i class="fas fa-chalkboard-teacher"></i> Teachers</a></li>
                    <li><a href="#events"><i class="fas fa-calendar-alt"></i> Events</a></li>
                    <li><a href="#notices"><i class="fas fa-bullhorn"></i> Notices</a></li>
                    <li><a href="#timetable"><i class="fas fa-table"></i> Timetable</a></li>
                    <li><a href="#gallery"><i class="fas fa-images"></i> Gallery</a></li>
                    <li><a href="#student-portal"><i class="fas fa-user-graduate"></i> Student Portal</a></li>
                    <li><a href="#results"><i class="fas fa-award"></i> Results</a></li>
                    <li><a href="#attendance"><i class="fas fa-calendar-check"></i> Attendance</a></li>
                    <li><a href="#communication"><i class="fas fa-comments"></i> Messages</a></li>
                    <li><a href="#contact"><i class="fas fa-envelope"></i> Contact</a></li>
                </ul>
            </div>

            <div class="analytics">
                <h4>Student Analytics</h4>
                <div class="analytics-grid">
                    <div class="analytics-item">
                        <div class="analytics-number" id="homeworkCount">0</div>
                        <div class="analytics-label">Homework</div>
                    </div>
                    <div class="analytics-item">
                        <div class="analytics-number" id="noticeCount">0</div>
                        <div class="analytics-label">Notices</div>
                    </div>
                    <div class="analytics-item">
                        <div class="analytics-number" id="eventCount">0</div>
                        <div class="analytics-label">Events</div>
                    </div>
                    <div class="analytics-item">
                        <div class="analytics-number" id="teacherCount">0</div>
                        <div class="analytics-label">Teachers</div>
                    </div>
                </div>
            </div>

            <div class="theme-toggle">
                <span>Dark Mode</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="themeToggle">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container" id="mainContent">
        <!-- Hero Section -->
        <section class="hero" id="home">
            <div class="hero-content">
                <h2>Welcome to Milli Karwaan Public School</h2>
                <p>Excellence in education with a focus on character building and holistic development since 1995.</p>
                <div class="hero-buttons">
                    <a href="#homework" class="btn">View Homework</a>
                    <a href="#contact" class="btn btn-outline">Contact Us</a>
                </div>
            </div>
        </section>

        <!-- Homework Section -->
        <section class="homework" id="homework">
            <div class="container">
                <div class="section-title">
                    <h2>Homework Assignments</h2>
                    <p>Latest homework assignments for your class</p>
                </div>
                <div class="homework-header">
                    <h3>Class <span id="currentClass">X</span> Homework</h3>
                    <div class="homework-controls">
                        <div class="search-box">
                            <input type="text" placeholder="Search homework..." id="homeworkSearch">
                            <button><i class="fas fa-search"></i></button>
                        </div>
                        <select class="filter-select" id="subjectFilter">
                            <option value="">All Subjects</option>
                            <option value="Mathematics">Mathematics</option>
                            <option value="Science">Science</option>
                            <option value="English">English</option>
                            <option value="Hindi">Hindi</option>
                            <option value="Social Science">Social Science</option>
                            <option value="Computer">Computer</option>
                        </select>
                        <select class="sort-select" id="sortHomework">
                            <option value="newest">Newest First</option>
                            <option value="oldest">Oldest First</option>
                            <option value="subject">By Subject</option>
                        </select>
                    </div>
                </div>
                <div class="homework-grid" id="homeworkGrid">
                    <!-- Homework cards will be inserted here by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Teachers Section -->
        <section class="teachers" id="teachers">
            <div class="container">
                <div class="section-title">
                    <h2>Our Teachers</h2>
                    <p>Meet our dedicated and experienced faculty members</p>
                </div>
                <div class="teachers-grid" id="teachersGrid">
                    <!-- Teacher cards will be inserted here by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Events Timeline -->
        <section class="events" id="events">
            <div class="container">
                <div class="section-title">
                    <h2>School Events</h2>
                    <p>Upcoming and past events at Milli Karwaan Public School</p>
                </div>
                <div class="timeline" id="timeline">
                    <!-- Timeline items will be inserted here by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Notice Board -->
        <section class="notices" id="notices">
            <div class="container">
                <div class="section-title">
                    <h2>Notice Board</h2>
                    <p>Important announcements and updates</p>
                </div>
                <div class="notice-list" id="noticeList">
                    <!-- Notice items will be inserted here by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Timetable -->
        <section class="timetable" id="timetable">
            <div class="container">
                <div class="section-title">
                    <h2>Class Timetable</h2>
                    <p>Weekly schedule for your class</p>
                </div>
                <div class="timetable-container">
                    <table class="timetable-table" id="timetableTable">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Monday</th>
                                <th>Tuesday</th>
                                <th>Wednesday</th>
                                <th>Thursday</th>
                                <th>Friday</th>
                                <th>Saturday</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Timetable rows will be inserted here by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Student Portal -->
        <section class="student-portal" id="student-portal">
            <div class="container portal-container">
                <div class="section-title">
                    <h2>Student Portal</h2>
                    <p>Track your academic progress and achievements</p>
                </div>
                <div class="portal-header">
                    <div class="student-info">
                        <div class="student-avatar" id="studentAvatar">JD</div>
                        <div class="student-details">
                            <h3 id="studentNameDisplay">John Doe</h3>
                            <p>Class <span id="studentClassDisplay">X</span> | Roll No: <span id="studentRoll">15</span></p>
                        </div>
                    </div>
                    <div class="portal-actions">
                        <button class="btn" id="refreshData"><i class="fas fa-sync"></i> Refresh</button>
                    </div>
                </div>
                <div class="portal-tabs">
                    <div class="tab active" data-tab="progress">Progress</div>
                    <div class="tab" data-tab="achievements">Achievements</div>
                    <div class="tab" data-tab="rewards">Rewards</div>
                </div>
                <div class="tab-content active" id="progress">
                    <div class="progress-container">
                        <div class="progress-header">
                            <span>Homework Completion</span>
                            <span id="homeworkProgressText">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="homeworkProgress" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-header">
                            <span>Attendance Rate</span>
                            <span id="attendanceProgressText">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="attendanceProgress" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-header">
                            <span>Test Average</span>
                            <span id="testProgressText">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="testProgress" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                <div class="tab-content" id="achievements">
                    <div class="achievement">
                        <div class="achievement-icon">
                            <i class="fas fa-medal"></i>
                        </div>
                        <div class="achievement-details">
                            <h4>Science Olympiad Winner</h4>
                            <p>Awarded for outstanding performance in the National Science Olympiad 2023</p>
                            <small>Received on June 15, 2023</small>
                        </div>
                    </div>
                    <div class="achievement">
                        <div class="achievement-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="achievement-details">
                            <h4>Best Student Award</h4>
                            <p>Recognized for academic excellence and leadership qualities</p>
                            <small>Received on April 5, 2023</small>
                        </div>
                    </div>
                    <div class="achievement">
                        <div class="achievement-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="achievement-details">
                            <h4>Perfect Attendance</h4>
                            <p>Awarded for maintaining 100% attendance for the entire academic year</p>
                            <small>Received on March 20, 2023</small>
                        </div>
                    </div>
                </div>
                <div class="tab-content" id="rewards">
                    <p style="text-align: center; color: #666;">No rewards available at this time. Keep up the good work!</p>
                </div>
            </div>
        </section>

        <!-- Results Section -->
        <section class="results" id="results">
            <div class="container results-container">
                <div class="section-title">
                    <h2>Academic Results</h2>
                    <p>Your performance in recent examinations</p>
                </div>
                <div class="results-header">
                    <h3>Term Examination Results</h3>
                    <div class="results-filters">
                        <select class="filter-select" id="termFilter">
                            <option value="1">Term 1</option>
                            <option value="2">Term 2</option>
                            <option value="3">Term 3</option>
                        </select>
                        <select class="filter-select" id="subjectFilterResults">
                            <option value="all">All Subjects</option>
                            <option value="math">Mathematics</option>
                            <option value="science">Science</option>
                            <option value="english">English</option>
                            <option value="hindi">Hindi</option>
                            <option value="social">Social Science</option>
                        </select>
                    </div>
                </div>
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>Subject</th>
                            <th>Marks Obtained</th>
                            <th>Total Marks</th>
                            <th>Percentage</th>
                            <th>Grade</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody">
                        <!-- Results will be inserted here by JavaScript -->
                    </tbody>
                </table>
                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn" id="generateReport"><i class="fas fa-file-pdf"></i> Generate PDF Report</button>
                </div>
            </div>
        </section>

        <!-- Attendance Section -->
        <section class="attendance" id="attendance">
            <div class="container attendance-container">
                <div class="section-title">
                    <h2>Attendance Record</h2>
                    <p>Your attendance for the current academic year</p>
                </div>
                <div class="attendance-header">
                    <h3>Monthly Attendance</h3>
                    <select class="filter-select" id="monthFilter">
                        <option value="1">January</option>
                        <option value="2">February</option>
                        <option value="3">March</option>
                        <option value="4">April</option>
                        <option value="5">May</option>
                        <option value="6">June</option>
                        <option value="7">July</option>
                        <option value="8">August</option>
                        <option value="9">September</option>
                        <option value="10">October</option>
                        <option value="11">November</option>
                        <option value="12">December</option>
                    </select>
                </div>
                <div class="attendance-summary">
                    <div class="attendance-item">
                        <div class="attendance-number" id="totalDays">0</div>
                        <div class="attendance-label">Total Days</div>
                    </div>
                    <div class="attendance-item">
                        <div class="attendance-number" id="presentDays">0</div>
                        <div class="attendance-label">Present</div>
                    </div>
                    <div class="attendance-item">
                        <div class="attendance-number" id="absentDays">0</div>
                        <div class="attendance-label">Absent</div>
                    </div>
                </div>
                <div class="calendar">
                    <div class="calendar-header">Sun</div>
                    <div class="calendar-header">Mon</div>
                    <div class="calendar-header">Tue</div>
                    <div class="calendar-header">Wed</div>
                    <div class="calendar-header">Thu</div>
                    <div class="calendar-header">Fri</div>
                    <div class="calendar-header">Sat</div>
                    <!-- Calendar days will be inserted here by JavaScript -->
                </div>
                <div style="margin-top: 20px; display: flex; justify-content: center; gap: 20px;">
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <div style="width: 15px; height: 15px; background-color: #d4edda; border: 1px solid #c3e6cb;"></div>
                        <span style="font-size: 14px;">Present</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <div style="width: 15px; height: 15px; background-color: #f8d7da; border: 1px solid #f5c6cb;"></div>
                        <span style="font-size: 14px;">Absent</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <div style="width: 15px; height: 15px; background-color: #d1ecf1; border: 1px solid #bee5eb;"></div>
                        <span style="font-size: 14px;">Holiday</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Parent-Teacher Communication -->
        <section class="communication" id="communication">
            <div class="container messages-container">
                <div class="section-title">
                    <h2>Parent-Teacher Communication</h2>
                    <p>Messages between parents and teachers</p>
                </div>
                <div class="messages-header">
                    <h3>Message Center</h3>
                    <button class="btn" id="newMessage"><i class="fas fa-plus"></i> New Message</button>
                </div>
                <div class="message-list" id="messageList">
                    <!-- Messages will be inserted here by JavaScript -->
                </div>
                <div class="message-form">
                    <input type="text" placeholder="Type your message..." id="messageInput">
                    <button id="sendMessage"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </section>

        <!-- Gallery -->
        <section class="gallery" id="gallery">
            <div class="container">
                <div class="section-title">
                    <h2>School Gallery</h2>
                    <p>Photos from school events and activities</p>
                </div>
                <div class="gallery-controls">
                    <button class="gallery-filter active" data-filter="all">All</button>
                    <button class="gallery-filter" data-filter="academic">Academic</button>
                    <button class="gallery-filter" data-filter="sports">Sports</button>
                    <button class="gallery-filter" data-filter="cultural">Cultural</button>
                    <button class="gallery-filter" data-filter="events">Events</button>
                </div>
                <div class="gallery-grid" id="galleryGrid">
                    <!-- Gallery items will be inserted here by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section class="contact" id="contact">
            <div class="container">
                <div class="section-title">
                    <h2>Contact Us</h2>
                    <p>Get in touch with school administration</p>
                </div>
                <div class="contact-container">
                    <div class="contact-info">
                        <h3>Get In Touch</h3>
                        <div class="contact-details">
                            <div class="contact-item">
                                <div class="contact-icon">
                                    <i class="fas fa-map-marker-alt"></i>
                                </div>
                                <div class="contact-text">
                                    <h4>Address</h4>
                                    <p>Boluha Police Chowki, Balrampur, Uttar Pradesh, India - 271201</p>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">
                                    <i class="fas fa-phone"></i>
                                </div>
                                <div class="contact-text">
                                    <h4>Phone</h4>
                                    <p><a href="tel:9758919151">+91 9758919151</a></p>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">
                                    <i class="fas fa-envelope"></i>
                                </div>
                                <div class="contact-text">
                                    <h4>Email</h4>
                                    <p><a href="mailto:madamsir066@gmail.com">madamsir066@gmail.com</a></p>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="contact-text">
                                    <h4>Working Hours</h4>
                                    <p>Monday - Saturday: 8:00 AM - 4:00 PM</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="contact-form">
                        <form id="contactForm">
                            <div class="form-group">
                                <label for="name">Your Name</label>
                                <input type="text" class="form-control" id="name" required>
                            </div>
                            <div class="form-group">
                                <label for="email">Email Address</label>
                                <input type="email" class="form-control" id="email" required>
                            </div>
                            <div class="form-group">
                                <label for="phone">Phone Number</label>
                                <input type="tel" class="form-control" id="phone" required>
                            </div>
                            <div class="form-group">
                                <label for="subject">Subject</label>
                                <input type="text" class="form-control" id="subject" required>
                            </div>
                            <div class="form-group">
                                <label for="message">Message</label>
                                <textarea class="form-control" id="message" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-block">Send Message</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-container">
                <div class="footer-col">
                    <h4>Milli Karwaan Public School</h4>
                    <p>Providing quality education with a focus on character building and holistic development since 1995.</p>
                    <div class="social-icons" style="margin-top: 20px;">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="#home"><i class="fas fa-chevron-right"></i> Home</a></li>
                        <li><a href="#homework"><i class="fas fa-chevron-right"></i> Homework</a></li>
                        <li><a href="#teachers"><i class="fas fa-chevron-right"></i> Teachers</a></li>
                        <li><a href="#events"><i class="fas fa-chevron-right"></i> Events</a></li>
                        <li><a href="#notices"><i class="fas fa-chevron-right"></i> Notices</a></li>
                        <li><a href="#timetable"><i class="fas fa-chevron-right"></i> Timetable</a></li>
                        <li><a href="#gallery"><i class="fas fa-chevron-right"></i> Gallery</a></li>
                        <li><a href="#student-portal"><i class="fas fa-chevron-right"></i> Student Portal</a></li>
                        <li><a href="#results"><i class="fas fa-chevron-right"></i> Results</a></li>
                        <li><a href="#attendance"><i class="fas fa-chevron-right"></i> Attendance</a></li>
                        <li><a href="#communication"><i class="fas fa-chevron-right"></i> Messages</a></li>
                        <li><a href="#contact"><i class="fas fa-chevron-right"></i> Contact</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Academics</h4>
                    <ul class="footer-links">
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Curriculum</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Classes</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Faculty</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Academic Calendar</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Results</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Progress Reports</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Exam Schedule</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Stay Updated</h4>
                    <p>Subscribe to our newsletter for school updates and announcements.</p>
                    <form class="newsletter-form" style="margin-top: 15px;">
                        <div style="display: flex;">
                            <input type="email" class="newsletter-input" placeholder="Your Email" style="flex: 1; padding: 10px; border: none; border-radius: 5px 0 5px 0;">
                            <button type="submit" class="newsletter-btn" style="background-color: var(--secondary); color: white; border: none; padding: 0 15px; border-radius: 0 5px 5px 0; cursor: pointer;">Go</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2023 Milli Karwaan Public School Balrampur. All Rights Reserved. | Developed with <i class="fas fa-heart" style="color: var(--danger);"></i> for quality education</p>
            </div>
        </div>
    </footer>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <div class="lightbox-controls">
            <button class="lightbox-btn" id="closeLightbox"><i class="fas fa-times"></i></button>
            <button class="lightbox-btn" id="downloadImage"><i class="fas fa-download"></i></button>
        </div>
        <button class="lightbox-nav prev" id="prevImage"><i class="fas fa-chevron-left"></i></button>
        <div class="lightbox-content">
            <img src="" alt="Enlarged image" class="lightbox-image" id="lightboxImage">
            <div class="lightbox-caption" id="lightboxCaption"></div>
        </div>
        <button class="lightbox-nav next" id="nextImage"><i class="fas fa-chevron-right"></i></button>
    </div>

    <!-- Floating Call Button -->
    <a href="tel:9758919151" class="floating-call no-print">
        <i class="fas fa-phone"></i>
    </a>

    <!-- Export/Import Controls -->
    <div class="export-import no-print">
        <input type="file" id="importFile" style="display: none;">
        <button id="exportBtn"><i class="fas fa-file-export"></i> Export</button>
        <button id="importBtn"><i class="fas fa-file-import"></i> Import</button>
    </div>

    <!-- Print Button -->
    <button class="print-btn no-print" id="printBtn"><i class="fas fa-print"></i> Print</button>

    <!-- Back to Top Button -->
    <div class="back-to-top no-print">
        <i class="fas fa-arrow-up"></i>
    </div>

    <script>
        // DOM Elements
        const preLogin = document.getElementById('preLogin');
        const studentForm = document.getElementById('studentForm');
        const studentNameInput = document.getElementById('studentName');
        const studentClassInput = document.getElementById('studentClass');
        const parentNameInput = document.getElementById('parentName');
        const nameError = document.getElementById('nameError');
        const classError = document.getElementById('classError');
        const parentError = document.getElementById('parentError');
        const mainContent = document.getElementById('mainContent');
        const clockElement = document.getElementById('clock');
        const menuToggle = document.getElementById('menuToggle');
        const dropdownMenu = document.getElementById('dropdownMenu');
        const navMenu = document.getElementById('navMenu');
        const themeToggle = document.getElementById('themeToggle');
        const sidebar = document.getElementById('sidebar');
        const closeSidebar = document.getElementById('closeSidebar');
        const openSidebar = document.getElementById('openSidebar');
        const homeworkGrid = document.getElementById('homeworkGrid');
        const teachersGrid = document.getElementById('teachersGrid');
        const timeline = document.getElementById('timeline');
        const noticeList = document.getElementById('noticeList');
        const timetableTable = document.getElementById('timetableTable').querySelector('tbody');
        const galleryGrid = document.getElementById('galleryGrid');
        const homeworkSearch = document.getElementById('homeworkSearch');
        const subjectFilter = document.getElementById('subjectFilter');
        const sortHomework = document.getElementById('sortHomework');
        const currentClass = document.getElementById('currentClass');
        const contactForm = document.getElementById('contactForm');
        const lightbox = document.getElementById('lightbox');
        const lightboxImage = document.getElementById('lightboxImage');
        const lightboxCaption = document.getElementById('lightboxCaption');
        const closeLightbox = document.getElementById('closeLightbox');
        const prevImage = document.getElementById('prevImage');
        const nextImage = document.getElementById('nextImage');
        const downloadImage = document.getElementById('downloadImage');
        const exportData = document.getElementById('exportData');
        const importData = document.getElementById('importData');
        const printSite = document.getElementById('printSite');
        const exportBtn = document.getElementById('exportBtn');
        const importBtn = document.getElementById('importBtn');
        const importFile = document.getElementById('importFile');
        const printBtn = document.getElementById('printBtn');
        const galleryFilters = document.querySelectorAll('.gallery-filter');
        const backToTop = document.querySelector('.back-to-top');
        
        // Student portal elements
        const studentAvatar = document.getElementById('studentAvatar');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const studentClassDisplay = document.getElementById('studentClassDisplay');
        const studentRoll = document.getElementById('studentRoll');
        const refreshData = document.getElementById('refreshData');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // Progress elements
        const homeworkProgress = document.getElementById('homeworkProgress');
        const homeworkProgressText = document.getElementById('homeworkProgressText');
        const attendanceProgress = document.getElementById('attendanceProgress');
        const attendanceProgressText = document.getElementById('attendanceProgressText');
        const testProgress = document.getElementById('testProgress');
        const testProgressText = document.getElementById('testProgressText');
        
        // Results elements
        const termFilter = document.getElementById('termFilter');
        const subjectFilterResults = document.getElementById('subjectFilterResults');
        const resultsBody = document.getElementById('resultsBody');
        const generateReport = document.getElementById('generateReport');
        
        // Attendance elements
        const monthFilter = document.getElementById('monthFilter');
        const totalDays = document.getElementById('totalDays');
        const presentDays = document.getElementById('presentDays');
        const absentDays = document.getElementById('absentDays');
        const calendar = document.querySelector('.calendar');
        
        // Communication elements
        const messageList = document.getElementById('messageList');
        const messageInput = document.getElementById('messageInput');
        const sendMessage = document.getElementById('sendMessage');
        const newMessage = document.getElementById('newMessage');
        
        // Analytics elements
        const homeworkCount = document.getElementById('homeworkCount');
        const noticeCount = document.getElementById('noticeCount');
        const eventCount = document.getElementById('eventCount');
        const teacherCount = document.getElementById('teacherCount');

        // Student data
        let studentData = null;

        // Current images for lightbox
        let currentGalleryImages = [];
        let currentImageIndex = 0;

        // Initialize the application
        function init() {
            // Check if student data exists in localStorage
            const savedStudent = localStorage.getItem('mkps_student');
            if (savedStudent) {
                studentData = JSON.parse(savedStudent);
                showMainContent();
            } else {
                showPreLogin();
            }

            // Set up event listeners
            setupEventListeners();

            // Update clock
            updateClock();
            setInterval(updateClock, 1000);

            // Load data from localStorage or seed with defaults
            loadData();

            // Check for updates in localStorage
            window.addEventListener('storage', handleStorageChange);

            // Prevent back button after login
            if (studentData) {
                window.history.pushState(null, null, location.href);
                window.onpopstate = function () {
                    window.history.pushState(null, null, location.href);
                };
            }
        }

        // Show pre-login form
        function showPreLogin() {
            preLogin.style.display = 'flex';
            mainContent.style.display = 'none';
        }

        // Show main content
        function showMainContent() {
            preLogin.style.display = 'none';
            mainContent.style.display = 'block';
            
            // Update UI with student data
            if (studentData) {
                currentClass.textContent = studentData.class;
                studentNameDisplay.textContent = studentData.name;
                studentClassDisplay.textContent = studentData.class;
                studentRoll.textContent = Math.floor(Math.random() * 50) + 1;
                
                // Set avatar initials
                const nameParts = studentData.name.split(' ');
                const initials = nameParts[0].charAt(0) + (nameParts.length > 1 ? nameParts[nameParts.length - 1].charAt(0) : '');
                studentAvatar.textContent = initials.toUpperCase();
            }
            
            // Render all sections
            renderHomework();
            renderTeachers();
            renderEvents();
            renderNotices();
            renderTimetable();
            renderGallery();
            renderResults();
            renderAttendance();
            renderMessages();
            updateAnalytics();
            updateProgress();
        }

        // Setup event listeners
        function setupEventListeners() {
            // Student form submission
            if (studentForm) {
                studentForm.addEventListener('submit', handleStudentFormSubmit);
            }

            // Menu toggle
            menuToggle.addEventListener('click', toggleDropdownMenu);
            
            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!menuToggle.contains(e.target) && !dropdownMenu.contains(e.target)) {
                    dropdownMenu.classList.remove('show');
                }
            });

            // Theme toggle
            themeToggle.addEventListener('change', toggleTheme);

            // Sidebar
            openSidebar.addEventListener('click', () => {
                sidebar.classList.add('active');
            });

            closeSidebar.addEventListener('click', () => {
                sidebar.classList.remove('active');
            });

            // Close sidebar when clicking outside
            document.addEventListener('click', (e) => {
                if (sidebar.classList.contains('active') && !sidebar.contains(e.target) && !openSidebar.contains(e.target)) {
                sidebar.classList.remove('active');
                }
            });

            // Homework filters and search
            homeworkSearch.addEventListener('input', renderHomework);
            subjectFilter.addEventListener('change', renderHomework);
            sortHomework.addEventListener('change', renderHomework);

            // Contact form
            contactForm.addEventListener('submit', handleContactFormSubmit);

            // Lightbox
            closeLightbox.addEventListener('click', closeLightboxModal);
            prevImage.addEventListener('click', showPrevImage);
            nextImage.addEventListener('click', showNextImage);
            downloadImage.addEventListener('click', downloadCurrentImage);

            // Export/Import
            exportData.addEventListener('click', exportAllData);
            importData.addEventListener('click', () => importFile.click());
            importBtn.addEventListener('click', () => importFile.click());
            importFile.addEventListener('change', handleImport);
            exportBtn.addEventListener('click', exportAllData);
            printSite.addEventListener('click', printPage);
            printBtn.addEventListener('click', printPage);

            // Gallery filters
            galleryFilters.forEach(filter => {
                filter.addEventListener('click', function() {
                    galleryFilters.forEach(f => f.classList.remove('active'));
                    this.classList.add('active');
                    renderGallery(this.getAttribute('data-filter'));
                });
            });

            // Tab navigation
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    tab.classList.add('active');
                    document.getElementById(tab.getAttribute('data-tab')).classList.add('active');
                });
            });

            // Results filters
            termFilter.addEventListener('change', renderResults);
            subjectFilterResults.addEventListener('change', renderResults);

            // Attendance filter
            monthFilter.addEventListener('change', renderAttendance);

            // Message system
            sendMessage.addEventListener('click', sendMessageHandler);
            messageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessageHandler();
                }
            });
            newMessage.addEventListener('click', () => {
                const name = prompt('Enter teacher name:');
                if (name) {
                    const messages = JSON.parse(localStorage.getItem('mkps_messages')) || [];
                    messages.push({
                        sender: studentData ? studentData.name : 'Student',
                        recipient: name,
                        message: 'Hello, I would like to schedule a meeting.',
                        timestamp: new Date().toISOString(),
                        read: false
                    });
                    localStorage.setItem('mkps_messages', JSON.stringify(messages));
                    renderMessages();
                }
            });

            // Refresh data
            refreshData.addEventListener('click', () => {
                renderHomework();
                renderTeachers();
                renderEvents();
                renderNotices();
                renderTimetable();
                renderGallery();
                renderResults();
                renderAttendance();
                renderMessages();
                updateAnalytics();
                updateProgress();
                
                // Show refresh animation
                refreshData.innerHTML = '<i class="fas fa-sync fa-spin"></i>';
                setTimeout(() => {
                    refreshData.innerHTML = '<i class="fas fa-sync"></i> Refresh';
                }, 1000);
            });

            // Back to top
            backToTop.addEventListener('click', () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });

            // Scroll event for back to top
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTop.classList.add('show');
                } else {
                    backToTop.classList.remove('show');
                }
            });

            // Generate report
            generateReport.addEventListener('click', generatePDFReport);
        }

        // Handle student form submission
        function handleStudentFormSubmit(e) {
            e.preventDefault();
            
            // Reset errors
            nameError.style.display = 'none';
            classError.style.display = 'none';
            parentError.style.display = 'none';
            
            let valid = true;
            
            // Validate fields
            if (!studentNameInput.value.trim()) {
                nameError.style.display = 'block';
                valid = false;
            }
            
            if (!studentClassInput.value) {
                classError.style.display = 'block';
                valid = false;
            }
            
            if (!parentNameInput.value.trim()) {
                parentError.style.display = 'block';
                valid = false;
            }
            
            if (valid) {
                // Save student data
                studentData = {
                    name: studentNameInput.value.trim(),
                    class: studentClassInput.value,
                    parent: parentNameInput.value.trim(),
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem('mkps_student', JSON.stringify(studentData));
                
                // Show main content
                showMainContent();
            }
        }

        // Toggle dropdown menu
        function toggleDropdownMenu() {
            dropdownMenu.classList.toggle('show');
        }

        // Toggle theme
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('mkps_theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
        }

        // Update clock
        function updateClock() {
            const now = new Date();
            clockElement.textContent = now.toLocaleString();
        }

        // Load data from localStorage or seed with defaults
        function loadData() {
            // Check for theme preference
            const savedTheme = localStorage.getItem('mkps_theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                themeToggle.checked = true;
            }
            
            // Seed data if not exists
            if (!localStorage.getItem('mkps_homework')) {
                seedHomeworkData();
            }
            
            if (!localStorage.getItem('mkps_teachers')) {
                seedTeachersData();
            }
            
            if (!localStorage.getItem('mkps_events')) {
                seedEventsData();
            }
            
            if (!localStorage.getItem('mkps_notices')) {
                seedNoticesData();
            }
            
            if (!localStorage.getItem('mkps_timetable')) {
                seedTimetableData();
            }
            
            if (!localStorage.getItem('mkps_gallery')) {
                seedGalleryData();
            }
            
            if (!localStorage.getItem('mkps_messages')) {
                localStorage.setItem('mkps_messages', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('mkps_results')) {
                seedResultsData();
            }
            
            if (!localStorage.getItem('mkps_attendance')) {
                seedAttendanceData();
            }
        }

        // Seed homework data
        function seedHomeworkData() {
            const homework = [
                {
                    class: "1",
                    subject: "Mathematics",
                    details: "Complete exercises on addition and subtraction from page 25-30 in the textbook.",
                    date: "2023-06-15",
                    teacher: "Mrs. Sharma"
                },
                {
                    class: "1",
                    subject: "English",
                    details: "Practice writing alphabets A to G. Read the story 'The Little Kite' and answer questions on page 18.",
                    date: "2023-06-15",
                    teacher: "Mr. Patel"
                },
                {
                    class: "2",
                    subject: "Mathematics",
                    details: "Solve word problems on multiplication from page 45. Complete the multiplication table up to 10.",
                    date: "2023-06-15",
                    teacher: "Mrs. Sharma"
                },
                {
                    class: "2",
                    subject: "Science",
                    details: "Draw and label the parts of a plant in your notebook. Write 5 sentences about the importance of plants.",
                    date: "2023-06-15",
                    teacher: "Mr. Singh"
                },
                {
                    class: "3",
                    subject: "Mathematics",
                    details: "Complete exercises on division from page 67-70. Solve 10 division word problems.",
                    date: "2023-06-15",
                    teacher: "Mrs. Sharma"
                },
                {
                    class: "3",
                    subject: "English",
                    details: "Write a short story (100 words) about 'My Best Friend'. Use at least 5 adjectives in your story.",
                    date: "2023-06-15",
                    teacher: "Mr. Patel"
                },
                {
                    class: "4",
                    subject: "Mathematics",
                    details: "Solve problems on fractions from page 89-92. Convert 10 improper fractions to mixed numbers.",
                    date: "2023-06-15",
                    teacher: "Mrs. Sharma"
                },
                {
                    class: "4",
                    subject: "Science",
                    details: "Prepare a project on the water cycle. Include a diagram and explain each stage in your own words.",
                    date: "2023-06-20",
                    teacher: "Mr. Singh"
                },
                {
                    class: "5",
                    subject: "Mathematics",
                    details: "Complete exercises on decimals from page 105-108. Solve 15 word problems involving decimal operations.",
                    date: "2023-06-15",
                    teacher: "Mrs. Sharma"
                },
                {
                    class: "5",
                    subject: "Social Science",
                    details: "Research and write a report on the major rivers of India. Include their source, length, and states they flow through.",
                    date: "2023-06-18",
                    teacher: "Mrs. Gupta"
                },
                {
                    class: "6",
                    subject: "Mathematics",
                    details: "Solve problems on algebraic expressions from page 120-125. Simplify 10 algebraic expressions and solve 5 equations.",
                    date: "2023-06-15",
                    teacher: "Mr. Kumar"
                },
                {
                    class: "6",
                    subject: "Science",
                    details: "Prepare a model of the solar system. Label all planets and write a short description of each planet.",
                    date: "2023-06-22",
                    teacher: "Mr. Singh"
                },
                {
                    class: "7",
                    subject: "Mathematics",
                    details: "Complete exercises on exponents and powers from page 140-145. Solve 15 problems involving laws of exponents.",
                    date: "2023-06-15",
                    teacher: "Mr. Kumar"
                },
                {
                    class: "7",
                    subject: "English",
                    details: "Write a letter to the editor about 'Importance of Cleanliness in Our City'. Use formal letter format and proper salutations.",
                    date: "2023-06-16",
                    teacher: "Mrs. Verma"
                },
                {
                    class: "8",
                    subject: "Mathematics",
                    details: "Solve problems on linear equations from page 160-165. Graph 5 linear equations and find their solutions.",
                    date: "2023-06-15",
                    teacher: "Mr. Kumar"
                },
                {
                    class: "8",
                    subject: "Science",
                    details: "Conduct an experiment on photosynthesis. Record your observations and write a lab report with hypothesis, procedure, results, and conclusion.",
                    date: "2023-06-20",
                    teacher: "Mrs. Nair"
                },
                {
                    class: "9",
                    subject: "Mathematics",
                    details: "Complete exercises on coordinate geometry from page 180-185. Plot 10 points and find distances between them using distance formula.",
                    date: "2023-06-15",
                    teacher: "Mr. Joshi"
                },
                {
                    class: "9",
                    subject: "Science",
                    details: "Prepare a presentation on 'Human Eye and Colorful World'. Include diagrams of the eye and explain the phenomenon of dispersion.",
                    date: "2023-06-19",
                    teacher: "Mrs. Nair"
                },
                {
                    class: "10",
                    subject: "Mathematics",
                    details: "Solve problems on triangles and their properties from page 200-205. Prove 5 theorems related to triangles using proper geometric proofs.",
                    date: "2023-06-15",
                    teacher: "Mr. Joshi"
                },
                {
                    class: "10",
                    subject: "Science",
                    details: "Write a detailed report on 'Management of Natural Resources'. Include conservation methods, case studies, and your suggestions for improvement.",
                    date: "2023-06-18",
                    teacher: "Mrs. Nair"
                },
                {
                    class: "11",
                    subject: "Mathematics",
                    details: "Complete exercises on sets and functions from page 220-225. Solve 15 problems on set operations and function composition.",
                    date: "2023-06-15",
                    teacher: "Dr. Mehta"
                },
                {
                    class: "11",
                    subject: "Physics",
                    details: "Solve numerical problems on laws of motion from chapter 5. Derive equations of motion and apply them to 10 different scenarios.",
                    date: "2023-06-16",
                    teacher: "Mr. Desai"
                },
                {
                    class: "12",
                    subject: "Mathematics",
                    details: "Complete exercises on calculus from page 240-245. Solve 15 problems on differentiation and integration with applications.",
                    date: "2023-06-15",
                    teacher: "Dr. Mehta"
                },
                {
                    class: "12",
                    subject: "Physics",
                    details: "Prepare for the practical exam on optics. Review all experiments on lenses and mirrors, and practice ray diagrams for different cases.",
                    date: "2023-06-17",
                    teacher: "Mr. Desai"
                }
            ];
            localStorage.setItem('mkps_homework', JSON.stringify(homework));
        }

        // Seed teachers data
        function seedTeachersData() {
            const teachers = [
                {
                    name: "Mrs. Anjali Sharma",
                    subject: "Mathematics",
                    class: "1-5",
                    email: "anjali.sharma@mkps.edu",
                    phone: "9876543210",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=AS",
                    bio: "Mrs. Sharma has 15 years of experience in teaching mathematics. She specializes in making math concepts easy and fun for young learners."
                },
                {
                    name: "Mr. Rajesh Patel",
                    subject: "English",
                    class: "1-5",
                    email: "rajesh.patel@mkps.edu",
                    phone: "9876543211",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=RP",
                    bio: "Mr. Patel is passionate about literature and language. He encourages creative writing and reading habits among students."
                },
                {
                    name: "Mr. Vikram Singh",
                    subject: "Science",
                    class: "1-8",
                    email: "vikram.singh@mkps.edu",
                    phone: "9876543212",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=VS",
                    bio: "Mr. Singh makes science exciting with hands-on experiments and real-world applications. He has a PhD in Environmental Science."
                },
                {
                    name: "Mrs. Priya Gupta",
                    subject: "Social Science",
                    class: "3-8",
                    email: "priya.gupta@mkps.edu",
                    phone: "9876543213",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=PG",
                    bio: "Mrs. Gupta brings history and geography to life with interactive lessons and field trips. She focuses on civic awareness and global citizenship."
                },
                {
                    name: "Mr. Arun Kumar",
                    subject: "Mathematics",
                    class: "6-10",
                    email: "arun.kumar@mkps.edu",
                    phone: "9876543214",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=AK",
                    bio: "Mr. Kumar specializes in advanced mathematics and competitive exam preparation. He has trained students for Olympiads and scholarship tests."
                },
                {
                    name: "Mrs. Sunita Verma",
                    subject: "English",
                    class: "6-10",
                    email: "sunita.verma@mkps.edu",
                    phone: "9876543215",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=SV",
                    bio: "Mrs. Verma is an accomplished writer and poet. She emphasizes communication skills, critical thinking, and literary analysis in her classes."
                },
                {
                    name: "Mrs. Deepa Nair",
                    subject: "Science",
                    class: "6-10",
                    email: "deepa.nair@mkps.edu",
                    phone: "9876543216",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=DN",
                    bio: "Mrs. Nair is a research scholar in biotechnology. She guides students in science projects and encourages scientific inquiry and experimentation."
                },
                {
                    name: "Mr. Sanjay Joshi",
                    subject: "Mathematics",
                    class: "9-10",
                    email: "sanjay.joshi@mkps.edu",
                    phone: "9876543217",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=SJ",
                    bio: "Mr. Joshi has 20 years of experience in teaching senior secondary mathematics. He focuses on concept clarity and problem-solving techniques."
                },
                {
                    name: "Dr. Meena Mehta",
                    subject: "Mathematics",
                    class: "11-12",
                    email: "meena.mehta@mkps.edu",
                    phone: "9876543218",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=MM",
                    bio: "Dr. Mehta holds a doctorate in Applied Mathematics. She prepares students for engineering entrance exams and higher studies in mathematics."
                },
                {
                    name: "Mr. Amit Desai",
                    subject: "Physics",
                    class: "11-12",
                    email: "amit.desai@mkps.edu",
                    phone: "9876543219",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=AD",
                    bio: "Mr. Desai is passionate about theoretical and experimental physics. He conducts advanced labs and research projects with senior students."
                },
                {
                    name: "Mrs. Kavita Reddy",
                    subject: "Chemistry",
                    class: "11-12",
                    email: "kavita.reddy@mkps.edu",
                    phone: "9876543220",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=KR",
                    bio: "Mrs. Reddy specializes in organic and inorganic chemistry. She emphasizes laboratory skills and chemical safety in her teaching."
                },
                {
                    name: "Mr. Ravi Shankar",
                    subject: "Biology",
                    class: "11-12",
                    email: "ravi.shankar@mkps.edu",
                    phone: "9876543221",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=RS",
                    bio: "Mr. Shankar is an expert in human biology and genetics. He conducts dissection labs and guides students in medical entrance preparation."
                },
                {
                    name: "Mrs. Nandini Iyer",
                    subject: "Computer Science",
                    class: "6-12",
                    email: "nandini.iyer@mkps.edu",
                    phone: "9876543222",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=NI",
                    bio: "Mrs. Iyer is a software engineer by training. She teaches programming, web development, and computer applications with practical projects."
                },
                {
                    name: "Mr. Farhan Ali",
                    subject: "Physical Education",
                    class: "1-12",
                    email: "farhan.ali@mkps.edu",
                    phone: "9876543223",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=FA",
                    bio: "Mr. Ali is a certified sports coach. He trains students in various sports and promotes physical fitness and teamwork."
                },
                {
                    name: "Mrs. Rekha Menon",
                    subject: "Music",
                    class: "1-8",
                    email: "rekha.menon@mkps.edu",
                    phone: "9876543224",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=RM",
                    bio: "Mrs. Menon is a trained classical vocalist. She teaches Indian and Western music and organizes cultural programs."
                },
                {
                    name: "Mr. Karan Malhotra",
                    subject: "Art",
                    class: "1-10",
                    email: "karan.malhotra@mkps.edu",
                    phone: "9876543225",
                    image: "https://placehold.co/300x300/1a3a6e/ffffff?text=KM",
                    bio: "Mr. Malhotra is a professional artist. He teaches drawing, painting, and crafts, encouraging creativity and self-expression."
                }
            ];
            localStorage.setItem('mkps_teachers', JSON.stringify(teachers));
        }

        // Seed events data
        function seedEventsData() {
            const events = [
                {
                    title: "Annual Day Celebration",
                    date: "2023-07-15",
                    time: "10:00 AM - 4:00 PM",
                    venue: "School Auditorium",
                    description: "Our annual day celebration featuring cultural performances, awards ceremony, and special guest appearances. All parents are invited to attend."
                },
                {
                    title: "Sports Day",
                    date: "2023-08-20",
                    time: "9:00 AM - 3:00 PM",
                    venue: "School Playground",
                    description: "Inter-class sports competition with various athletic events, races, and team games. Students will participate according to their age groups."
                },
                {
                    title: "Parent-Teacher Meeting",
                    date: "2023-09-10",
                    time: "2:00 PM - 5:00 PM",
                    venue: "Classrooms",
                    description: "Regular parent-teacher meeting to discuss student progress, academic performance, and areas of improvement. Please book your slot in advance."
                },
                {
                    title: "Science Exhibition",
                    date: "2023-10-05",
                    time: "10:00 AM - 2:00 PM",
                    venue: "Science Labs",
                    description: "Students will showcase their science projects and experiments. Judges will evaluate projects and awards will be given for best innovations."
                },
                {
                    title: "Diwali Festival",
                    date: "2023-11-12",
                    time: "4:00 PM - 7:00 PM",
                    venue: "School Grounds",
                    description: "Celebration of Diwali with traditional decorations, cultural programs, and distribution of sweets. Students are encouraged to wear traditional attire."
                },
                {
                    title: "Christmas Celebration",
                    date: "2023-12-24",
                    time: "5:00 PM - 8:00 PM",
                    venue: "Auditorium",
                    description: "Christmas carols, nativity play, and gift exchange. Special performance by the school choir and dance group."
                },
                {
                    title: "Annual Sports Tournament",
                    date: "2024-01-15",
                    time: "9:00 AM - 4:00 PM",
                    venue: "Sports Complex",
                    description: "Inter-school sports tournament featuring cricket, football, basketball, and athletics. Our school team will compete against other institutions."
                },
                {
                    title: "Mathematics Olympiad",
                    date: "2024-02-20",
                    time: "10:00 AM - 1:00 PM",
                    venue: "Exam Hall",
                    description: "School-level mathematics olympiad for classes 6-12. Top performers will represent the school in regional and national competitions."
                },
                {
                    title: "Science Quiz Competition",
                    date: "2024-03-10",
                    time: "11:00 AM - 2:00 PM",
                    venue: "Seminar Hall",
                    description: "Inter-class science quiz with questions from physics, chemistry, biology, and general science. Teams of 4 students will participate."
                },
                {
                    title: "Annual Prize Distribution",
                    date: "2024-04-05",
                    time: "10:00 AM - 1:00 PM",
                    venue: "Auditorium",
                    description: "Closing ceremony of the academic year with prize distribution for academic excellence, sports achievements, and co-curricular activities."
                }
            ];
            localStorage.setItem('mkps_events', JSON.stringify(events));
        }

        // Seed notices data
        function seedNoticesData() {
            const notices = [
                {
                    title: "Admissions Open for 2024-2025",
                    date: "2023-06-01",
                    type: "Admission",
                    content: "Admissions are now open for Nursery to Class X for the 2024-2025 academic year. Please visit the school office for prospectus and application forms. Last date for submission is July 31, 2023."
                },
                {
                    title: "Summer Vacation Notice",
                    date: "2023-05-15",
                    type: "Holiday",
                    content: "Summer vacation will commence from May 20, 2023, and school will reopen on July 3, 2023. Wishing all students and parents a safe and enjoyable vacation."
                },
                {
                    title: "PTA Meeting Scheduled",
                    date: "2023-06-10",
                    type: "Meeting",
                    content: "The next Parent-Teacher Association meeting will be held on June 25, 2023, at 3:00 PM in the staff room. All parents are requested to attend and contribute to school development initiatives."
                },
                {
                    title: "New Computer Lab Inauguration",
                    date: "2023-06-05",
                    type: "Facility",
                    content: "We are pleased to announce the inauguration of our new computer lab with 30 advanced systems and high-speed internet. The lab will be operational from June 10, 2023."
                },
                {
                    title: "Uniform Change Notice",
                    date: "2023-05-20",
                    type: "Policy",
                    content: "Starting from the next academic year, there will be a slight modification in the school uniform. New uniform details will be shared by June 30, 2023. Existing uniforms will be acceptable until December 2023."
                },
                {
                    title: "Mid-Term Exams Schedule",
                    date: "2023-06-12",
                    type: "Exam",
                    content: "Mid-term examinations for classes 1-12 will be conducted from July 10-20, 2023. Exam timetable has been uploaded to the school portal and displayed on notice boards."
                },
                {
                    title: "Library Renovation",
                    date: "2023-06-08",
                    type: "Facility",
                    content: "Our school library will undergo renovation from June 25 to July 2, 2023. During this period, library services will be temporarily suspended. We apologize for any inconvenience."
                },
                {
                    title: "Health Camp Announcement",
                    date: "2023-06-14",
                    type: "Health",
                    content: "A free health check-up camp will be organized on June 28, 2023, for all students. Doctors will conduct basic health screenings, vision tests, and provide health advice."
                }
            ];
            localStorage.setItem('mkps_notices', JSON.stringify(notices));
        }

        // Seed timetable data
        function seedTimetableData() {
            const timetables = {
                "1": [
                    { time: "8:00-8:40", mon: "English", tue: "Math", wed: "EVS", thu: "English", fri: "Math", sat: "Art" },
                    { time: "8:40-9:20", mon: "Math", tue: "EVS", wed: "English", thu: "Math", fri: "EVS", sat: "Music" },
                    { time: "9:20-10:00", mon: "EVS", tue: "English", wed: "Math", thu: "EVS", fri: "English", sat: "PE" },
                    { time: "10:00-10:20", mon: "Break", tue: "Break", wed: "Break", thu: "Break", fri: "Break", sat: "Break" },
                    { time: "10:20-11:00", mon: "Hindi", tue: "Craft", wed: "Hindi", thu: "Craft", fri: "Hindi", sat: "Story" },
                    { time: "11:00-11:40", mon: "Craft", tue: "Hindi", wed: "Craft", thu: "Hindi", fri: "Craft", sat: "Activity" },
                    { time: "11:40-12:20", mon: "Games", tue: "Games", wed: "Games", thu: "Games", fri: "Games", sat: "Games" }
                ],
                "2": [
                    { time: "8:00-8:40", mon: "English", tue: "Math", wed: "EVS", thu: "English", fri: "Math", sat: "Art" },
                    { time: "8:40-9:20", mon: "Math", tue: "EVS", wed: "English", thu: "Math", fri: "EVS", sat: "Music" },
                    { time: "9:20-10:00", mon: "EVS", tue: "English", wed: "Math", thu: "EVS", fri: "English", sat: "PE" },
                    { time: "10:00-10:20", mon: "Break", tue: "Break", wed: "Break", thu: "Break", fri: "Break", sat: "Break" },
                    { time: "10:20-11:00", mon: "Hindi", tue: "Science", wed: "Hindi", thu: "Science", fri: "Hindi", sat: "Library" },
                    { time: "11:00-11:40", mon: "Science", tue: "Hindi", wed: "Science", thu: "Hindi", fri: "Science", sat: "Activity" },
                    { time: "11:40-12:20", mon: "Games", tue: "Games", wed: "Games", thu: "Games", fri: "Games", sat: "Games" }
                ],
                "3": [
                    { time: "8:00-8:40", mon: "English", tue: "Math", wed: "Science", thu: "English", fri: "Math", sat: "Art" },
                    { time: "8:40-9:20", mon: "Math", tue: "Science", wed: "English", thu: "Math", fri: "Science", sat: "Music" },
                    { time: "9:20-10:00", mon: "Science", tue: "English", wed: "Math", thu: "Science", fri: "English", sat: "PE" },
                    { time: "10:00-10:20", mon: "Break", tue: "Break", wed: "Break", thu: "Break", fri: "Break", sat: "Break" },
                    { time: "10:20-11:00", mon: "Social", tue: "Hindi", wed: "Social", thu: "Hindi", fri: "Social", sat: "Computer" },
                    { time: "11:00-11:40", mon: "Hindi", tue: "Social", wed: "Hindi", thu: "Social", fri: "Hindi", sat: "Activity" },
                    { time: "11:40-12:20", mon: "Games", tue: "Games", wed: "Games", thu: "Games", fri: "Games", sat: "Games" }
                ],
                "4": [
                    { time: "8:00-8:40", mon: "English", tue: "Math", wed: "Science", thu: "English", fri: "Math", sat: "Art" },
                    { time: "8:40-9:20", mon: "Math", tue: "Science", wed: "English", thu: "Math", fri: "Science", sat: "Music" },
                    { time: "9:20-10:00", mon: "Science", tue: "English", wed: "Math", thu: "Science", fri: "English", sat: "PE" },
                    { time: "10:00-10:20", mon: "Break", tue: "Break", wed: "Break", thu: "Break", fri: "Break", sat: "Break" },
                    { time: "10:20-11:00", mon: "Social", tue: "Hindi", wed: "Social", thu: "Hindi", fri: "Social", sat: "Computer" },
                    { time: "11:00-11:40", mon: "Hindi", tue: "Social", wed: "Hindi", thu: "Social", fri: "Hindi", sat: "Activity" },
                    { time: "11:40-12:20", mon: "Games", tue: "Games", wed: "Games", thu: "Games", fri: "Games", sat: "Games" }
                ],
                "5": [
                    { time: "8:00-8:40", mon: "English", tue: "Math", wed: "Science", thu: "English", fri: "Math", sat: "Art" },
                    { time: "8:40-9:20", mon: "Math", tue: "Science", wed: "English", thu: "Math", fri: "Science", sat: "Music" },
                    { time: "9:20-10:00", mon: "Science", tue: "English", wed: "Math", thu: "Science", fri: "English", sat: "PE" },
                    { time: "10:00-10:20", mon: "Break", tue: "Break", wed: "Break", thu: "Break", fri: "Break", sat: "Break" },
                    { time: "10:20-11:00", mon: "Social", tue: "Hindi", wed: "Social", thu: "Hindi", fri: "Social", sat: "Computer" },
                    { time: "11:00-11:40", mon: "Hindi", tue: "Social", wed: "Hindi", thu: "Social", fri: "Hindi", sat: "Activity" },
                    { time: "11:40-12:20", mon: "Games", tue: "Games", wed: "Games", thu: "Games", fri: "Games", sat: "Games" }
                ],
                "6": [
                    { time: "8:00-8:40", mon: "English", tue: "Math", wed: "Science", thu: "English", fri: "Math", sat: "Art" },
                    { time: "8:40-9:20", mon: "Math", tue: "Science", wed: "English", thu: "Math", fri: "Science", sat: "Music" },
                    { time: "9:20-10:00", mon: "Science", tue: "English", wed: "Math", thu: "Science", fri: "English", sat: "PE" },
                    { time: "10:00-10:20", mon: "Break", tue: "Break", wed: "Break", thu: "Break", fri: "Break", sat: "Break" },
                    { time: "10:20-11:00", mon: "Social", tue: "Hindi", wed: "Social", thu: "Hindi", fri: "Social", sat: "Computer" },
                    { time: "11:00-11:40", mon: "Hindi", tue: "Social", wed: "Hindi", thu: "Social", fri: "Hindi", sat: "Activity" },
                    { time: "11:40-12:20", mon: "Games", tue: "Games", wed: "Games", thu: "Games", fri: "Games", sat: "Games" }
                ],
                "7": [
                    { time: "8:00-8:40", mon: "English", tue: "Math", wed: "Physics", thu: "English", fri: "Math", sat: "Art" },
                    { time: "8:40-9:20", mon: "Math", tue: "Physics", wed: "English", thu: "Math", fri: "Physics", sat: "Music" },
                    { time: "9:20-10:00", mon: "Physics", tue: "English", wed: "Math", thu: "Physics", fri: "English", sat: "PE" },
                    { time: "10:00-10:20", mon: "Break", tue: "Break", wed: "Break", thu: "Break", fri: "Break", sat: "Break" },
                    { time: "10:20-11:00", mon: "Chemistry", tue: "Hindi", wed: "Chemistry", thu: "Hindi", fri: "Chemistry", sat: "Computer" },
                    { time: "11:00-11:40", mon: "Hindi", tue: "Chemistry", wed: "Hindi", thu: "Chemistry", fri: "Hindi", sat: "Activity" },
                    { time: "11:40-12:20", mon: "Games", tue: "Games", wed: "Games", thu: "Games", fri: "Games", sat: "Games" }
                ],
                "8": [
                    { time: "8:00-8:40", mon: "English", tue: "Math", wed: "Physics", thu: "English", fri: "Math", sat: "Art" },
                    { time: "8:40-9:20", mon: "Math", tue: "Physics", wed: "English", thu: "Math", fri: "Physics", sat: "Music" },
                    { time: "9:20-10:00", mon: "Physics", tue: "English", wed: "Math", thu: "Physics", fri: "English", sat: "PE" },
                    { time: "10:00-10:20", mon: "Break", tue: "Break", wed: "Break", thu: "Break", fri: "Break", sat: "Break" },
                    { time: "10:20-11:00", mon: "Chemistry", tue: "Hindi", wed: "Chemistry", thu: "Hindi", fri: "Chemistry", sat: "Computer" },
                    { time: "11:00-11:40", mon: "Hindi", tue: "Chemistry", wed: "Hindi", thu: "Chemistry", fri: "Hindi", sat: "Activity" },
                    { time: "11:40-12:20", mon: "Games", tue: "Games", wed: "Games", thu: "Games", fri: "Games", sat: "Games" }
                ],
                "9": [
                    { time: "8:00-8:40", mon: "English", tue: "Math", wed: "Physics", thu: "English", fri: "Math", sat: "Art" },
                    { time: "8:40-9:20", mon: "Math", tue: "Physics", wed: "English", thu: "Math", fri: "Physics", sat: "Music" },
                    { time: "9:20-10:00", mon: "Physics", tue: "English", wed: "Math", thu: "Physics", fri: "English", sat: "PE" },
                    { time: "10:00-10:20", mon: "Break", tue: "Break", wed: "Break", thu: "Break", fri: "Break", sat: "Break" },
                    { time: "10:20-11:00", mon: "Chemistry", tue: "Hindi", wed: "Chemistry", thu: "Hindi", fri: "Chemistry", sat: "Computer" },
                    { time: "11:00-11:40", mon: "Hindi", tue: "Chemistry", wed: "Hindi", thu: "Chemistry", fri: "Hindi", sat: "Activity" },
                    { time: "11:40-12:20", mon: "Games", tue: "Games", wed: "Games", thu: "Games", fri: "Games", sat: "Games" }
                ],
                "10": [
                    { time: "8:00-8:40", mon: "English", tue: "Math", wed: "Physics", thu: "English", fri: "Math", sat: "Art" },
                    { time: "8:40-9:20", mon: "Math", tue: "Physics", wed: "English", thu: "Math", fri: "Physics", sat: "Music" },
                    { time: "9:20-10:00", mon: "Physics", tue: "English", wed: "Math", thu: "Physics", fri: "English", sat: "PE" },
                    { time: "10:00-10:20", mon: "Break", tue: "Break", wed: "Break", thu: "Break", fri: "Break", sat: "Break" },
                    { time: "10:20-11:00", mon: "Chemistry", tue: "Hindi", wed: "Chemistry", thu: "Hindi", fri: "Chemistry", sat: "Computer" },
                    { time: "11:00-11:40", mon: "Hindi", tue: "Chemistry", wed: "Hindi", thu: "Chemistry", fri: "Hindi", sat: "Activity" },
                    { time: "11:40-12:20", mon: "Games", tue: "Games", wed: "Games", thu: "Games", fri: "Games", sat: "Games" }
                ],
                "11": [
                    { time: "8:00-8:40", mon: "English", tue: "Math", wed: "Physics", thu: "English", fri: "Math", sat: "Lab" },
                    { time: "8:40-9:20", mon: "Math", tue: "Physics", wed: "English", thu: "Math", fri: "Physics", sat: "Lab" },
                    { time: "9:20-10:00", mon: "Physics", tue: "English", wed: "Math", thu: "Physics", fri: "English", sat: "Project" },
                    { time: "10:00-10:20", mon: "Break", tue: "Break", wed: "Break", thu: "Break", fri: "Break", sat: "Break" },
                    { time: "10:20-11:00", mon: "Chemistry", tue: "Computer", wed: "Chemistry", thu: "Computer", fri: "Chemistry", sat: "Seminar" },
                    { time: "11:00-11:40", mon: "Computer", tue: "Chemistry", wed: "Computer", thu: "Chemistry", fri: "Computer", sat: "Discussion" },
                    { time: "11:40-12:20", mon: "Library", tue: "Library", wed: "Library", thu: "Library", fri: "Library", sat: "Games" }
                ],
                "12": [
                    { time: "8:00-8:40", mon: "English", tue: "Math", wed: "Physics", thu: "English", fri: "Math", sat: "Lab" },
                    { time: "8:40-9:20", mon: "Math", tue: "Physics", wed: "English", thu: "Math", fri: "Physics", sat: "Lab" },
                    { time: "9:20-10:00", mon: "Physics", tue: "English", wed: "Math", thu: "Physics", fri: "English", sat: "Project" },
                    { time: "10:00-10:20", mon: "Break", tue: "Break", wed: "Break", thu: "Break", fri: "Break", sat: "Break" },
                    { time: "10:20-11:00", mon: "Chemistry", tue: "Computer", wed: "Chemistry", thu: "Computer", fri: "Chemistry", sat: "Seminar" },
                    { time: "11:00-11:40", mon: "Computer", tue: "Chemistry", wed: "Computer", thu: "Chemistry", fri: "Computer", sat: "Discussion" },
                    { time: "11:40-12:20", mon: "Library", tue: "Library", wed: "Library", thu: "Library", fri: "Library", sat: "Games" }
                ]
            };
            localStorage.setItem('mkps_timetable', JSON.stringify(timetables));
        }

        // Seed gallery data
        function seedGalleryData() {
            const gallery = [
                { src: "https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Modern Classroom for Primary Section", category: "academic" },
                { src: "https://images.unsplash.com/photo-1532094349884-543019f7e328?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Well-equipped Science Laboratory", category: "academic" },
                { src: "https://images.unsplash.com/photo-1581539250439-c96689b516dd?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Spacious Library with Extensive Collection", category: "academic" },
                { src: "https://images.unsplash.com/photo-1543269865-cbf427effbad?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Advanced Computer Lab with Internet Access", category: "academic" },
                { src: "https://images.unsplash.com/photo-1545109251-704718514e8d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Large Playground for Sports and Games", category: "sports" },
                { src: "https://images.unsplash.com/photo-1522778119026-d647f0596c20?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Cricket Practice Session", category: "sports" },
                { src: "https://images.unsplash.com/photo-1461896836934-ffe607ba8211?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Inter-class Football Match", category: "sports" },
                { src: "https://images.unsplash.com/photo-1511795409834-ef04bbd61622?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Annual Day Cultural Performance", category: "cultural" },
                { src: "https://images.unsplash.com/photo-1513297887119-d46091b24bfa?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Diwali Festival Celebration", category: "cultural" },
                { src: "https://images.unsplash.com/photo-1511795409834-ef04bbd61622?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Christmas Carol Performance", category: "cultural" },
                { src: "https://images.unsplash.com/photo-1564007595029-681687b71113?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Annual Science Exhibition", category: "events" },
                { src: "https://images.unsplash.com/photo-1532094349884-543019f7e328?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Sports Day Competitions", category: "events" },
                { src: "https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Parent-Teacher Meeting", category: "events" },
                { src: "https://images.unsplash.com/photo-1581539259859-5f886e235045?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Educational Excursion to Historical Site", category: "events" },
                { src: "https://images.unsplash.com/photo-1548044816-357213712079?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Creative Art and Craft Session", category: "academic" },
                { src: "https://images.unsplash.com/photo-1511795409834-ef04bbd61622?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", caption: "Music and Dance Class", category: "cultural" }
            ];
            localStorage.setItem('mkps_gallery', JSON.stringify(gallery));
        }

        // Seed results data
        function seedResultsData() {
            const results = [
                {
                    term: "1",
                    subject: "math",
                    subjectName: "Mathematics",
                    marksObtained: 85,
                    totalMarks: 100,
                    percentage: 85,
                    grade: "A",
                    status: "Pass"
                },
                {
                    term: "1",
                    subject: "science",
                    subjectName: "Science",
                    marksObtained: 78,
                    totalMarks: 100,
                    percentage: 78,
                    grade: "B",
                    status: "Pass"
                },
                {
                    term: "1",
                    subject: "english",
                    subjectName: "English",
                    marksObtained: 92,
                    totalMarks: 100,
                    percentage: 92,
                    grade: "A",
                    status: "Pass"
                },
                {
                    term: "1",
                    subject: "hindi",
                    subjectName: "Hindi",
                    marksObtained: 88,
                    totalMarks: 100,
                    percentage: 88,
                    grade: "A",
                    status: "Pass"
                },
                {
                    term: "1",
                    subject: "social",
                    subjectName: "Social Science",
                    marksObtained: 81,
                    totalMarks: 100,
                    percentage: 81,
                    grade: "B",
                    status: "Pass"
                },
                {
                    term: "2",
                    subject: "math",
                    subjectName: "Mathematics",
                    marksObtained: 90,
                    totalMarks: 100,
                    percentage: 90,
                    grade: "A",
                    status: "Pass"
                },
                {
                    term: "2",
                    subject: "science",
                    subjectName: "Science",
                    marksObtained: 85,
                    totalMarks: 100,
                    percentage: 85,
                    grade: "A",
                    status: "Pass"
                },
                {
                    term: "2",
                    subject: "english",
                    subjectName: "English",
                    marksObtained: 95,
                    totalMarks: 100,
                    percentage: 95,
                    grade: "A",
                    status: "Pass"
                },
                {
                    term: "2",
                    subject: "hindi",
                    subjectName: "Hindi",
                    marksObtained: 90,
                    totalMarks: 100,
                    percentage: 90,
                    grade: "A",
                    status: "Pass"
                },
                {
                    term: "2",
                    subject: "social",
                    subjectName: "Social Science",
                    marksObtained: 87,
                    totalMarks: 100,
                    percentage: 87,
                    grade: "A",
                    status: "Pass"
                },
                {
                    term: "3",
                    subject: "math",
                    subjectName: "Mathematics",
                    marksObtained: 92,
                    totalMarks: 100,
                    percentage: 92,
                    grade: "A",
                    status: "Pass"
                },
                {
                    term: "3",
                    subject: "science",
                    subjectName: "Science",
                    marksObtained: 88,
                    totalMarks: 100,
                    percentage: 88,
                    grade: "A",
                    status: "Pass"
                },
                {
                    term: "3",
                    subject: "english",
                    subjectName: "English",
                    marksObtained: 96,
                    totalMarks: 100,
                    percentage: 96,
                    grade: "A",
                    status: "Pass"
                },
                {
                    term: "3",
                    subject: "hindi",
                    subjectName: "Hindi",
                    marksObtained: 93,
                    totalMarks: 100,
                    percentage: 93,
                    grade: "A",
                    status: "Pass"
                },
                {
                    term: "3",
                    subject: "social",
                    subjectName: "Social Science",
                    marksObtained: 89,
                    totalMarks: 100,
                    percentage: 89,
                    grade: "A",
                    status: "Pass"
                }
            ];
            localStorage.setItem('mkps_results', JSON.stringify(results));
        }

        // Seed attendance data
        function seedAttendanceData() {
            const attendance = [];
            const today = new Date();
            const currentYear = today.getFullYear();
            const currentMonth = today.getMonth();
            
            // Generate attendance data for current month
            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const totalDays = lastDay.getDate();
            
            for (let i = 1; i <= totalDays; i++) {
                const date = new Date(currentYear, currentMonth, i);
                const day = date.getDay();
                
                // Skip Sundays and mark as holiday
                if (day === 0) {
                    attendance.push({
                        date: `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`,
                        status: 'holiday'
                    });
                } else {
                    // Randomly assign present or absent (80% present)
                    const status = Math.random() < 0.8 ? 'present' : 'absent';
                    attendance.push({
                        date: `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`,
                        status: status
                    });
                }
            }
            
            localStorage.setItem('mkps_attendance', JSON.stringify(attendance));
        }

        // Handle storage change
        function handleStorageChange(e) {
            if (e.key === 'mkps_update') {
                // Reload data when update key changes
                loadData();
                if (studentData) {
                    renderHomework();
                    renderTeachers();
                    renderEvents();
                    renderNotices();
                    renderTimetable();
                    renderGallery();
                    renderResults();
                    renderAttendance();
                    renderMessages();
                    updateAnalytics();
                    updateProgress();
                }
            }
        }

        // Render homework
        function renderHomework() {
            if (!studentData) return;
            
            let homework = JSON.parse(localStorage.getItem('mkps_homework')) || [];
            
            // Filter by class
            homework = homework.filter(h => h.class === studentData.class);
            
            // Filter by subject
            const subject = subjectFilter.value;
            if (subject) {
                homework = homework.filter(h => h.subject === subject);
            }
            
            // Search
            const search = homeworkSearch.value.toLowerCase();
            if (search) {
                homework = homework.filter(h => 
                    h.subject.toLowerCase().includes(search) || 
                    h.details.toLowerCase().includes(search) || 
                    h.teacher.toLowerCase().includes(search)
                );
            }
            
            // Sort
            const sort = sortHomework.value;
            homework.sort((a, b) => {
                if (sort === 'newest') {
                    return new Date(b.date) - new Date(a.date);
                } else if (sort === 'oldest') {
                    return new Date(a.date) - new Date(b.date);
                } else if (sort === 'subject') {
                    return a.subject.localeCompare(b.subject);
                }
                return 0;
            });
            
            // Render
            homeworkGrid.innerHTML = homework.length > 0 ? 
                homework.map(h => `
                    <div class="homework-card animate">
                        <div class="homework-header-card">
                            <span class="homework-subject">${h.subject}</span>
                            <span class="homework-date">${formatDate(h.date)}</span>
                        </div>
                        <div class="homework-body">
                            <div class="homework-teacher">
                                <i class="fas fa-chalkboard-teacher"></i> ${h.teacher}
                            </div>
                            <div class="homework-details">${h.details}</div>
                            <div class="homework-actions">
                                <button onclick="markHomeworkComplete('${h.subject}', '${h.date}')"><i class="fas fa-check"></i> Complete</button>
                                <button onclick="addToCalendar('${h.subject}', '${h.date}', '${h.details}', '${h.teacher}')"><i class="fas fa-calendar-plus"></i> Remind</button>
                            </div>
                        </div>
                    </div>
                `).join('') : 
                '<p style="text-align: center; grid-column: 1/-1; color: #666;">No homework assignments found.</p>';
        }

        // Render teachers
        function renderTeachers() {
            const teachers = JSON.parse(localStorage.getItem('mkps_teachers')) || [];
            teachersGrid.innerHTML = teachers.map(t => `
                <div class="teacher-card animate">
                    <div class="teacher-image">
                        <img src="${t.image}" alt="${t.name}">
                    </div>
                    <div class="teacher-info">
                        <div class="teacher-name">${t.name}</div>
                        <div class="teacher-subject">${t.subject} Teacher</div>
                        <div class="teacher-qualification">${t.class}</div>
                        <p>${t.bio.substring(0, 100)}...</p>
                        <div class="teacher-contact">
                            <a href="tel:${t.phone}"><i class="fas fa-phone"></i></a>
                            <a href="mailto:${t.email}"><i class="fas fa-envelope"></i></a>
                            <a href="#" onclick="sendMessageToTeacher('${t.name}')"><i class="fas fa-comments"></i></a>
                        </div>
                    </div>
                </div>
            `).join('');
            
            teacherCount.textContent = teachers.length;
        }

        // Render events
        function renderEvents() {
            const events = JSON.parse(localStorage.getItem('mkps_events')) || [];
            events.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            timeline.innerHTML = events.map((e, index) => `
                <div class="timeline-item ${index % 2 === 0 ? 'left' : 'right'} animate">
                    <div class="timeline-content">
                        <span class="event-date">${formatDate(e.date)} | ${e.time}</span>
                        <div class="event-title">${e.title}</div>
                        <div class="event-desc">${e.description}</div>
                        <div class="event-venue">
                            <i class="fas fa-map-marker-alt"></i> ${e.venue}
                        </div>
                    </div>
                </div>
            `).join('');
            
            eventCount.textContent = events.length;
        }

        // Render notices
        function renderNotices() {
            const notices = JSON.parse(localStorage.getItem('mkps_notices')) || [];
            notices.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            noticeList.innerHTML = notices.map(n => `
                <div class="notice-item animate">
                    <div class="notice-header">
                        <div class="notice-title">${n.title}</div>
                        <div class="notice-badge ${n.type}">${n.type}</div>
                    </div>
                    <span class="notice-date">${formatDate(n.date)}</span>
                    <div class="notice-content">${n.content}</div>
                    <div class="notice-actions">
                        <button onclick="markNoticeRead('${n.title}')"><i class="fas fa-check"></i> Read</button>
                    </div>
                </div>
            `).join('');
            
            noticeCount.textContent = notices.length;
        }

        // Render timetable
        function renderTimetable() {
            if (!studentData) return;
            
            const timetables = JSON.parse(localStorage.getItem('mkps_timetable')) || {};
            const classTimetable = timetables[studentData.class] || timetables["1"];
            
            timetableTable.innerHTML = classTimetable.map(period => `
                <tr class="animate">
                    <td>${period.time}</td>
                    <td><div class="subject">${period.mon}</div></td>
                    <td><div class="subject">${period.tue}</div></td>
                    <td><div class="subject">${period.wed}</div></td>
                    <td><div class="subject">${period.thu}</div></td>
                    <td><div class="subject">${period.fri}</div></td>
                    <td><div class="subject">${period.sat}</div></td>
                </tr>
            `).join('');
        }

        // Render gallery
        function renderGallery(filter = 'all') {
            const gallery = JSON.parse(localStorage.getItem('mkps_gallery')) || [];
            currentGalleryImages = filter === 'all' ? 
                gallery : 
                gallery.filter(img => img.category === filter);
            
            galleryGrid.innerHTML = currentGalleryImages.map((img, index) => `
                <div class="gallery-item animate" data-index="${index}">
                    <img src="${img.src}" alt="${img.caption}">
                    <div class="gallery-overlay">
                        <div class="gallery-icon">
                            <i class="fas fa-search-plus"></i>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Add event listeners to gallery items
            document.querySelectorAll('.gallery-item').forEach(item => {
                item.addEventListener('click', () => {
                    const index = parseInt(item.getAttribute('data-index'));
                    openLightbox(index);
                });
            });
        }

        // Render results
        function renderResults() {
            const results = JSON.parse(localStorage.getItem('mkps_results')) || [];
            const term = termFilter.value;
            const subject = subjectFilterResults.value;
            
            // Filter results
            let filteredResults = results.filter(r => r.term === term);
            if (subject !== 'all') {
                filteredResults = filteredResults.filter(r => r.subject === subject);
            }
            
            resultsBody.innerHTML = filteredResults.map(r => `
                <tr class="animate">
                    <td>${r.subjectName}</td>
                    <td>${r.marksObtained}</td>
                    <td>${r.totalMarks}</td>
                    <td>${r.percentage}%</td>
                    <td><span class="grade grade-${r.grade.toLowerCase()}">${r.grade}</span></td>
                    <td>${r.status}</td>
                </tr>
            `).join('');
            
            if (filteredResults.length === 0) {
                resultsBody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; color: #666;">No results found for the selected criteria.</td>
                    </tr>
                `;
            }
        }

        // Render attendance
        function renderAttendance() {
            const attendance = JSON.parse(localStorage.getItem('mkps_attendance')) || [];
            const month = parseInt(monthFilter.value);
            const today = new Date();
            const currentYear = today.getFullYear();
            
            // Clear calendar
            const days = document.querySelectorAll('.calendar-day');
            days.forEach(day => {
                if (!day.classList.contains('calendar-header')) {
                    day.remove();
                }
            });
            
            // Get first day of month
            const firstDay = new Date(currentYear, month - 1, 1);
            const lastDay = new Date(currentYear, month, 0);
            const totalDays = lastDay.getDate();
            const startingDayOfWeek = firstDay.getDay();
            
            // Add empty cells for days before the first day
            for (let i = 0; i < startingDayOfWeek; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                emptyDay.innerHTML = '';
                calendar.appendChild(emptyDay);
            }
            
            // Add days of the month
            let presentCount = 0;
            let absentCount = 0;
            
            for (let i = 1; i <= totalDays; i++) {
                const dateStr = `${currentYear}-${String(month).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
                const dayAttendance = attendance.find(a => a.date === dateStr);
                const status = dayAttendance ? dayAttendance.status : 'present'; // Default to present if no record
                
                if (status === 'present') presentCount++;
                if (status === 'absent') absentCount++;
                
                const dayElement = document.createElement('div');
                dayElement.className = `calendar-day ${status}`;
                dayElement.textContent = i;
                dayElement.title = status.charAt(0).toUpperCase() + status.slice(1);
                calendar.appendChild(dayElement);
            }
            
            // Update summary
            totalDays.textContent = presentCount + absentCount;
            presentDays.textContent = presentCount;
            absentDays.textContent = absentCount;
        }

        // Render messages
        function renderMessages() {
            const messages = JSON.parse(localStorage.getItem('mkps_messages')) || [];
            const filteredMessages = messages.filter(m => 
                m.recipient.includes('Teacher') || 
                m.sender === (studentData ? studentData.name : 'Student')
            );
            
            messageList.innerHTML = filteredMessages.map(m => `
                <div class="message animate">
                    <div class="message-avatar">
                        ${m.sender.charAt(0)}
                    </div>
                    <div class="message-content">
                        <div class="message-header">
                            <span class="message-sender">${m.sender}</span>
                            <span class="message-time">${formatTime(m.timestamp)}</span>
                        </div>
                        <div class="message-text">${m.message}</div>
                    </div>
                </div>
            `).join('');
            
            if (filteredMessages.length === 0) {
                messageList.innerHTML = `
                    <div class="message" style="text-align: center; color: #666;">
                        No messages yet. Click "New Message" to start a conversation with a teacher.
                    </div>
                `;
            }
        }

        // Update analytics
        function updateAnalytics() {
            if (!studentData) return;
            
            const homework = JSON.parse(localStorage.getItem('mkps_homework')) || [];
            const classHomework = homework.filter(h => h.class === studentData.class);
            homeworkCount.textContent = classHomework.length;
            
            const notices = JSON.parse(localStorage.getItem('mkps_notices')) || [];
            noticeCount.textContent = notices.length;
            
            const events = JSON.parse(localStorage.getItem('mkps_events')) || [];
            eventCount.textContent = events.length;
            
            const teachers = JSON.parse(localStorage.getItem('mkps_teachers')) || [];
            teacherCount.textContent = teachers.length;
        }

        // Update progress
        function updateProgress() {
            if (!studentData) return;
            
            const homework = JSON.parse(localStorage.getItem('mkps_homework')) || [];
            const classHomework = homework.filter(h => h.class === studentData.class);
            const completedHomework = classHomework.length * 0.7; // 70% completion rate
            const homeworkPercentage = Math.round((completedHomework / classHomework.length) * 100) || 0;
            
            const attendance = JSON.parse(localStorage.getItem('mkps_attendance')) || [];
            const presentDays = attendance.filter(a => a.status === 'present').length;
            const totalDays = attendance.length;
            const attendancePercentage = Math.round((presentDays / totalDays) * 100) || 0;
            
            const results = JSON.parse(localStorage.getItem('mkps_results')) || [];
            const termResults = results.filter(r => r.term === termFilter.value);
            const averagePercentage = termResults.length > 0 ? 
                Math.round(termResults.reduce((sum, r) => sum + r.percentage, 0) / termResults.length) : 0;
            
            // Update progress bars
            homeworkProgress.style.width = `${homeworkPercentage}%`;
            homeworkProgressText.textContent = `${homeworkPercentage}%`;
            
            attendanceProgress.style.width = `${attendancePercentage}%`;
            attendanceProgressText.textContent = `${attendancePercentage}%`;
            
            testProgress.style.width = `${averagePercentage}%`;
            testProgressText.textContent = `${averagePercentage}%`;
        }

        // Format date
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString(undefined, options);
        }

        // Format time
        function formatTime(timestamp) {
            const options = { hour: '2-digit', minute: '2-digit' };
            return new Date(timestamp).toLocaleTimeString(undefined, options);
        }

        // Handle contact form submission
        function handleContactFormSubmit(e) {
            e.preventDefault();
            
            const messages = JSON.parse(localStorage.getItem('mkps_messages')) || [];
            const message = {
                sender: document.getElementById('name').value,
                recipient: 'School Administration',
                message: document.getElementById('message').value,
                timestamp: new Date().toISOString(),
                read: false
            };
            
            messages.push(message);
            localStorage.setItem('mkps_messages', JSON.stringify(messages));
            
            // Trigger update
            localStorage.setItem('mkps_update', Date.now().toString());
            
            // Reset form
            contactForm.reset();
            
            // Show success message
            alert('Your message has been sent successfully! We will get back to you soon.');
        }

        // Open lightbox
        function openLightbox(index) {
            currentImageIndex = index;
            const img = currentGalleryImages[currentImageIndex];
            lightboxImage.src = img.src;
            lightboxCaption.textContent = img.caption;
            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Close lightbox
        function closeLightboxModal() {
            lightbox.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Show previous image
        function showPrevImage() {
            currentImageIndex = (currentImageIndex - 1 + currentGalleryImages.length) % currentGalleryImages.length;
            const img = currentGalleryImages[currentImageIndex];
            lightboxImage.src = img.src;
            lightboxCaption.textContent = img.caption;
        }

        // Show next image
        function showNextImage() {
            currentImageIndex = (currentImageIndex + 1) % currentGalleryImages.length;
            const img = currentGalleryImages[currentImageIndex];
            lightboxImage.src = img.src;
            lightboxCaption.textContent = img.caption;
        }

        // Download current image
        function downloadCurrentImage() {
            const link = document.createElement('a');
            link.href = lightboxImage.src;
            link.download = `mkps-gallery-${currentImageIndex + 1}.jpg`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Export all data
        function exportAllData() {
            const data = {
                mkps_student: localStorage.getItem('mkps_student'),
                mkps_homework: localStorage.getItem('mkps_homework'),
                mkps_teachers: localStorage.getItem('mkps_teachers'),
                mkps_events: localStorage.getItem('mkps_events'),
                mkps_notices: localStorage.getItem('mkps_notices'),
                mkps_timetable: localStorage.getItem('mkps_timetable'),
                mkps_gallery: localStorage.getItem('mkps_gallery'),
                mkps_messages: localStorage.getItem('mkps_messages'),
                mkps_results: localStorage.getItem('mkps_results'),
                mkps_attendance: localStorage.getItem('mkps_attendance'),
                mkps_theme: localStorage.getItem('mkps_theme'),
                export_date: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `mkps-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        // Handle import
        function handleImport(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    // Restore data
                    Object.keys(data).forEach(key => {
                        if (key !== 'export_date') {
                            localStorage.setItem(key, data[key]);
                        }
                    });
                    
                    // Trigger update
                    localStorage.setItem('mkps_update', Date.now().toString());
                    
                    alert('Data imported successfully! Page will reload.');
                    location.reload();
                } catch (error) {
                    alert('Error importing data: ' + error.message);
                }
            };
            reader.readAsText(file);
            importFile.value = '';
        }

        // Print page
        function printPage() {
            window.print();
        }

        // Send message handler
        function sendMessageHandler() {
            const messageText = messageInput.value.trim();
            if (!messageText) return;
            
            const messages = JSON.parse(localStorage.getItem('mkps_messages')) || [];
            messages.push({
                sender: studentData ? studentData.name : 'Student',
                recipient: 'Teacher',
                message: messageText,
                timestamp: new Date().toISOString(),
                read: false
            });
            
            localStorage.setItem('mkps_messages', JSON.stringify(messages));
            renderMessages();
            messageInput.value = '';
        }

        // Send message to teacher
        function sendMessageToTeacher(teacherName) {
            const message = prompt(`Message to ${teacherName}:`);
            if (message && message.trim()) {
                const messages = JSON.parse(localStorage.getItem('mkps_messages')) || [];
                messages.push({
                    sender: studentData ? studentData.name : 'Student',
                    recipient: teacherName,
                    message: message.trim(),
                    timestamp: new Date().toISOString(),
                    read: false
                });
                localStorage.setItem('mkps_messages', JSON.stringify(messages));
                renderMessages();
                alert('Message sent successfully!');
            }
        }

        // Mark homework as complete
        function markHomeworkComplete(subject, date) {
            alert(`Homework for ${subject} on ${formatDate(date)} has been marked as complete.`);
        }

        // Add to calendar
        function addToCalendar(subject, date, details, teacher) {
            alert(`Reminder set for ${subject} homework due on ${formatDate(date)}.`);
        }

        // Mark notice as read
        function markNoticeRead(title) {
            alert(`Notice "${title}" has been marked as read.`);
        }

        // Generate PDF report
        function generatePDFReport() {
            alert('Generating PDF report... This feature would integrate with a PDF library in a real implementation.');
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
